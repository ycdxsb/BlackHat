## BlackHat USA 2020
### Stress-Testing Democracy: Election Integrity During a Global Pandemic
Technologists have long warned that much of the technology and infrastructure we depend on for voting suffers from exploitable vulnerabilities that could be used to cast doubt on the integrity of elections. Those problems are extremely challenging under normal circumstances, but a global pandemic adds a new dimension to the mix: protecting the health of voters and election workers. How do we securely and robustly scale up safer, broadly accessible voting mechanisms between now and November? This talk will explore the challenges - technological, logistical, and political - of keeping our elections running during a crisis.
### Carrying our Insecurities with Us: The Risks of Implanted Medical Devices in Secure Spaces
This talk explores the contradiction of allowing increasingly smart Implanted Medical Devices (IMD) in secure spaces through the combination of policy amendments and technical mitigations. The number of IMDs in use in the United States has been steadily increasing as new technologies emerge and improve. In the context of the U.S national security workforce, current guiding policy prohibits the possession and use of many portable electronic devices (PEDs) and "smart" devices, including smart IMDs, in secure spaces. Given that these smart devices are increasingly connected by two-way communications protocols, have embedded memory, possess a number of mixed-modality transducers, and are trained to adapt to their environment and host with artificial intelligence (AI) algorithms, they represent significant concerns to the security of protected data, while also delivering increasing, and often medically necessary, benefits to their users. By analyzing the risks and benefits of various policy considerations, we conclude that there is a need to amend Intelligence Community Policy Memorandum (ICPM) 2005-700-1, Annex D, Part I to include smart IMDs to remain compliant with Intelligence Community Policy Guidance (ICPG) 110.1. Additionally, we propose a series of technical and policy mitigations applicable to these smart IMDs that balance the simultaneous constraints of medical necessity and security.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Michaels-Carrying-Our-Insecurities-With-Us-The-Risks-Of-Implanted-Medical-Devices-In-Secure-Spaces.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Michaels-Carrying-Our-Insecurities-With-Us-The-Risks-Of-Implanted-Medical-Devices-In-Secure-Spaces-wp.pdf)
### Hacking the Supply Chain – The Ripple20 Vulnerabilities Haunt Tens of Millions of Critical Devices
This is the story of how we found and exploited a series of critical vulnerabilities (later named Ripple20) affecting tens or hundreds of millions of IoT devices across all IoT sector conceivable - industrial controllers, power grids, medical, home, networking, transportation, enterprise, retail, defense, and a myriad of other types of IoT devices, manufactured and deployed by the largest American and international vendors in these fields.These vulnerabilities were found in a TCP/IP software library located at the very beginning of a complex supply chain and have lurked undetected for at least 10 years, likely much more. Over the past two decades this library has spread around the world by means of direct use as well as indirectly, through "second hand" use, rebranding, collaborations, acquisitions and repackaging, having been embedded and configurated in a range of different ways. Many of the vendors indirectly selling and using this library were not aware of their using it. Now that they know, the patch propagation dynamics are very complex and may not be possible in some cases.This library is a little known, but widely used, embedded library developed by Treck Inc.known for its high reliability, performance, and configurability. Its features make it suitable for real-time operating system usage and low-power devices.Despite being used by many large, security-aware vendors, these vulnerabilities lay dormant and undiscovered - while actors of all types could have discovered these vulnerabilities by finding one of several bugs in any of the components, exposing hundreds of others immediately. This would provide a field day of affected devices for the picking.In this presentation, we will discuss one of the vulnerabilities in technical depth, demonstrating an RCE exploit on a vulnerable device. We will explain how the vulnerabilities became so widespread, and what we still don’t know. We will speculate as to why these vulnerabilities survived for so long and show why some vendors are worse affected than others.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Oberman-Hacking-The-Supply-Chain-The-Ripple20-Vulnerabilities-Haunt-Tens-Of-Millions-Of-Critical-Devices.pdf)
### HTTP Request Smuggling in 2020 – New Variants, New Defenses and New Challenges
HTTP Request Smuggling (AKA HTTP Desyncing) is an attack technique invented in 2005 that exploits different interpretations of a stream non-standard HTTP requests among various HTTP devices between the client (attacker) and the server (including the server itself). It can be used to smuggle requests across WAFs and security solutions, poison HTTP caches, inject responses to users and hijack user requests.You'd think that HTTP Request Smuggling should be difficult to find in 2020. After all, protecting against HTTP Request Smuggling is all about having an HTTP parser adhering to the RFC standards. And with James Kettle's presentation in Black Hat 2019 which put the issue back in the limelight, awareness must be high these days. Even more so with COTS software which can easily be reviewed and patched by its vendor. Not so. In this presentation, I demonstrate four new HTTP Request Smuggling attack variants that work against COTS, popular, present-day web servers and HTTP proxy servers. I also describe a successful attack with an old variant, and I demonstrate a circumvention of an existing HTTP Request Smuggling protection for a free, open source application security solution.I then discuss the shortcomings of existing free, open source solutions for HTTP Request Smuggling, and describe and share my C++ "Request Smuggling Firewall" class library that can be injected to any user-space process (web server or proxy server) to provide robust socket-level protection against HTTP Request Smuggling. My class library is extensible beyond HTTP Request Smuggling, and in fact beyond HTTP.Finally, I describe some anomalies I found in various web servers and proxy servers, and challenge the security research community to find a "matching" software to make them into full HTTP Request Smuggling attacks.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Klein-HTTP-Request-Smuggling-In-2020-New-Variants-New-Defenses-And-New-Challenges.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Klein-HTTP-Request-Smuggling-In-2020-New-Variants-New-Defenses-And-New-Challenges-wp.pdf)
### Hiding Process Memory via Anti-Forensic Techniques
Nowadays, security practitioners typically use memory acquisition or live forensics to detect and analyze sophisticated malware samples. Subsequently, malware authors began to incorporate anti-forensic techniques that subvert the analysis process by hiding malicious memory areas. Those techniques typically modify characteristics, such as access permissions, or place malicious data near legitimate one, in order to prevent the memory from being identified by analysis tools while still remaining accessible.In this talk, we present three novel methods that prevent malicious user space memory from appearing in analysis tools and additionally making the memory inaccessible from a security analysts perspective. Two of these techniques manipulate kernel structures, namely Page Table Entries and the structures responsible for managing user space memory regions (vm_area_struct and VAD strucutes), while the third one utilizes shared memory and hence does not require elevated privileges. As a proof of concept, we implemented all techniques for the Windows and Linux operating systems, and subsequently evaluated these with both, memory forensics and live analysis techniques.Furthermore, we discuss and evaluate several approaches to detect our subversion techniques and present several Volatility and Rekall plugins that automate the detection of the hidden memory.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Block-Hiding-Process-Memory-Via-Anti-Forensic-Techniques.pdf)
### All You Ever Wanted to Know about the AMD Platform Security Processor and were Afraid to Emulate - Inside a Deeply Embedded Security Processor
AMDs Zen (and later) CPUs contain the "(Platform) Secure Processor" (PSP) which is an embedded ARM core inside your x86 CPU responsible for initial system bootstrapping. The PSP is running even before the main x86 cores and has full access to the main memory. During system runtime it serves as a trust anchor for features like AMDs "Secure Encrypted Virtualization" feature and recently a generic TEE interface for which there are Linux kernel patches pending currently. The firmware running on the PSP is completely proprietary and there is almost no public documentation available. These are more than enough reasons for us to have a closer look at this system.During the last two years, we reverse engineered several components of the PSP firmware and hardware in order to gain an understanding of the capabilities of this critical component looking for possible security issues. We found multiple security issues that allow us to gain code execution on the PSP.Lately, we developed an emulator for the PSP which enables us to trace the execution of the firmware and to make it easier to develop and test our own code which will later run on the PSP by exploiting found security issues. The emulator is able to run the on-chip and off-chip bootloader that are used to bootstrap the systems. In the emulated setup, it is also possible to put the firmware into a debug mode where signature verifications are disabled, and additional debug output is generated.We'll also present a mode where a stub is running on the physical PSP and takes commands from the emulator to forward hardware accesses from the firmware in order to bootstrap the real system using the firmware running inside the emulator.The emulator and all other developed tools are open source and available on github: https://github.com/PSPReverse
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Buhren-All-You-Ever-Wanted-To-Know-About-The-AMD-Platform-Security-Processor-And-Were-Afraid-To-Emulate.pdf)
### Room for Escape: Scribbling Outside the Lines of Template Security
Now more than ever, digital communication and collaboration are essential to the modern human experience. People around the globe work together online as they share information, create documents, send emails, and collaborate on spreadsheets and presentations. Shared digital content is everywhere and networked communication platforms and software play a crucial role. Content Management Systems (CMS) allow the user to design, create, modify, and visualize dynamic content. For many companies, CMS platforms are pivotal to their content pipelines and workforce collaboration.In our research, we discovered multiple ways to achieve Remote Code Execution (RCE) on CMS platforms where users can create or modify templates for dynamic content. In today's multi-tenancy ecosystems, this often implies that a co-tenant on the same system can take over control of the CMS resources on which your organization relies.Using a Microsoft SharePoint server as our main CMS attack surface, we combined flaws in its implementation and design with framework and language specific features to find six unique RCE vulnerabilities. In addition, we reviewed some of the most popular Java Template engines such as Apache Velocity, Apache FreeMarker, Pebble, and JinJava. As a result of this effort, we discovered ways to escape template sandboxes and achieve RCE in many products including: Atlassian Confluence, Alfresco, Liferay, Crafter CMS, dotCMS, XWiki, Apache OfBiz, and more.We will analyze how these products and frameworks implement security controls and review the various techniques that we used to bypass them. We will describe all the vulnerabilities we uncovered in detail and show working demos of the most interesting attacks where unprivileged users can run arbitrary commands on SharePoint or Liferay servers.Finally, we will present our general review methodologies for systems with dynamic content templates and provide practical recommendations to better protect them.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Munoz-Room-For-Escape-Scribbling-Outside-The-Lines-Of-Template-Security.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Munoz-Room-For-Escape-Scribbling-Outside-The-Lines-Of-Template-Security-wp.pdf)
### Defending Containers Like a Ninja: A Walk through the Advanced Security Features of Docker &#38; Kubernetes
Today, with a few commands anyone can have containers running on their machine; at this point, they seem to be neither complex nor complicated to secure. However, the story dramatically changes when the ecosystem grows exponentially and now we have thousands of nodes that fulfill different roles, with different resources, running different applications, in different virtual environments, remotely accessed by different users who must have different types of permissions and so on. Complexity is the worst enemy of security, what can we do to protect these huge containerized environments?

There are many features of Docker and Kubernetes that allow to secure quite well these environments. However, the eternal official documentation makes, perhaps, these functionalities go unnoticed. 

Throughout this talk it will be explained how to implement the advanced security features to secure the Docker daemon and its core components, the containers execution, Swarm and Kubernetes orchestrated environments. We will go from the depths, limiting the kernel's capabilities at container runtime and remapping it to the user-namespace, until successfully apply the RBAC at the orchestrator in Swarm or Kubernetes. In addition, the talk reveals various attacks that could be carried out if these advanced security measures are not applied.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Berta-Defending-Containers-Like-A-Ninja-A-Walk-Through-The-Advanced-Security-Features-Of-Docker-And-Kubernetes.pdf)
### Emulating Samsung&#39;s Baseband for Security Testing
The most crucial interface between modern mobile phones and cellular networks are baseband processors. Basebands are responsible for processing the complicated 2G thru 5G protocols, which gives them a large attack surface. Unfortunately, exploring this surface is cumbersome: finding flaws over-the-air is not scalable, crashes are difficult to reproduce, and devices typically lack even basic debugging interfaces.To address these concerns, we designed and built an emulation environment for Samsung's "Shannon" baseband (ShannonEE). We leverage and combine the strengths of two existing frameworks, avatar2 & PANDA, to provide a flexible and extensible platform geared towards vulnerability research. We are able to load and run ARMv7-R Shannon firmware images, which typically exceed 30MB in size and have 65K+ functions. We emulate the custom Shannon RTOS and its peripherals accurately enough to enable task switching and timer interrupts, leading to powerful dynamic analysis platform. We also support different versions of Shannon SoCs, spanning multiple generation of Samsung Galaxy phones.To take full advantage of ShannonEE, we ported TriforceAFL, allowing for targeted, coverage guided, task or protocol, fuzzing. Unlike over-the-air fuzzing, our platform allows for in-depth introspection of the baseband's internal state when triggering crashes and gdb-based memory examination providing backtraces and detailed task information. We demonstrate how our emulator can be used to investigate and understand the impact of n-days and how you would go about finding new vulnerabilities.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Hernandez-Emulating-Samsungs-Baseband-For-Security-Testing.pdf)
### CloudLeak: DNN Model Extractions from Commercial MLaaS Platforms
Deep Neural Networks (DNN) have been widely deployed for a variety of tasks across many disciplines, for example, image processing, natural language processing, and voice recognition. However, creating a successful DNN model depends on the availability of huge amounts of data as well as enormous computing power, and the model training is often an arduously slow process. This presents a large barrier to those interested in utilizing a DNN. To meet the demands of users who may not have sufficient resources, cloud-based deep learning services arose as a cost-effective and flexible solution allowing users to complete their machine learning (ML) tasks efficiently. Machine Learning as a Service (MLaaS) platform providers may spend great effort collecting data and training models, and thus want to keep them proprietary. The DNN models of MLaaS platforms can only be used as web-based API interface and thus is isolated from users. In this work, we develop a novel type of attack that allows the adversary to easily extract the large-scale DNN models from various cloud-based MLaaS platforms, which are hosted by Microsoft, Face++, IBM, Google and Clarifai.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Jin-CloudLeak-DNN-Model-Extractions-From-Commercial-MLaaS-Platform.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Jin-CloudLeak-DNN-Model-Extractions-From-Commercial-MLaaS-Platform-wp.pdf)
### Election Security: Securing America's Future 
The United States Government is intensely focused on election security and is working together with election partners better than ever before. The Department of Homeland Security’s Cybersecurity and Infrastructure Security Agency (CISA) is leading the federal effort to support state and local officials in their important mission to secure elections in 2020. We are sharing intelligence, resources, support and cybersecurity services to secure election infrastructure against malicious activity.Since 2017, federal, state, local and private sector partners have been building up our defenses and preparing for the 2020 elections. We know this election will be a target and the bad guys are still out there, but we are trained, exercised and ready.While preparing for the threats that we knew about, our nation has been confronting another threat in the form of a pandemic. This has forced election officials to make quick operational decisions determining how to run elections in the time of COVID-19. We have had to quickly adapt and provide support and resources as officials look for safe, healthy and secure ways to ensure that elections continue to take place.
### An Unauthenticated Journey to Root: Pwning Your Company's Enterprise Software Servers
Often Fortune 1000 companies consist of a plethora of software, hardware, vendors, and solutions all operating to keep the business running and alive. With all this complexity, there is often a single vendor that's common amongst them all: SAP.SAP's software relationship with the enterprise is well established, often responsible for processing billions of dollars, but with such a vital role in business, what would the impact be if serious flaws were exploited? At the heart of every SAP deployment there is always one core mandatory product that's connected to many other systems: The SAP Solution Manager (SolMan). Think of this as what Active Directory is for Windows networks. Given the criticality of this component, the Onapsis Research Labs conducted a thorough security assessment of SolMan to understand the threat model, how attackers could compromise it and how customers should protect themselves. The results were overwhelming. From unauthenticated HTTP access, an attacker would be able to compromise all systems in the SAP landscape. Furthermore, chaining a series of vulnerabilities, it would be possible to get reliable root access not only in the attacked core system, but also in all satellites connected to it.The aim of this presentation is to show the journey we took while researching SolMan, a journey that included binary and Java application analysis, understanding how SolMan worked as well as how we identified exploitation methods that could be used by rogue parties to attack it. By talking about this journey, we hope attendees can use our experience to tackle similar projects where little, or no, information is available about how complex components work. Finally, we'll explain in detail, not only how these issues were fixed by SAP, but also what you can do in terms of detecting and preventing these kinds of threats at your organization.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Artuso-An-Unauthenticated-Journey-To-Root-Pwning-Your-Companys-Enterprise-Software-Servers.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Artuso-An-Unauthenticated-Journey-To-Root-Pwning-Your-Companys-Enterprise-Software-Servers-wp.pdf)
### Finding New Bluetooth Low Energy Exploits via Reverse Engineering Multiple Vendors' Firmwares
Bluetooth Low Energy (BLE) has seen widespread product adoption and a renewed interest from a security community whose interest in Classic Bluetooth (BT) had waned. Protocols that run "above" the Host Controller Interface (HCI) on the BLE stack are typically handled in full OSes or applications. Vulnerabilities at these layers are plentiful (~70 in Android in 2019) and comparatively well-understood. But for performance and abstraction reasons, protocols below the HCI layer are always handled in firmware running on microprocessors designed for BLE support. Until now, there had been only a single publicly disclosed remote code execution vulnerability in BLE below the HCI layer: CVE-2018-16986, Armis' BleedingBit. This talk describes my process of going from knowing nothing about Bluetooth, to reverse engineering multiple vendors' firmwares, and finding remote code execution exploits for multiple new vulnerabilities at the lowest levels of the BLE protocol stack which I will demonstrate. Exploits at this layer are of particular interest because they require neither pairing nor authentication, merely proximity, to exploit.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Kovah-Finding-New-Bluetooth-Low-Energy-Exploits-Via-Reverse-Engineering-Multiple-Vendors-Firmwares.pdf)
### Detecting Fake 4G Base Stations in Real Time
4G/LTE IMSI-catchers (such as the Hailstorm) are becoming more popular with governments and law enforcement around the world, as well as spies, and even criminals. Until now, IMSI-catcher detection has focused on 2G IMSI-catchers (such as the Stingray), despite the fact that 2G IMSI-catchers are quickly falling out of favor.In this talk, we hope to clear up myths about what modern IMSI-catchers can and can't do, based on results from recent cell network security research. We will also demonstrate software and heuristics to detect fake 4G/LTE base stations that anyone can build. We will also present an outline for the path towards fixing some of the fundamental issues in cell network security, so that hopefully IMSI-catchers are one day a thing of the past.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Quintin-Detecting-Fake-4G-Base-Stations-In-Real-Time.pdf)
- [source_code](https://github.com/efforg/crocodilehunter)
### Decade of the RATs – Custom Chinese Linux Rootkits for Everyone
While 2020 is the Year of the Rat for the Chinese, it's felt more like the Decade of the RATs. In this talk, I reveal a nearly decade-long, undetected, state-sponsored effort to strategically target the Linux servers that comprise the backbone of modern-day government and industry. Having discovered a full stack of handcrafted, tailored, Linux malware, from interactive installation script to kernel rootkits to the attacker's control panel, I was able to construct a rare and uniquely detailed narrative of a concerted espionage effort.The talk reveals how five Chinese APT groups that originally stemmed from the notorious WINNTI collective formed a Linux splinter cell. Set against the backdrop of recent, renewed efforts by the US Department of Justice to expose and prosecute Chinese espionage, the talk sheds light on a new and troubling chapter in an otherwise old story of Chinese IP theft - one that crosses into the Android and Windows platforms as well. The talk demonstrates how the attackers successfully preyed upon defender assumptions regarding the security of Linux, the treatment of Windows adware, and the overall deployment of security products and services. Finally, attendees will also encounter new and intriguing questions, including: Is a Chinese APT group behind the development of one of the most widely used, commercially available RATs for mobile?Is WINNTI responsible for the creation of the largest known Linux DDoS botnet?
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Livelli-Decade-Of-The-RATs-Custom-Chinese-Linux-Rootkits-For-Everyone.pdf)
- [whitepaper](https://www.blackberry.com/rats)
### Industrial Protocol Gateways Under Analysis
With the development of the Industry 4.0, legacy devices like serial control servers or PLCs are often needed to be interconnected to modern IT networks, or to the Internet (e.g. cloud providers). To address this need, protocol gateways enable the conversion of ICS protocols, for example to connect an IP-based network to one or more serial devices, and vice-versa. While previous research has shown that protocol gateways may suffer from local operating-system vulnerabilities, it is not clear to what extent protocol conversion is resilient to attacks or abuse. To give an answer to such questions, we conducted a cross-vendor security evaluation of five popular gateways and discovered several classes of security problems that, when leveraged by adversaries, can damage or negatively impact on the operation of industrial facilities. Through our collaboration with a major bug bounty program, we reported nine 0-day vulnerabilities and we are currently working with the affected vendors in improving the current situation. In this talk, we share the results of our research and discuss the impact to the problems that we identified and potential countermeasures.This is joint work with colleagues Philippe Lin, Ryan Flores, Charles Perine, Rainer Vosseler and external researcher Luca Bongiorni.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Balduzzi-Industrial-Protocol-Gateways-Under-Analysis.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Balduzzi-Industrial-Protocol-Gateways-Under-Analysis-wp.pdf)
### Engineering Empathy: Adapting Software Engineering Principles and Process to Security
Software engineering has a lot to teach our 'security engineering' teams - this session will be a live retrospective of a professional role reversal - dropping a principal security engineer into a runtime team, and placing a principal software engineer into the platform security assessment team.We've got stories and live object lessons.Attendees will return to work knowing exactly how we have implemented these ideas to partner with engineering to protect a world-class platform as a service running millions of customer containers and data services. This session is aimed at both IC's and management.Shifting left is a great marketing tagline.The valuable work is changing your security team's principles, processes, and culture to align with the principles, processes, and culture of your organization's software engineering teams allows you to develop empathy for their constraints, tools, and processes. It also allows you to build your own tools, processes, and requirements in ways that are more actionable, realistic, and easier to understand and implement.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Mackinnon-Engineering-Empathy-Adapting-Software-Engineering-Principles-And-Process-To-Security-2.pdf)
### Web Cache Entanglement: Novel Pathways to Poisoning
Caches are woven into websites throughout the net, discreetly juggling data between users, and yet they are rarely scrutinized in any depth. In this session, I'll show you how to remotely probe through the inner workings of caches to find subtle inconsistencies, and combine these with gadgets to build majestic exploit chains. These flaws pervade all layers of caching - from sprawling CDNs, through caching web servers and frameworks, all the way down to fragment-level internal template caches. I'll demonstrate how misguided transformations, naive normalization, and optimistic assumptions let me perform numerous attacks including persistently poisoning every page on an online newspaper, compromising the administration interface on an internal DoD intelligence website, and disabling Firefox updates globally. As usual, I won't waste your time talking about known techniques. When I presented 'Practical Web Cache Poisoning' in 2018, I targeted a design flaw in the caching concept. This time around I'll dive straight into implementation flaws, ensuring things get much, much messier, resulting in some of the riskiest, most hard-to-find attack techniques yet. Alongside an array of cache-attack techniques, you'll take away methodology and open-source tooling to tackle these technical challenges with confidence.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Kettle-Web-Cache-Entanglement-Novel-Pathways-To-Poisoning.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Kettle-Web-Cache-Entanglement-Novel-Pathways-To-Poisoning-wp.pdf)
- [source_code](https://github.com/PortSwigger/param-miner)
### Repurposing Neural Networks to Generate Synthetic Media for Information Operations
Deep neural networks routinely achieve near human-level performances on a variety of tasks, but each new breakthrough demands massive volumes of quality data, access to expensive GPU clusters, and weeks or even months to train from scratch. AI researchers commonly release model checkpoints to avoid the wasteful duplication of these costly training runs, since fine-tuning pre-trained neural networks for custom tasks requires less data, time, and money compared to training them from scratch. While this emerging model sharing ecosystem beneficially lowers the barrier to entry for non-experts, it also gives a leg up to those seeking to leverage open source models for malicious purposes. 

Using open source pre-trained natural language processing, computer vision, and speech recognition neural networks, we demonstrate the relative ease with which fine tuning in the text, image, and audio domains can be adopted for generative impersonation. We quantify the effort involved in generating credible synthetic media, along with the challenges that time- and resource-limited investigators face in detecting generations produced by fine-tuned models. We wargame out these capabilities in the context of social media-driven information operations, and assess the challenges underlying detection, attribution, and response in scenarios where actors can anonymously generate and distribute credible fake content. Our resulting analysis suggests meaningful paths forward for a future where synthetically generated media increasingly looks, speaks, and writes like us.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Tully-Repurposing-Neural-Networks-To-Generate-Synthetic-Media-For-Information-Operations.pdf)
### Policy Implications of Faulty Cyber Risk Models and How to Fix Them
Bad security data leads to bad security policies; better data enables better policies. That, in a nutshell, is the thesis of this talk. To back that up, we'll share a FUD-free and data-driven analysis of the frequency and economic costs of tens of thousands of historical cyber incidents, with a special focus on events that impact multiple organizations.Are we under or overestimating the economic risk of cyber events? How might errant estimates of breach likelihood or probable losses affect organizational governance and risk management? Could misunderstandings about the true extent of incident propagation across supply chains hamper the development of effective policies to manage third-party risk? What would an inter-organizational approach to security policies and practices look like? Can the study of past events aid future-looking decisions such as establishing risk appetite and evaluating cyber insurance needs? Could poor risk data lead to regulatory and/or compliance requirements that fail to meet their objectives? These are just some of the policy-oriented questions we'll explore in the talk.The dataset we'll use to explore those questions spans 56,000 cyber events experienced by 35,000 organizations over the last decade. More than 800 of those incidents generated nearly 5,500 downstream loss events impacting firms beyond the primary victim. We'll examine these inter-organizational events in detail and discuss the implications these have for future policy decisions.Attendees will gain an understanding how readily available data can be used to first orient to this problem space. From there, the audience will get a picture of ground truth to make better policy decisions on issues ranging from cyber insurance, supply chain management, and the near-mythical risk management ROI.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Baker-Policy-Implications-Of-Faulty-Risk-Models-And-How-To-Fix-Them.pdf)
### iOS Kernel PAC, One Year Later
In February 2019, I reported to Apple five ways to bypass kernel Pointer Authentication on the iPhone XS . My impression was that the design, while a dramatic improvement on the ARMv8.3 standard, had some fundamental issues when defending kernel control flow against attackers with kernel memory access.

This talk will look at how PAC has (and hasn't) improved in the subsequent year, once again concluding with five new ways to bypass kernel PAC to obtain arbitrary kernel code execution on iOS 13.3.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Azad-iOS-Kernel-PAC-One-Year-Later.pdf)
### Ruling StarCraft Game Spitefully -- Exploiting the Blind Spot of AI-Powered Game Bots
With recent breakthroughs of deep neural networks in problems like computer vision, machine translation, and time series prediction, we have witnessed a great advance in the area of reinforcement learning. By integrating deep neural networks into reinforcement learning algorithms, the machine learning community designs various deep reinforcement learning algorithms and demonstrates their great success in a variety of games, ranging from defeating world champions of Go to mastering the most challenging real-time strategy game -- StarCraft. Different from conventional deep learning, deep reinforcement learning refers to goal-oriented algorithms, through which one could train an agent to learn how to attain a complex objective (e.g., in StarCraft game, balancing big-picture management of the economy and at the same time managing low-level control of individual worker units). Like a kid incentivized by spankings and candy, reinforcement learning algorithms penalize a game agent when it takes the wrong action and reward when the agent takes the right ones.In light of the success in many reinforcement-learning-powered games, we recently devoted energies to investigating the security risk of reinforcement learning algorithms in the context of video games. More specifically, we explore how to design an effective learning algorithm to learn an adversarial agent (or in other words an adversarial bot), which could automatically discover and exploit the weakness of master game bots driven by a reinforcement learning algorithm. In this talk, we will introduce how we design and develop such a learning algorithm. Then, we will demonstrate how we use this algorithm to train an adversarial agent to beat a world-class AI bot in one of the longest-played video games -- StarCraft. In addition to the game of StarCraft, we explore the effectiveness of our adversarial learning algorithm in the context of other games powered by AI, such as RobotSchool's Pong and MuJoCo's games. Along with the talk, we will publicly release our code and a variety of adversarial AI bots. By using our code, researchers and white-hat hackers could train their own adversarial agents to master many – if not all -- multi-party video games. To help the BlackHat technical board to assess our work, we release some demo videos at https://tinyurl.com/ugun2m3, showing how our adversarial agents play with world-class AI bots.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Guo-Ruling-StarCraft-Game-Spitefully-Exploiting-The-Blind-Spot-Of-AI-Powered-Game-Bots.pdf)
### We Went to Iowa and All We Got were These Felony Arrest Records
In-depth discussion and review of the red team engagement of Iowa courthouses which resulted in an unprecedented outcome. Gary and Justin will take you through the engagement, arrest, and ensuing legal battle, and wrap up with lessons learned and how the community can benefit.
### Whispers Among the Stars: A Practical Look at Perpetrating (and Preventing) Satellite Eavesdropping Attacks
Space is changing. The number of satellites in orbit will increase from approximately 2,000 today to more than 15,000 by 2030. "New Space" brings promises of ubiquitous broadband and unprecedented connectivity for billions. As the first trials of these mega-constellations take orbit, we stand at a critical technical inflection point where the InfoSec community can contribute and ensure that the security mistakes of the past do not become critical vulnerabilities for the future.This briefing presents an experimental look at attacking satellite broadband communications across three domains: land, air, and sea. We find that an attacker using $300 of home television equipment can spy on these communications from thousands of miles away with virtually no risk of detection. We walk though the hardware we used and software we developed to evaluate this threat against real-world systems using two distinct communications protocols: DVB-S MPE and DVBS-2 GSE.This threat is contextualized through the analysis of terabytes of real-world satellite traffic recordings made using our hardware setup. We'll present some of our most interesting findings from inside these captures which contain sensitive data from some of the world's largest organizations. From home satellite broadband customers, to wind farms, to oil tankers, to aircraft, satellite eavesdropping represents a critical threat to privacy and communications security. Beyond eavesdropping, we also demonstrate that, under the right conditions, attackers can even hijack active sessions over the satellite link.The talk concludes by reflecting on the physical characteristics that have incentivized insecure satellite broadband and approaches to overcome them. We present an open-source tool which individual customers can use to encrypt their traffic without requiring ISP involvement.The briefing assumes no background in satellite communications or cryptography. Its goal is to provide a starting point for researchers interested in tackling challenging security problems in outer space.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Pavur-Whispers-Among-The-Stars-Perpetrating-And-Preventing-Satellite-Eavesdropping-Attacks.pdf)
### Demystifying Modern Windows Rootkits
This talk will demystify the process of writing a rootkit, moving past theory and instead walking the audience through the process of going from a driver that says "Hello World" to a driver that abuses never-before-seen hooking methods to control the user-mode network stack. Analysis includes common patterns seen in malware and the drawbacks that come with malware in kernel-mode rather than user-mode.We'll walk through writing a rootkit from scratch, discussing how to load a rootkit, how to communicate with a rootkit, and how to hide a rootkit. With every method, we'll look into the drawbacks ranging from usability to detection vectors. The best part? We'll do this all under the radar, evading PatchGuard and anti-virus.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Demirkapi-Demystifying-Modern-Windows-Rootkits.pdf)
### Stopping Snake Oil with Smaller Healthcare Providers:  Addressing Security with Actionable Plans and Maximum Value
Healthcare has been the most affected industry by ransomware, data breaches, and hacks. Every week there is news of yet another provider that has been hacked. In multiple cases, this has led to practices shutting down, and patients not even able to get their medical records. The guidance provided to many providers has not specifically addressed what organizations need to do to protect their patients and themselves. There has not been a specific list and toolset they can use to protect themselves.In addition, there have been many snake oil companies out there that have only provided risk assessments, costing smaller providers tens of thousands of dollars, while not delivering anything of value. We want to change that and provide maximum value and immediate returns.We want people to take what we've developed and released here and use it as guidance for developing their own information security programs at small practices while not wasting money for info they will not use. Our families and friends use these providers and give them their most personal information. We want to make sure that we give back. If we stop at least one attack and protect the information of those patients with this information, it's worth it.Instead of a toolkit that is meant to demonstrate exploits, or a framework that takes a long time to implement, we're giving something that anyone can use to help their local providers out in securing the information their patients entrust them with.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Parker-Stopping-Snake-Oil-With-Smaller-Healthcare-Providers.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Parker-Stopping-Snake-Oil-With-Smaller-Healthcare-Providers-temp.xlsx)
### Reverse Engineering the Tesla Battery Management System to increase Power Available
Tesla released the dual motor performance Model S in late 2014. At that time the vehicle came with "insane mode" acceleration and an advertised 0-60 time of 3.2 seconds. Later, in July of 2015, Tesla announced "Ludicrous mode" that cut the 0-60 time down to 2.8 seconds. This upgrade was offered as a hardware and firmware change to the existing fleet of P85D vehicles and was offered for new purchases as well. Since then, Tesla has released the P90D and P100D that also have incremental performance improvements. What makes the P85D upgrade unique was how the process offered a unique insight into how the vehicle's Battery Management System(BMS) handles power requests from the front and rear drive units of the car. I was able to reverse engineer this upgrade process by examining the CAN bus messages, CAN bus UDS routines, and various firmware files that can be extracted from any rooted Tesla Model S or X. I also decrypted and decompiled Python source code used for diagnostics to determine that the process involved removing the battery pack and replacing the fuse and high voltage contactors with units that could handle higher amperage levels as well as modifying the current sensing high voltage "shunt" inside the battery pack so that it would properly respond to the higher Amperage. I then performed this process on an actual donor P85D. I then modified the firmware of the Battery Management System and the appropriate files on the security gateway to accept the modified battery pack, bricking the car in the process and forcing me to pay to have it towed to another state so I could troubleshoot. I came to understand that the BMS is the deciding module that allows the drive units to have only as much power as the BMS allows.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Kiley-Reverse-Engineering-The-Tesla-Battery-Management-System-To-Increase-Power-Available.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Kiley-Reverse-Engineering-The-Tesla-Battery-Management-System-To-Increase-Power-Available-wp.pdf)
### Discovering Hidden Properties to Attack the Node.js Ecosystem
Node.js is widely used for developing both server-side and desktop applications. It provides a cross-platform execution environment for JavaScript programs. Due to the increasing popularity, the security of Node.js is critical to web servers and desktop clients.We present a novel attack method against the Node.js platform, called hidden property abusing (HPA). The new attack leverages the widely used data exchanging feature of JavaScript to tamper critical program states of Node.js programs, like server-side applications. HPA entitles remote attackers to launch serious attacks, such as stealing confidential data, bypassing security checks, and launching denial of service attacks. To help developers detect the HPA issues of their Node.js applications, we develop a tool, named LYNX, that utilizes hybrid program analysis to automatically reveal HPA vulnerabilities and even synthesize exploits. We apply LYNX on a set of widely used Node.js programs and identify 13 previously unknown vulnerabilities. LYNX successfully generates 10 severe exploits. We have reported all of our findings to the Node.js community. At the time of paper writing, we have received the confirmation of 12 vulnerabilities and got 12 CVEs assigned. Moreover, we collaborated with an authoritative public vulnerability database to help them use a new vulnerability notion and description in related security issues.The talk consists of four parts. First, we will introduce recent offensive research on Node.js. Second, we will introduce HPA by demonstrating an exploit on a widely used web framework. Third, we will explain how to leverage program analysis techniques to automatically detect and exploit HPA. In the end, we will have a comprehensive evaluation which discusses how we identified 13 HPA 0days with the help of our detection method.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Xiao-Discovering-Hidden-Properties-To-Attack-Nodejs-Ecosystem.pdf)
### Reversing the Root: Identifying the Exploited Vulnerability in 0-days Used In-The-Wild
Over the past 12 months, Project Zero has analyzed eleven 0-day vulnerabilities that were exploited in the wild. One of the very important parts of these analyses is to do a root cause analysis on the vulnerability that is being exploited. To identify the root cause vulnerability, we've employed a variety of techniques to varying degrees of success: binary patch diffing, putting the exploit sample into a test case minimizer, source code patch diffing, manually reverse engineering the exploit, and "bug hunting" based on known details of the exploit. Rather than discussing these exploited vulnerabilities in detail, this talk will instead cover the reverse engineering techniques to determine the vulnerability in the first place. For these 11 different 0-days, we used five different techniques to determine their root cause. This talk will detail the factors that go into when each technique is used, how we used the technique, and lessons learned from when it's been successful and when it hasn't.Each technique will include case studies across a variety of platforms: from OS kernels, to Javascript engines, to apps, and more. This allows us to see similarities and differences in the reverse engineering techniques across targets. For each case study, we'll show a walk through of how the reversing technique allowed us to determine the vulnerability (or not), and discuss what we might do differently next time. This talk will be a detailed tour of reverse engineering a variety of vulnerabilities that were exploited in the wild, all in less than an hour.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Stone-Reversing-The-Root-Identifying-The-Exploited-Vulnerability-In-0-Days-Used-In-The-Wild.pdf)
### OTRazor: Static Code Analysis for Vulnerability Discovery in Industrial Automation Scripts
In this talk, we delve into industrial robot programming, focusing on the security issues arising from the design and implementation choices of these platforms.Industrial robot manufacturers provide proprietary, domain-specific programming languages to operate these complex machines. Mostly focused on movement instructions, such programming languages also provide access to low-level system resources like files and network access, and some even allow dynamic code loading. While useful, these features can lead to unsafe programming patterns such as input-validation vulnerabilities or malware-like functionalities, especially if the underlying environment provides no resource isolation like those found in modern operating systems.After describing the technical features of the languages by eight leading manufacturers, we'll share several cases of vulnerable and malicious usage. We'll then present a static code analyzer that we created and patented, to scan robotic programs and discover unsafe code patterns. Our evaluation on 50 automation programs show that unsafe patterns are indeed found in real-world code, and that static source code analysis is an effective defense tool in the short term.We conclude by discussing the remediation steps that can be adopted by developers and vendors to mitigate such issues in the medium and long term.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Maggi-OTRazor-Static-Code-Analysis-For-Vulnerability-Discovery-In-Industrial-Automation-Scripts.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Maggi-OTRazor-Static-Code-Analysis-For-Vulnerability-Discovery-In-Industrial-Automation-Scripts-wp.pdf)
### Breaking Samsung's Root of Trust: Exploiting Samsung S10 Secure Boot
Being the highest market share smartphone manufacturer, Samsung conducts a series of protection on Android called Knox Platform to ensure the security of its smartphones. During the booting process, Samsung uses S-boot (Secure Boot) to make sure it can only boot a stocked image. If the device tries to boot a custom image, it will trip a one-time programmable bit e-fuse (a.k.a Knox bit). Once a trustzone app (trustlet) detects the Knox bit tripped, it will delete the encryption key for the sensitive data to prevent unauthorized data access to the locked phone.In this presentation, we'll present several vulnerabilities we found in S-Boot that are related to USB request handling. By exploiting these vulnerabilities, we're allowed to bypass the mitigation of S-boot through the USB device and obtain code execution in early boot stage. In other words, as long as we have the phone (whether locked or not) and an USB-C connector, we'll be able to boot a custom image without tripping the Knox bit, allowing us to retrieve sensitive data from a locked device.We will also describe how we discover and exploit the vulnerabilities in detail, demonstrate the exploit on a Samsung Galaxy S10 smartphone, and discuss the possible impact of these vulnerabilities.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Chao-Breaking-Samsungs-Root-Of-Trust-Exploiting-Samsung-Secure-Boot.pdf)
### The Devil&#39;s in the Dependency: Data-Driven Software Composition Analysis
We all know that lurking within even the most popular open source packages are flaws that can leave carefully constructed applications vulnerable. In fact, 71% of all applications contain flawed open source libraries, many (70.7%) coming from downstream dependencies which might escape the notice of developers. Using graph analytics and a broad data science toolkit, we untangle the web of open source dependencies and flaws and show the best way for developers to navigate this seemingly intractable game of whack-a-mole.In this analysis, we examine over 85,000 applications and their use of more than 500k open source libraries. We provide an overview of open source usage showing that typical applications have hundreds or thousands of libraries, with most coming from a cascade of transitive dependencies. We find that proof-of-concept exploits exist for 21.7% of libraries with flaws, and that even very tiny (162 LoC) and very popular (included in 89% of applications) JavaScript libraries can contain exploitable flaws.We describe the complex relationship between libraries and security flaws and show that more libraries doesn't necessarily mean more problems -- in fact, we see applications that manage to use thousands of libraries while inheriting few or no flaws. Also, an analysis of exploitability in the data set makes clear that attackers are focusing most heavily on two types of flaws – Insecure Deserialization and Broken Access Control.We conclude by examining strategies to manage open source library flaws. We reveal more than 81% of flaws can be fixed with minor patch or revision updates, but updated libraries can themselves be flawed or can disrupt dependencies. We show that developers can prioritize risk mitigation by focusing on the 1% of flaws that are known to exist on an application's executable path and have seen exploitation in the wild.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Edwards-The-Devils-In-The-Dependency-Data-Driven-Software-Composition-Analysis.pdf)
### Building a Vulnerability Disclosure Program that Works for Election Vendors and Hackers
Election vendors are an integral part of American democracy. Because voting machines and the companies that manufacture them are so vital to our nation, their security practices and protections are under intense scrutiny, especially since the 2016 presidential election when Russian hackers attempted to disrupt American elections. This talk will explore the perspectives of voting vendors as well as security researchers. Ensuring that critical vulnerabilities are found and fixed is a complicated and sensitive process — and urgently requires a comprehensive solution. There are challenges such as privacy, communication, the certification processes, and remediation. The voting industry and the security researchers who are examining their products need a Vulnerability Disclosure Program so both communities can effectively work together to fix problems in election systems and ultimately make America’s democracy stronger and more resilient.The companies that make voting equipment and election systems are innovating to improve security, and looking for new ways to harden their systems against attacks. This presentation will explore those efforts as well as examine new models for researcher and election vendor collaboration including Coordinated Vulnerability Disclosure (CVD) programs, collaboration at the Voting Village at DEF CON and similar efforts, and Crowdsourced Penetration Testing. It will also look at ideas for improving the relationship between researchers and voting vendors.  Additionally, the election industry has many lessons to share that leaders across the manufacturing space can learn from to better protect their own critical assets, information and customer base.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Wlaschin-Building-A-Vulnerability-Disclosure-Program-That-Works-For-Election-Vendors-And-Hackers.pdf)
### Uncommon Sense: Detecting Exploits with Novel Hardware Performance Counters and ML Magic
In recent years, exploits like speculative execution, Rowhammer, and Return Oriented Programming (ROP) were detected using hardware performance counters (HPCs). But to date, only relatively simple and well-understood counters have been used, representing just a tiny fraction of the information we can glean from the system. What's worse, using only well-known counters as detectors for these attacks has a huge disadvantage - an attacker can easily bypass known counter-based detection techniques with minimal changes to existing sample exploit code. If we want a viable future for exploit detection, we need to move beyond just scratching the surface of the HPC iceberg. Uncovering the treasure trove of overlooked and undocumented counters is necessary if we are to both build defenses against these attacks and anticipate how an adversary could bypass our defenses.We'll begin our journey in walking through our ML-based solution to more effective exploit detection. Using the entire corpus of performance counters for commonly used baseline programs and behaviorally-similar malicious programs, we zero in on the counters we want to use as features for our supervised classifiers. We will then interpret our model to determine how they can effectively detect various exploits using novel performance counters.Finally, we'll showcase the uncommon and previously ignored performance counters that were lurking in the dark, with so much useful information. The results seen here will emphasize the need for documenting these counters, which were highly significant in our models for attack detection.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Gregory-Uncommon-Sense-Detecting-Exploits-With-Novel-Hardware-Performance-Counters-And-ML-Magic.pdf)
### Healthscare –  An Insider&#39;s Biopsy of Healthcare Application Security
Healthcare security teams are in a tough spot. While the provider industry is taking security seriously, they are at the mercy of the software vendors who provide the healthcare organizations with the data delivery, processing and storage solutions that are critical to delivering patient care and keeping patient data secure. Given the reliance on these systems, it begs the question – how secure are these solutions?Seth Fogie has spent the last 10+ years in the trenches of the healthcare industry and has seen the good, bad and ugly of what is being provided to your providers. As an insider, Seth has experienced the unique tension healthcare security teams face as they work to securely implement these solutions, and will share some of what has been found.The core of this presentation will focus on vulnerabilities and design issues within healthcare solutions. As we will illustrate through the dissection of numerous clinical focused systems, including radiology reading, EMR downtime, patient entertainment, pharmacy distribution, nurse communication, M&A EMR, clinical documentation and temperature monitoring systems, the prognosis doesn’t look good. Unfortunately, it is our experience that there are few solutions within the hospital enterprise that do not have issues.The goal for this public 'biopsy'? The healthcare security community needs help increasing the pressure to ensure all of our data is safe from poorly designed and developed vendor solutions. While we can't play the name and shame game for a number of reasons, we want to increase awareness through numerous technical illustrations and ask for your help in increasing scrutiny on all healthcare solutions. This isn't just an application security problem – it is all our healthcare data at risk and this audience is positioned in a unique spot to help.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Fogie-HealthScare-An-Insiders-Biospy-Of-Healthcare-Application-Security.pdf)
### FASTCash and INJX_Pure: How Threat Actors Use Public Standards for Financial Fraud
The INJX_Pure and Lazarus FASTCash malware families are each built on publicly documented standards that enable their respective operating threat actors to perform financial "cash outs" at ATMs. While each of these malware families leverages a different standard to do this, they both demonstrate that their authors and operators possess strong programming abilities *and* a knowledge of the underlying mechanics of a  financial card transaction. 

Unfortunately, for many defenders, this knowledge is fragmented: reverse engineers often possess granular knowledge of these tools' technical characteristics but only high-level knowledge of why these tools actually work. Likewise, financial analysts are likely to possess in-depth knowledge of the "cash out" mechanics of these tools but not a granular understanding of how they operate. 

This presentation seeks to bridge this gap for both parties. With a focus on ISO-8583 and eXtensions for Financial Services (XFS), this talk will offer analysts an opportunity to understand the underlying, publicly documented standards that allow these malware families to operate. Attendees will learn how knowledge of these standards provides invaluable information that can be used to build a preliminary intelligence snapshot regarding the adversaries' intrusions and tooling capabilities. In addition, the presentation will explore some of the operational advantages and disadvantages inherent in choosing to use this type of malware.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Perlow-FASTCash-And-INJX_Pure-How-Threat-Actors-Use-Public-Standards-For-Financial-Fraud.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Perlow-FASTCash-And-INJX_Pure-How-Threat-Actors-Use-Public-Standards-For-Financial-Fraud-wp.pdf)
### NoJITsu: Locking Down JavaScript Engines
Data-only attacks against dynamic scripting environments have become common. Web browsers and other modern applications embed scripting engines to support interactive content. The scripting engines optimize performance via just-in-time compilation. Since applications are increasingly hardened against code-reuse attacks, adversaries are looking to achieve code execution or elevate privileges by corrupting sensitive data like the intermediate representation of optimizing JIT compilers. This has inspired numerous defenses for just-in-time compilers.Our work demonstrates that securing JIT compilation is not sufficient. First, we present a proof-of-concept data-only attack against a recent version of Mozilla's SpiderMonkey JIT in which the attacker only corrupts heap objects to successfully issue a system call from within bytecode execution at run time. Previous work assumed that bytecode execution is safe by construction since interpreters only allow a narrow set of benign instructions and bytecode is always checked for validity before execution. We show that this does not prevent malicious code execution in practice. Second, we design a novel defense, dubbed NOJITSU to protect complex, real-world scripting engines from data-only attacks against interpreted code.The key idea behind our defense is to enable fine-grained memory access control for individual memory regions based on their roles throughout the JavaScript lifecycle. For this we combine automated analysis, instrumentation, compartmentalization, and Intel's Memory-Protection Keys to secure SpiderMonkey against existing and newly synthesized attacks. We implement and thoroughly test our implementation using a number of real-world scenarios as well as standard benchmarks. We show that NOJITSU successfully thwarts code-reuse as well as data-only attacks against any part of the scripting engine while offering a modest run-time overhead of only 5%.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Park-NoJITsu-Locking-Down-JavaScript-Engines.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Park-NoJITsu-Locking-Down-JavaScript-Engines-wp.pdf)
### Stealthily Access Your Android Phones: Bypass the Bluetooth Authentication
Every Android phone loves Bluetooth, a short-range wireless communication technology. We can find a large number of Bluetooth devices in any public place. Many of their security issues have been exposed before, such as BlueBorne, KNOB, and BadBluetooth. Today, due to the security risks in AOSP (Android Open Source Project) and the negligence of some well-known mobile phone manufacturers, we have another 0day vulnerability that can be played. And it was named BlueRepli (Bluetooth Replicant).At the application layer, Bluetooth is like a parent who over-disciplined. It defines various implementation standards for a variety of complex application scenarios. These standards are called profiles. Some of these profiles will access extremely sensitive user data, such as PBAP (Phone Book Access Profile) for synchronizing phonebook, MAP (Message Access Profile) that can access SMS data, SAP (SIM Access Profile) that serves remote devices using local SIM cards and so on. Of course, the use of these profiles by remote devices requires authorization from local users and strict authentication from local Android phones.However, this study found two new ways to bypass these authentications and gain profile access. The first method is a new attack idea. It can obtain permissions when the target has only one interaction, and attackers can make this interaction very deceptive. The second method will use the undisclosed 0day vulnerability BlueRepli, which can get profile access without any sense. We also prepared rich video demos to show the exploits we implemented, such as stealing mobile phone contact information, call history, stealing SMS verification codes, and sending fake text messages using the vulnerable phone.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Xu-Stealthily-Access-Your-Android-Phones-Bypass-The-Bluetooth-Authentication.pdf)
### Superman Powered by Kryptonite: Turn the Adversarial Attack into Your Defense Weapon
Artificial Intelligence (AI) is wielding a profound impact on global economic and social progress as well as ordinary citizens' daily life. However, with the advancement of AI technology, the next-generation hackers have successfully built a deep learning model that can more easily and efficiently destroy previously unbreakable security mechanisms (e.g., for the most complex CAPTCHAs, the recognition rate is 99%).Similar to the scene in 'Avengers 3' when 'Thanos' (Hackers) created the "Infinity Gauntlet" (AI-powered exploit toolkit) with six gems, and inevitably erases half the universe creature with a finger snap. In reality, as avengers (security defenders), we propose to leverage the weakness of the omnipotent 'Infinity Gauntlet' (AI) to flight evils (hackers). The irony is that the weapon, named 'Adversarial Machine Learning (ML)' used to explore the weakness of AI, was developed by attackers themselves.Adversarial ML exploits vulnerabilities in AI models and crafts inputs to machine learning models that an attacker has intentionally designed to cause the model to make mistakes (i.e., optical illusions for machines). The rationale behind our idea is that we deliberately add "adversarial perturbation" to our "target asset" that does not affect human use, but entirely misleads hacker's AI tools. In the example of "CAPTCHAs" service, we demonstrate how to use multiple levels of adversarial attack methods to fool hacker's AI tools and to detect hackers when they use AI toolkits. Another contribution we made in this paper is to "reprogram" hacker's AI toolkit and steal hacker's computing resources to perform tasks for us.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Ying-Superman-Powered-By-Kryptonite-Turn-The-Adversarial-Attack-Into-Your-Defense-Weapon.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Wednesday/us-20-Ying-Superman-Powered-By-Kryptonite-Turn-The-Adversarial-Attack-Into-Your-Defense-Weapon-wp.pdf)
### Needing the DoH: The Ongoing Encryption and Centralization of DNS
Most connections on the Internet start with a DNS request. As the connections themselves increasingly have moved to encrypted methods (primarily HTTP to HTTPS), surveillance and data aggregation by service providers and nation states have transitioned from monitoring the contents of the connection itself to monitoring unencrypted headers and their DNS requests.In an attempt to protect DNS queries from Monster in the Middle (MITM) interception and manipulation, DNS-over-TLS (DoT) and DNS-over-HTTPS (DoH) have emerged as new proposed standards. These have evoked some concerns as they represent major changes to both the end user and network operators.These concerns fit into three broad categories: *Centralization* as users move to the few DNS providers that support DoT/DoH; *Visibility & Control* as network operators continue to use DNS as a way to provide services, security, and gather network data; *Moving to Layer 7* as some software decides to handle DNS internally rather than push it down the network stack.I will demonstrate that while the concerns around centralization are well founded, they are in all likelihood temporary. The concerns around visibility and control are well founded but can be addressed without losing the guarantees of encryption or network administrator control and visibility. I will show that the concerns regarding the move into Layer 7 are the most significant for benign network operators, but also a substantial improvement for consumers on public and home networks and how these concerns can be balanced against each other.I will also be open sourcing a tool which detects DoT/DoH support on DNS servers that are advertised in the DHCP leases and optionally uses the encrypted protocols on systems that do not natively support DoT/DoH. This is to encourage the encryption of DNS while also respecting the provided DNS servers.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Alexander-Needing-The-DoH-The-Ongoing-Encryption-And-Centralization-Of-DNS.pdf)
### Practical Defenses Against Adversarial Machine Learning
Adversarial machine learning has hit the spotlight as a topic relevant to practically-minded security teams, but noise and hype have diluted the discourse to gradient-based comparisons of blueberry muffins and chihuahuas. This fails to reflect the attack landscape, making it difficult to adequately assess the risks. More concerning still, recommendations for mitigations are similarly lacking in their calibration to real threats. This talk discusses research conducted over the past year on real-world attacks against machine learning systems which include recommendation engines, algorithmic trading platforms, email filtering - in addition to the classic examples of facial recognition and malware classification. We'll begin by discussing the difference between academic and deployment attack environments before diving into real-world attack examples. Most importantly, the bulk of the session will detail practical defensive measures.
### Hacking the Voter: Lessons from a Decade of Russian Military Operations
Election security faces a persistent problem: defenders are often thinking tactically, while the most capable, deliberate adversaries are thinking strategically. Getting ahead of ever evolving election interference operations will require understanding adversaries' long-term goals and how they are shaping their election interference activities to outmaneuver tactical defenses. In this talk, we will look at lessons learned from nearly a decade of election interference activities linked to the Russian military's espionage and special forces agency, the GRU. We will examine how Russia's policy elites believe information has a fundamental role in international relations and how this perspective shapes GRU strategies and tactics. This perspective reframes historic GRU operations and suggests how different GRU tactics could be brought to bear in future instances of election interference. The analysis will be used to provide a framework and guidance for organizations—both obvious targets and those that may have a more subtle strategic value—that may need to prepare for these operations. As defenders, it is not enough for us to know that attacks occur or that vulnerabilities exist without considering the attackers and their motivations. By understanding why adversaries act, we can better anticipate when, where, and in what form those actions may occur and take deliberate action to mitigate risk based on that insight.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Beach-Westmoreland-Hacking-The-Voter-Lessons-From-A-Decade-Of-Russian-Military-Operations.pdf)
### IoT Skimmer: Energy Market Manipulation through High-Wattage IoT Botnets
Despite the many conveniences afforded by Internet of Things (IoT) devices, their rapid and global deployment has increased the attack vector and raised serious security and privacy concerns for enterprise users and customers. Vulnerable IoT devices can be hacked and harnessed into giant botnets that threaten even properly secured networks. In this talk, we will present IoT Skimmer, a hierarchical structure which leverages the potential of high-wattage IoT botnets to slightly manipulate the total demand of the power grid and attack deregulated electricity markets. Our proposed approach is the first energy market manipulation cyberattack and presents two attacker models based on the adversary's motivation and end goal: i) the attacker can cause maximum financial profit/damage to a particular market player (e.g., power plant owner or power utility), and ii) the attacker can cause financial damage to the entire market players.Attacker one aims to alter the electricity price in the energy market by slightly changing the total power demand of the system and gain monetary profits for particular market players while causing financial loss to the rest. Attacker two, the nation state actor, leverages a nonlinear attack model to cause financial damage to the entire energy market and all its players, which may be weaponized as part of a trade/cold war.We have defined and analyzed several stealth strategies such that the attacks remain stealthy from both the market operator and end users' perspectives. The performance of the proposed attacks is evaluated with real-world datasets acquired from two of the largest energy markets in the US, New York, and California. The obtained results illustrate the huge economic impact of IoT Skimmer attack on the studied markets. Finally, a set of technical recommendations are proposed to reduce the vulnerability and attack vector, thereby decreasing the potential consequences of the discussed attacks.
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Shekari-IoT-Skimmer-Energy-Market-Manipulation-Through-High-Wattage-IoT-Botnets.pdf)
### Office Drama on macOS
In the world of Windows, macro-based Office attacks are well understood (and frankly are rather old news). However on macOS though such attacks are growing in popularity and are quite en vogue, they have received far less attention from the research and security community.In this talk, we will begin by analyzing recent macro-laden documents targeting Apple's desktop OS, highlighting the macOS-specific exploit code and payloads. Though sophisticated APT groups are behind several of these attacks, these malicious documents and their payloads remain severely constrained by recent application and OS-level security mechanisms.However, things could be far worse! Here, we'll detail the creation of a powerful exploit chain that began with CVE-2019-1457, leveraged a new sandbox escape and ended with a full bypass of Apple's stringent notarization requirements. Triggered by simply opening a malicious (macro-laced) Office document, no alerts, prompts, nor other user interactions were required in order to persistently infect even a fully-patched macOS Catalina system!To conclude, we'll explore Apple's new Endpoint Security Framework illustrating how it can beleveraged to thwart each stage of our exploit chain, as well as generically detect advanced "document-delivered" payloads and even persistent nation-state malware!
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Wardle-Office-Drama-On-macOS.pdf)
### When TLS Hacks You
Lots of people try to attack the security of TLS. But, what if we use TLS to attack other things? It's a huge standard, and it turns out that features intended to make TLS fast have also made it useful as an attack vector.Among other things, these features provide a lot of flexibility for Server-Side Request Forgery (SSRF). While past work using HTTPS URLs in SSRF has relied upon platform-specific bugs such as SNI injection, we can go further. In this talk, I present a novel, cross-platform way of leveraging TLS to target internal services.Uniquely, these attacks are more effective the more comprehensively a platform supports modern TLS, so won't go away with library upgrades. It is also unlikely that the TLS spec will change overnight at the whim of a random security researcher. Instead, we need to walk through scenarios and dispel common assumptions so the audience can make informed code and infrastructure decisions. Of course, the best way to do so is with demos!
- [slide](http://i.blackhat.com/USA-20/Wednesday/us-20-Maddux-When-TLS-Hacks-You.pdf)
### Demigod: The Art of Emulating Kernel Rootkits
Kernel rootkit is considered the most dangerous malware that may infect computers. Operating at ring 0, the highest privilege level in the system, this super malware has unrestricted power to control the whole machine, thus can defeat all the defensive and monitoring mechanisms. Unfortunately, dynamic analysis solutions for kernel rootkits are severely lacking; indeed, most existing dynamic tools are just built for userspace code (ring 3), but not for Operating System (OS) level. This limitation forces security researchers to turn to static analysis, which however proved to be very tricky & time consuming.This research proposes a novel approach to deal with kernel rootkits. We introduce Demigod, a framework to emulate OS environments, so kernel rootkits can be run in software emulators, all in ring 3. From this sandbox, we can safely monitor, trace, debug or perform all kinds of dynamic analysis with this advanced malware.Emulating complicated OS such as Windows, MacOS & Linux is a challenging task. We will present all the technical issues we had to deal with, including how we built our own loader and dynamic linker, how to emulate the OS environment, essential kernel components and system APIs to allow rootkits to work.Designed and implemented as a cross-platform-architecture engine, Demigod can emulate Windows/MacOS/Linux/BSD on X86/Arm/Aarch64/Mips. On top of Demigod, we built some advanced tools to analyze kernel rootkits, including some automated solutions, providing the malware analyst new weapons to ease their labor work.This talk includes a series of live demos to show how we employ our superior toolset to dissect several well-known kernel rootkits of Windows, MacOS & Linux. We will also explain how to extend Demigod to handle more sophisticated malware in the future.Demigod will be released after our presentation, with full source code.
### Locknote: Conclusions and Key Takeaways from Day 1
At the end of day one of this year's virtual conference, join Black Hat Review Board members Chris Eng, Daniel Cuthbert, Marina Krotofil, and Natalie Silvanovich for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day one and how these trends will impact future InfoSec strategies.
### Hacking Public Opinion
Online disinformation has reached fever pitch: grifters pushing fake cures for COVID-19, nation states spinning pandemic conspiracies, domestic ideologues coordinating to push manipulative videos about presidential candidates. Malign actors are finding and exploiting divisions in our society using vulnerabilities in our information ecosystem. The flood of conflicting messages is overwhelming individuals and manipulating communities - and social networks are struggling to keep up.Information operations aren’t new; they are conducted within the confines of the information environment at the actor’s disposal and evolve along with technology and media infrastructure. The rules are determined by the infrastructure – in this case, the features and algorithms of social platforms. The most sophisticated players -- nation states -- leverage not only social networks but network infiltration to influence, distract, and manipulate large communities of people.This talk offers an overview of the mechanics of modern-day information operations. Using a deep dive into the tactics behind some of the most impactful recent operations, the speaker will demonstrate the ways in which hacking the information environment is similar and different from the kind of intrusions the audience normally deals with. We will conclude with a look ahead to the 2020 elections and a call-to-action for the audience to deploy their skills in the defense of democracy.
### Lamphone: Real-Time Passive Reconstruction of Speech Using Light Emitted from Lamps
Recent studies have suggested various side-channel attacks for eavesdropping sound by analyzing the side effects of sound waves on nearby objects (e.g., a bag of chips and window) and devices (e.g., motion sensors). These methods pose a great threat to privacy, however they are limited in one of the following ways: they (1) cannot be applied in real time (e.g., Visual Microphone), (2) are not external, requiring the attacker to compromise a device with malware (e.g., Gyrophone), or (3) are not passive, requiring the attacker to direct a laser beam at an object (e.g., laser microphone). In this talk, I introduce "Lamphone," a novel side-channel attack for eavesdropping sound; this attack is performed by using a remote electro-optical sensor to analyze a hanging light bulb’s frequency response to sound. I show how fluctuations in the air pressure on the surface of the hanging bulb (in response to sound), which cause the bulb to vibrate very slightly (a millidegree vibration), can be exploited by eavesdroppers to recover speech and singing, passively, externally, and in real time. I analyze a hanging bulb’s response to sound via an electro-optical sensor and learn how to isolate the audio signal from the optical signal. Based on our analysis, I develop an algorithm to recover sound from the optical measurements obtained from the vibrations of a light bulb and captured by the electro-optical sensor. I evaluate Lamphone’s performance in a realistic setup and show that Lamphone can be used by eavesdroppers to recover human speech (which can be accurately identified by the Google Cloud Speech API) and singing (which can be accurately identified by Shazam and SoundHound) from a bridge located 25 meters away from the target room containing the hanging light bulb.  
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Nassi-Lamphone-Real-Time-Passive-Reconstruction-Of-Speech-Using-Light-Emitted-From-Lamps.pdf)
### Breaking VSM by Attacking SecureKernel
Virtualization based security technologies (VBS) continue to increase the world's dependency on the security of virtualization stacks. But like all software stacks, virtualization stacks are prone to vulnerabilities too. 

In this talk, we will explain how we found and fixed two vulnerabilities in SecureKernel in Windows 10, which is a critical component of the core of the TCB (Trusted Computing Base) for Microsoft's VBS model. The vulnerabilities could allow an attacker to gain arbitrary code execution in VTL1, compromising the entire VBS model.  We will also walk through our process to exploit both vulnerabilities on the latest version of Windows (at the time of writing).

To understand these vulnerabilities, we will first discuss the technical differences in Windows between normal world (VTL0) and secure world (VTL1). Normal world is used for general application use, while secure world is designed to be smaller yet securer, which is used to ensure the integrity and security of the entire system. This difference in design is finally reflected on implementations, i.e. secure mode kernel customizes its memory and pool management, process management and even security mitigations. State-of-the-art exploitation techniques in normal mode kernel may not find their way here in secure kernel, novel techniques suitable for VSM exploit will be demonstrated in our talk.

Finally, we will share the takeaways Microsoft had from this research, and explain our approach to harden SecureKernel and VSM.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Amar-Breaking-VSM-By-Attacking-SecureKernal.pdf)
### EtherOops: Exploring Practical Methods to Exploit Ethernet Packet-in-Packet Attacks
The concept of physical layer conditions in which a packet is re-evaluated in transit leading to a packet-in-packet attack has been shown in multiple protocols in the past. However, applying this logic to the Ethernet protocol was only considered a theoretical capability. In this talk, we explore various ways in which this attack can become both practical and powerful. Using this attack, we show how an attacker can bypass Firewall and NAT solutions, even when targeting networks directly from the Internet. Combining this attack with fringe use-cases we discovered in the IPv6 implementations in Windows and Linux, we show how an attacker can use this attack to establish a man-in-the-middle position on the Internet traffic of a certain organization, through which he can eavesdrop on corporate communications, or carry out additional attacks.Our talk will demonstrate that the set of circumstances in which an Ethernet packet-in-packet condition can occur are much wider than previously considered. We will detail the physical parameters of Ethernet cables in which the likelihood of a bit-flip is rather high, and in which this attack can occur within a few minutes. In addition, we will explore the various ways in which interference can be induced in a wide array of Ethernet cable types using certain radio attacks, leading to a remote Ethernet packet-in-packet attack occurring within minutes.Lastly, we will detail various techniques in which this attack may be triggered from the Internet, in either 1-click attacks that require a user inside the network to click on a certain link, or certain 0-click attacks that work without any user interaction. Once the packet-in-packet attack occurs, the attacker can take-over devices using previously discovered vulnerabilities, or establish a MiTM position on an organization's Internet traffic.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Seri-EtherOops-Exploring-Practical-Methods-To-Exploit-Ethernet-Packet-In-Packet-Attacks.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Seri-EtherOops-Exploring-Practical-Methods-To-Exploit-Ethernet-Packet-In-Packet-Attacks-wp.pdf)
### Making an Impact from India to the Rest of the World by Building and Nurturing Women Infosec Community
India is one of the most diverse and fastest growing countries in the world and due to the fast growth, women often are left behind. The world average female literacy rate is 79.7%, while in India the average rate is just 65.46, and for women that enter the technology workforce it is even lower and for those entering into cyber security it is even less. The talk is about the journey of Infosecgirls community which started in India with the goal of bringing more women into the cyber security workforce and integrating them with the larger community and is now reaching a global audience. The Initiative was conceptualized because of a need to have a warm and nurturing environment for women where they can easily discuss information security and over a period of time moulded to help women, students, kids, and underprivileged communities to come forward and be part of cyber security ecosystem.In the talk, I will share how we started, the challenges encountered on the way, what we have achieved so far, and the learnings from our journey. I will also talk about the free technical training we provide at conferences or colleges and how these trainings have enabled individuals start their InfoSec journey or make themselves better and more confident in their roles.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Sehgal-Making-An-Impact-From-India-To-The-Rest-Of-The-World-By-Building-And-Nurturing-Women-Infosec-Community.pdf)
### Escaping Virtualized Containers
Containers offer speed, performance, and portability, but do they actually contain? While they try their best, the shared kernel is a disturbing attack surface: a mere kernel vulnerability may allow containerized processes to escape and compromise the host. This issue prompted a new wave of sandboxing tools that use either unikernels, lightweight VMs or userspace-kernels to separate the host OS from the container's OS.One of these solutions is Kata Containers, a container runtime that spawns each container inside a lightweight VM, and can function as the underlying runtime in Docker and Kubernetes. Kata's virtualized containers provide two layers of isolation: even if an attacker breaks out of the container, he is still confined to the microVM.Several Cloud Service Providers are deploying Kata in production to support customer multitenancy in their Serverless and CaaS offerings. With its focus on isolation, does Kata Containers actually contain? In this talk, we'll put Kata's isolation to the test, and attempt to escape the container, break out of the encapsulating VM, and finally, compromise the host.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Avrahami-Escaping-Virtualized-Containers.pdf)
### Security Research on Mercedes-Benz: From Hardware to Car Control
Nowadays, more and more intelligent functionalities have been introduced to modern cars, which also brings more attack surfaces to the cars. As a car security research team, we like to learn more about the luxury cars' design and development, so we initiated the research on Mercedes-Benz in 2018.In this talk, we will discuss how to perform security research on Connected Cars. First of all, we will talk about how to build a testbench with relevant intelligent components at a low cost. Secondly, we design an attack chain from the outside to the inside of the vehicle based on this testbench. Thirdly, we perform the attack chain in a genuine car. This talk will explain how we researched a Mercedes-Benz E-Class car and found the vulnerabilities. By exploiting these vulnerabilities, we can remotely unlock the door and start the engine and they potentially impact all Mercedes-Benz connected cars in China (estimated over 2 million).
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Yan-Security-Research-On-Mercedes-Benz-From-Hardware-To-Car-Control.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Yan-Security-Research-On-Mercedes-Benz-From-Hardware-To-Car-Control-wp.pdf)
### Fooling Windows through Superfetch
Have you ever tried to hide your traces after doing some obscure stuff on a computer? We usually think about cleaning histories, file lefts, event viewer, DNS cache, and registry keys but have you ever thought about Superfetch?This is a Windows service whose purpose is to increase the speed of user's experience. Superfetch will analyze user's software use to prelaunch the process next time the user might need it. It also includes files used by the program such as text documents, photos, and movies. In concrete terms, the service tracks every activity on the OS and records traces into files with a ".pf " extension, called scenarios. Whenever Superfetch wants to predict which program might be launched, it will consult its prefetch files, computes probabilities and then tries to predict user decisions. This constitutes a forensic gold mine for any governmental service or any malicious person since it raises a very serious privacy issue.In this talk, we will dive into Superfetch architecture, explain its operating method, and debunk all the myths surrounding it. In addition, we will detail the format of its inner files which were undocumented or obsolete up until now and we will show how to fool the system by editing these files. To this end, we have built a tool that allows accessing and falsifying the data of the scenarios without Windows noticing. Afterwards, the system incorporates the falsified data and processes it as the original. Thanks to this trick, you will be able to hide traces of your activity, lie to forensic analysis, or even create false evidence on a computer. Your system believes it knows everything about you: time has come to regain power.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Venault-Fooling-Windows-Through-Superfetch.pdf)
- [source_code](https://github.com/MathildeVenault/SysMainView)
### Multiple Bugs in Multi-Party Computation: Breaking Cryptocurrency&#39;s Strongest Wallets
Cryptocurrency wallets in exchange platforms or banks require strong security because they protect vast amounts of money. Some solutions rely on advanced cryptographic methods that distribute trust across multiple parties, in the spirit of Shamir's secret-sharing. These include multi-party computation (MPC) and threshold signature schemes (TSS), which are a special case of MPC to sign data in a distributed, yet trustless manner. TSS has notably been tested and deployed in major organizations where secret key generation and digital signing are needed. But these techniques, although powerful and "magic" on paper, can prove fragile in practice, as this talk will show.

We introduce MPC and TSS in a way suitable for non-experts, highlighting their unique properties and showing how they can be used to protect enterprise-grade wallets. We review TSS' building blocks such as verifiable secret sharing and Schnorr signatures and explain the design and security goals of TSS libraries, and how these goals differ from those of traditional cryptography, in terms of managing complexity, interactiveness, and composition of protocols.

MPC and TSS seem very secure and state-of-the-art, so what could go wrong?

Complexity is the enemy of security, and this complexity is what we exploit. We describe a new type of logical vulnerability, enabled by extra layers of complexity in TSS implementations, which opens up a new attack surface and devastating attacks allowing a malicious participant to sabotage key generation and break TSS's security. This attack could allow an attacker, for example, to empty an organization's cold wallet. We describe a related attack on a major MPC solution used by a leading organization.

We conclude with lessons learned and best practices across the development pipeline of complex cryptographic software, including extensive testing, defense-in-depth controls, how to implement new academic work, and how an audit by specialists should be done to be the most effective.
### How I Created My Clone Using AI - Next-Gen Social Engineering
This talk is inspired by an episode of Black Mirror. I will be demonstrating a live demo creating a bot who talks like me and can be used to impersonate me online and do social engineering. I will be showing a live demo of how to a create such bots over text, voice or video and walk through various techniques which the attendees can use to create such smart social engineering attacks.I will also release my github of the AI notebooks as open source for the attendees to try out and experiment.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Basu-How-I-Created-My-Clone-Using-AI-Next-Gen-Social-Engineering.pdf)
### Detecting Access Token Manipulation
Windows access token manipulation attacks are well known and abused from an offensive perspective, but rely on an extensive body of arcane Windows security internals: logon sessions, access tokens, UAC, and network authentication protocols, such as Kerberos and NTLM, to name a few. Furthermore, some of this information is not easily found and can be complex for defensive practitioners to get to grips with, resulting in brittle detections and making it hard to identify the signal from the noise.

This presentation aims to demystify how access tokens work in Windows environments and show how attackers abuse legitimate Windows functionality to move laterally and compromise entire Active Directory domains. Most importantly, it will cover how to catch attackers in the act, and at scale, across enterprises. In doing so, defense practitioners will understand the key signals to identify access token manipulation within their own environments in order to detect and respond to these types of attacks.

The presentation will be heavy on Windows internals/APIs, undocumented tips and tricks, and reveal how red teaming and attack tools really work their magic.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Burgess-Detecting-Access-Token-Manipulation.pdf)
### Portable Document Flaws 101
PDF is a document format on steroids. In this talk, we will dive deep into the PDF specification and reveal its less known, insecure features. We perform a systematic and in-depth analysis of the capabilities of malicious PDF documents leading to vulnerabilities in all major PDF viewers. Our attacks are categorized into four classes: (1) Denial-of-Service attacks affecting the host on which the document is processed. (2) Information disclosure attacks which track who opens a document or leak personal data out of the victim's computer to the attacker's server, such as PDF document form data, local files, or user credentials. (3) Data manipulation attacks which modify form values, write local files on the host system, or mask the displayed content of a document based on the opening application. (4) Execution of code on the victim's machine, by silently launching an embedded executable. Finally, we propose a methodology to systematically protect against attacks based on legitimate-but-dangerous PDF document features.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Mueller-Portable-Document-Flaws-101.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Mueller-Portable-Document-Flaws-101-wp.pdf)
### I calc'd Calc - Exploiting Excel Online
The Microsoft Security Response Center has a unique position in monitoring exploits in the wild. While we have seen several cases in the past years of exploits targeting Office applications, often PowerPoint or Word, exploits targeting online applications are less common. Are they only possible? And in which case, how would one attack the Office Web Application server (WAC)? Can a malicious document be used? How hard would that be, how much time would it take? This is the story of a project realized during summer 2018 to try to answer these questions with Excel Online. This short presentation describes an integer overflow vulnerability in the fnConcatenate formula (CVE-2018-8331) and how one could chain Excel formulas together to get RCE on the server. This talk will detail the research from scratch up to showing a demo of the exploit against Excel OnPrem.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Joly-I-Calcd-Calc-Exploiting-Excel-Online.pdf)
### Building Cyber Security Strategies for Emerging Industries in Sub Saharan Africa
The increase in cyber attacks in sub-Saharan Africa has become an issue of major concern for the region and its people. With the increase in use of digital technology, cyber security is becoming a critical aspect of the day-to-day lives of individuals and organisations. A 2019 report by The World Economic Forum placed cybercrime as one of the three greatest threats in Africa.Sub-Saharan Africa is well connected to the global economy with regard to commerce and finance. This means that the cyber threats affecting the regions with both local and international origins should be put into consideration with the onset of every new technology. Globally, Africa has been geographically segmented with the Middle East in the cyber security market. However, there is a big divide in the adaptation of technology and cyber security between sub-Saharan Africa and North Africa/The Middle East.A report based on IDC's Sub-Saharan Africa CIO survey of 2019 estimates the total sub-Saharan ICT market to grow from $95.4bn in 2020 to $104.2bn by 2023. According to the same report, technologies such as cloud, social media and big data are some of the key areas of growth in 2020.As the use of technology has become widespread across the region, Sub-Saharan Africa experiences a great many cyber attacks annually, both attacks that are seen in other parts of the world but also attacks that are specific to the region.A study conducted by the International Data Group connect shows that sub-Saharan Africa's economy has been hard hit by cybercrime. The data shows that cybercrime costs South Africa an estimated $573m annually with Nigeria and Kenya losing $500m and $36m respectively. Seen in proportion to GDP of the countries, this represents tremendous sums lost to cybercrime. While these figures show the size of the problem in this part of the world, 96% of African organizations set an average annual budget of $5,000 for cyber security. Pan-African Cybersecurity and Business consulting firm Serianu ranked banking sectors and government as the most targeted by cyber criminals.Cyber crime in Africa has been on a rapid increase compared to the rest of the world with an estimate of 80% of personal computers being infected with some kind of malicious software. One of the most affected industries in sub-Saharan Africa is the financial sector. Globally, Africa leads in the use of mobile money transfers with an estimated 14% citizens receiving money through mobile money transfer like Kenya's MPesa. With sub-Saharan Africa hosting some of the biggest mobile money transfer services, mobile money has over the years been a primary target for criminals. Some of the threats that have affected the mobile banking industry are social engineering and reverse engineering of mobile money apps for malicious purposes. A lot of mobile money users and providers have been immensely affected by criminal activities targeting the platform.With cybercrime on the rise, Sub-Saharan countries lack proper legislation, such as cyber laws, to govern the cyber space thus creating a permissive environment for cyber criminals. Most countries in the region struggle to implement cyber security measures due to budgetary concerns and the small number of skilled cyber security practitioners.Some of the common challenges faced in the cyber security industry in sub-Saharan Africa include:High cost of cyber security toolsLimited security budgetsUse of pirated versions of cyber-security solutionsAbsence of adequate tools to provide accurate dataGrowing cyber threat owing to 5G deploymentOver-dependence on cloudIn order for sub-Saharan Africa to realize its full potential in cyber security, effective policies have to be implemented. Solutions designed must be geared toward the distinct operating environment of the sub-Saharan region. The question of cost is an inescapable facet of any technology implementation, even more so in the African context. Local currency values tend to be volatile thus depending on foreign solutions might be costly compared to the amount local companies can afford to budget for cyber security.Encouraging local security practitioners to develop open source or affordable tools that will work for the local market. Tools such as the mth3l3m3nt for web app pentesting and MARA framework for reverse engineering which were both designed by Kenyan cyber security practitioners can strengthen the security stature of the sub-Saharan region.As the technology grows complex and diverse by the day, so does the surface for malevolent exploitation. Sub-Saharan countries however, continue to emulate technologies, policies and strategies implemented by more developed countries. These fall short in addressing needs specific to the threat landscape in the region thus creating a need to adapt available resources and formulate comprehensive regulatory policies that would better govern the cyber security ecosystem in the region. A more sophisticated and organized cybersecurity system is required in order to curb existing and emerging threats. Our goal is to examine how sub-Saharan Africa can exploit existing skill sets and resources to create a system that works for the region.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Koech-Building-Cyber-Security-Strategies-For-Emerging-Industries-In-Sub-Saharan-Africa.pdf)
### A Framework for Evaluating and Patching the Human Factor in Cybersecurity
Social engineering (SE) attacks have dramatically changed in recent years: They are no longer limited to PCs and they goes way beyond phishing. Despite those changes, current methods for evaluating the resilience of users to SE attacks are still mainly focus on phishing attacks and do not distinguish between different platforms.Furthermore, current methods depend, to a large extent, on the subjects’ response to surveys, which tend to be subjective, biased and require the subjects’ active involvement and collaboration; thereby are less accurate and consuming significant human resources. Other solutions are based on measuring the momentary behaviour of subjects while facing a simulated phishing attack. These methods however, tend to be sensitive to environmental factors and cannot be used for evaluating users’ behaviour continuously.We present a methodology and an automated, scalable and objective framework for continuously evaluating the resilience of users to specific types of social engineering attacks. The methodology includes a set of measurable criteria for a security aware user; and an expert-based procedure for deriving security awareness models for different attacks classes (each class is an aggregation of SE attacks that exploit a similar set of human vulnerabilities). The framework utilizes data collected and analyzed from different data sources to measure the set of criteria:Android agent, which measures the users' actual behaviourwhile operating with their smartphones.Chrome extension, which measures the users' actual behaviourwhile operating with their PCsNetwork traffic monitor, which analyzes the network traffic transmitted-to/received-from the devices.Attack simulator, which implement multiple type of SE attacks on the users. In order to evaluate the proposed framework, we conducted an empirical experiment involving 162 users for a duration of seven to eight weeks. The results show that (1) the skills required from a user to mitigate an attack are different for different attack classes; (2) the self-reported behaviour of users differs significantly from their actual behaviour  and (3) the security awareness level derived from the actual behaviour of users is highly correlated with their ability to mitigate SE attacks.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Bitton-A-Framework-For-And-Patching-The-Human-Factor-In-Cybersecurity.pdf)
### Plundervolt: Flipping Bits from Software without Rowhammer
Fault attacks pose a substantial threat to the security of our modern systems, allowing to break cryptographic algorithms or to obtain root privileges on a system. Fortunately, fault attacks have always required local physical access to the system. This changed with the Rowhammer attack (Black Hat USA 2015), which for the first time enabled an attacker to mount a software-based fault attack. However, as countermeasures against Rowhammer are developed and deployed, fault attacks require local physical access again.In this Black Hat talk, we present the next step, a long-awaited alternative to Rowhammer, a second software-based fault attack primitive: Plundervolt.Dynamic frequency and voltage scaling features have been introduced to manage ever-growing heat and power consumption in modern processors. Design restrictions ensure frequency and voltage are adjusted as a pair, based on the current load, because for each frequency, there is only a certain voltage range where the processor can operate correctly. For this purpose, many processors (including the widespread Intel Core series) expose privileged software interfaces to regulate processor frequency and operating voltage dynamically.In this talk, we show that these privileged interfaces can be reliably exploited to undermine the system's security. We present the Plundervolt attack, in which a privileged software adversary abuses an undocumented Intel Core voltage scaling interface to corrupt the integrity of Intel SGX enclave computations. Plundervolt carefully controls the processor's supply voltage during an enclave computation, inducing predictable faults within the processor package. Consequently, even Intel SGX's memory encryption/authentication technology cannot protect against Plundervolt. In multiple case studies, we show how the induced faults in enclave computations can be leveraged in real-world attacks to recover keys from cryptographic algorithms (including the AES-NI instruction set extension) or to induce memory safety vulnerabilities into bug-free enclave code. We finally discuss why mitigating Plundervolt is not trivial, requiring trusted computing base recovery through microcode updates or hardware changes.We have responsibly disclosed our findings to Intel on June 7, 2019. Intel assigned CVE-2019-11157 to track this vulnerability and refer to mitigations. The scientific paper on Plundervolt will appear at the IEEE Security & Privacy Symposium 2020.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Murdock-Plundervolt-Flipping-Bits-From-Software-Without-Rowhammer.pdf)
### A Decade After Stuxnet&#39;s Printer Vulnerability: Printing is Still the Stairway to Heaven
In 2010, Stuxnet, the most powerful malware in the world revealed itself, causing physical damage to Iranian nuclear enrichment centrifuges. In order to reach Iran's centrifuges, it exploited a vulnerability in the Windows Print Spooler service to gain code execution as NT AUTHORITY\SYSTEM. Due to the hype around this critical vulnerability, we (and probably everyone else) were pretty sure that this attack surface would no longer exist a decade later. We were wrong…The first clue was that two out of three vulnerabilities which were involved in Stuxnet were not fully patched. That was the case also for the 3rd vulnerability used in Stuxnet, which we were able to exploit again in a different manner. It appears that Microsoft has barely changed the code of the Windows Print Spooler mechanism over the last 20 years. We started to investigate the Print Spooler mechanism in the latest Windows 10 Insider build and discovered two 0-day vulnerabilities providing LPE as SYSTEM and Denial-of-Service. The first one can also be used as a new, unknown persistence technique.In this presentation, we will present:Past Stuxnet's vulnerabilities and how they were partially patched (even multiple times)The analysis of the 3rd Stuxnet vulnerability in the Windows Print Spooler, which was considered fully patched until nowA live demo of two 0-day vulnerabilities we discovered in the Windows Print Spooler. One of them works on all the Windows releases from 2000 to Windows 10 (32 and 64-bit); the other works on all the Windows releases from Windows 7 to Windows 10 (32 and 64-bit)Our research process, our methodology and home-brewed toolsA more robust way to mitigate future exploitation of similar vulnerabilitiesSeveral open-source tools for testing the system against the attack, mitigating it and helping other researchers to challenge this mechanism as well.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Hadar-A-Decade-After-Stuxnet-Printer-Vulnerability-Printing-Is-Still-The-Stairway-To-Heaven.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Hadar-A-Decade-After-Stuxnet-Printer-Vulnerability-Printing-Is-Still-The-Stairway-To-Heaven-wp.pdf)
### Spectra: Breaking Separation Between Wireless Chips
Nowadays wireless technologies are increasingly sharing spectrum. This is the case for Wi-Fi and Bluetooth, but also some LTE bands and harmonics. Operating on the same frequency means that these different technologies need to coordinate wireless spectrum access to avoid collisions. Especially for nearby sources, as it is the case for multiple chips within one smartphone, so-called coexistence is the key to high-performance spectrum sharing.Coexistence between wireless chips can be implemented in various ways. While there are open specifications, most manufacturers opt to develop proprietary coexistence mechanisms to further improve performance. Open interfaces are not needed on combo chips that implement multiple wireless technologies, as the manufacturer has full control.Spectra, a new vulnerability class, relies on the fact that transmissions happen in the same spectrum and wireless chips need to arbitrate the channel access. While coexistence should only increase performance, it also poses a powerful side channel.We are the first to explore side-channel attacks on wireless coexistence. We specifically analyze Broadcom and Cypress combo chips, which are in hundreds of millions of devices, such as all iPhones, MacBooks, and the Samsung Galaxy S series. Note that other manufacturers also rely on coexistence and similar attacks might apply.We exploit coexistence in Broadcom and Cypress chips and break the separation between Wi-Fi and Bluetooth, which operate on separate ARM cores. In general, denial-of-service on spectrum access is possible. The associated packet meta information allows information disclosure, such as extracting Bluetooth keyboard press timings within the Wi-Fi D11 core. Moreover, we identify a shared RAM region, which allows code execution via Bluetooth in Wi-Fi. This makes Bluetooth remote code execution attacks equivalent to Wi-Fi remote code execution, thus, tremendously increasing the attack surface. During code execution within the Wi-Fi firmware, we even experience kernel panics on Android and iOS.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Classen-Spectra-Breaking-Separation-Between-Wireless-Chips.pdf)
### IMP4GT: IMPersonation Attacks in 4G NeTworks
Long Term Evolution (LTE/4G) establishes mutual authentication with a provably secure AKA protocol on protocol layer three. But missing integrity protection of user traffic still allows an adversary to manipulate IP packets. In this talk, we present the IMP4GT attack (IMPersonation attacks in 4G neTworks), which allows an attacker to impersonate a user towards the network and vice versa. IMP4GT is a cross-layer attack against LTE/4G networks that exploit missing integrity protection on layer two and extend it with a reflection mechanism of the IP stack. We demonstrate the feasibility of two IMP4GT variants in a commercial network and thereby completely break the mutual authentication aim of LTE on the user plane in a real-world setting. Our work implies that providers can no longer rely on mutual authentication for billing, access control, and legal prosecution. Also, the current 5G specification does not mandate integrity protection, which makes it vulnerable to IMP4GT attacks.
### Kr00k: Serious Vulnerability Affected Encryption of Billion+ Wi-Fi Devices
We identified Kr00k (CVE-2019-15126) – a previously unknown vulnerability in chips used by a significant proportion of all Wi-Fi capable devices. Specifically, we discovered that Wi-Fi chips by Broadcom and Cypress – and possibly other manufacturers – could be forced to encrypt some packets in a WPA2-protected network with an all-zero encryption key. In a successful attack, this allows an adversary to decrypt some wireless network packets. The number of affected devices was likely over a billion as the vulnerable chips are used in devices from Apple, Samsung, Google, Amazon, and many others.The presentation will include technical details and a demonstration, where we will show how we were able to trigger Wi-Fi reassociations on the targeted device, force setting the all-zero encryption key and decrypt intercepted packets. We will also discuss the potential impact of these vulnerabilities, along with the limitations of exploiting them.This new research follows our earlier discovery that some versions of the popular Amazon Echo and Kindle devices were vulnerable to Key Reinstallation Attacks (KRACK), which were discovered by Mathy Vanhoef in 2017. We will explain how Kr00k is related to the previously known research – and how it differs.Exclusively for Black Hat USA, we will also cover our most recently discovered Wi-Fi encryption vulnerabilities affecting other chip manufacturers, including Qualcomm.Finally, we will discuss and release our proof-of-concept testing script designed trigger and detect the Kr00k vulnerability on unpatched devices.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Lipovsky-Kr00k-Serious-Vulnerability-Affected-Encryption-Of-Billion-Wi-Fi-Devices.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Lipovsky-Kr00k-Serious-Vulnerability-Affected-Encryption-Of-Billion-Wi-Fi-Devices-wp.pdf)
### Hunting Invisible Salamanders: Cryptographic (in)Security with Attacker-Controlled Keys
Deploying new cryptography often means using existing building blocks in new ways. A prime example is authenticated encryption (AE). Until recently, AE schemes like Galois/Counter Mode (GCM) were mostly used in settings where key exchange first established a hidden, random encryption key (think TLS or IPSec). Increasingly, though, schemes like GCM are also being used in settings where the attacker knows, or can guess, the key. This attack setting is the subject of my talk. It is aimed at security professionals who design, implement, and deploy cryptography, but will be accessible to a general security audience.My talk will have three main parts. First, I will explain our attack setting, specifically where, why, and how a real attacker could know (or just have a good guess about) an AE encryption key. I’ll go over a few examples, including password-based AE, and discuss the committing security property AE must have in this setting. Intuitively, if an AE is committing, it is hard to find a ciphertext that decrypts correctly under more than one key.Next, I will show that, surprisingly, modern AE schemes lack this committing property (they are non-committing) and are insecure in our setting. For GCM, GCM-SIV, or any Poly1305-based scheme, it is easy to find ciphertexts that decrypt correctly under multiple keys. I will walk through a simple two-key example with GCM and outline how to go from two to hundreds of thousands of keys with a little bit of math.Finally, I will demonstrate attacks that result from improper use of non-committing AE. I’ll first show that with the two-key GCM example above, any Facebook user could have bypassed the “message franking” protocol for reporting abusive content in Secret Conversations and sent unreportable abusive messages. Then I will introduce partitioning oracles, a new class of decryption error oracle (akin to padding oracles) on non-committing AE that can recover keys (instead of plaintext). Partitioning oracle attacks can lead to exponential speedups over online brute-force attacks when low-entropy secrets like passwords are used to derive AE keys. They arise in many places: for example, I will show that when the OPAQUE password-authenticated key exchange protocol is implemented incorrectly, partitioning oracle attacks result. I’ll conclude with guidance on how to recognize when committing AE is needed. I’ll also recommend committing AE schemes that can be used today.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Grubbs-Hunting-Invisible-Salamanders-Cryptographic-Insecurity-With-Attacker-Controlled-Keys.pdf)
### Breaking Brains, Solving Problems: Lessons Learned from Two Years of Setting Puzzles and Riddles for InfoSec Professionals
Many of us got into security because we like solving hard problems, and problem-solving is often listed as a specific requirement in security job descriptions. You might need problem-solving skills to crack niche technical issues in exploit development or mitigation, or when investigating threats and compromises. Or it might be more general, like developing strategies and policies. But what does it mean to be 'good' at problem-solving? How do our minds work when solving problems? More importantly, how do we get better at it?In this talk, I'll present findings from over two years of creating and setting puzzles and riddles designed specifically for a team of 300 cyber security professionals as part of a dedicated program. Some were technical challenges, similar to CTFs; others focused on linguistics, lateral-thinking, probability, mathematics, and logic. I'll cover the program's inception; how its puzzles were designed and solved; and the findings - including an analysis of improvements over time, which types of puzzles were most popular/solved and why, and case studies of where improvements in problem-solving actively helped with day-to-day work. I'll set all this against a background of academic research on problem-solving, discussing the mental processes which take place and how they can be strengthened with practice and exposure to different types of challenges.I'll also share some observations on how the program fostered collaboration and cooperation between staff from different teams, technical abilities, and backgrounds – sometimes deliberately, sometimes completely accidentally.Finally, I'll conclude by sharing some resources which have helped me, give you tips on starting your own puzzle program, and suggest ways in which the community can work together to build and maintain a repository of puzzles and findings. I'll also set a puzzle during the talk - first to message me with the correct answer wins a prize!
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Wixey-Breaking-Brains-Solving-Problems-Lessons-Learned-From-Two-Years-Of-Setting-Puzzles-And-Riddles-For-Infosec-Professionals.pdf)
### Compromising the macOS Kernel through Safari by Chaining Six Vulnerabilities
Compromising a kernel through a browser is the ultimate goal for offensive security researchers. Because of continuous efforts to eliminate vulnerabilities and introduce various mitigations, a remote kernel exploit from a browser becomes extremely difficult, seemingly impossible.In this talk, we will share our Safari exploit submitted to Pwn2Own 2020. Combining six different vulnerabilities, our exploit successfully compromises the macOS kernel starting from the Safari browser. It breaks every mitigation in macOS including ASLR, DEP, sandbox, and even System Integrity Protection (SIP). Inspecting every vulnerability used in this exploit, we will show not only state-of-the-art hacking techniques but also challenges in protecting complicated systems (i.e., browsers and operating systems) and in introducing their mitigations. Moreover, we will introduce a new technique that reliably exploits a TOCTOU vulnerability in macOS.
### EdTech- The Ultimate APT
This talk will show the audience that edtech is being implemented in schools without due regard for privacy or harm reduction. In doing this talk, it would be hoped that attention could be drawn to these serious issues and possibly, some action might be taken.Currently, only those with young people in their network are concerned. Longer term this trojan horse effect of implementing edtech without due diligence, risks harming large parts of society. This may sound alarmist and the aim is not FUD. The talk will present this trojan horse issue and prove the harm or point to possible harms.The talk outlines several privacy issues with edtech apps and platforms and shows how harm is done: from the privacy t&c to the way data is stored, to the sharing of information without informed consent. The talk examines providers such as Pearson, BBC, Edulink and Pixl and walks the audience through exactly where the privacy issues are and how harm is or could be done.We will also look at the use of biometrics in schools- from canteen fingerprint pay to facial recognition - and show the flaw in the data storage as well as the lack of informed consent for its use.This will be contrasted with investment in educator tech skills- even DPO at schools are often unable to understand or challenge issues. We have schools where many educators barely have access to a working PC or copier, but we are implementing facial recognition and up to 30 apps in the school.This talk aims to be a call to action. It will inform the audience of key issues and give them important questions they can ask edtech vendors or education institutions. Education is a rite of passage; we encourage students and families to trust the system they have to participate in. That trust is currently being eroded and abused by some edtech and we have duty to slow the harm.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Wolfe-Edtech-The-Ultimate-Apt.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Wolfe-Edtech-The-Ultimate-Apt-wp.pdf)
### A Little Less Speculation, a Little More Action: A Deep Dive into Fuchsia&#39;s Mitigations for Specific CPU Side-Channel Attacks
We know the story by now: researchers find a new side-channel attack and disclose it under embargo. Vendors build patches and ship them. We read about it on $TechSite and move on.But what happens if you show up after the party's over and want to understand and mitigate these problems in your own codebase? That's the problem faced by the Fuchsia team at Google, which is building a new open-source operating system based on a microkernel called Zircon. Fuchsia needs to handle user, kernel, and hypervisor attacks across x86 and ARM processors.In this talk, we will walk through how the Fuchsia team enumerated existing CPU side-channels, explored how they are mitigated in well-known operating systems, and undertook the engineering work of applying these mitigations to Fuchsia. We will also describe how Fuchsia is testing those mitigations to make sure they keep working.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Riley-A-Little-Less-Speculation-A-Little-More-Action-A-Deep-Dive-Into-Fuchsias-Mitigations-For-Specific-CPU-Side-Channel-Attacks.pdf)
### About Directed Fuzzing and Use-After-Free: How to Find Complex & Silent Bugs?
Fuzzing is a popular and effective automated approach to vulnerability detection. Directed fuzzing focuses on automatically testing specific parts of the code by taking advantage of additional information such as bug stack traces or patches. Key applications include bug reproduction and patch-oriented testing. While very successful, recent fuzzing techniques (directed or not) are not well suited for Use-After-Free vulnerabilities (UAF), where some deallocated memory is reused through a dangling pointer (UAF represent only 1% of issues found by OSS-Fuzz in 2017). This is unfortunate as UAF possibly lead to data corruption, information leaks, or denial of service. Fuzzing UAF is hard for two reasons: (1) UAF bugs are complex – need to find input covering three events (alloc, free, use) in sequence; (2) UAF bugs are silent – they often do not crash immediately. The obvious solution is to pair fuzzing with memory sanitizaters such as Valgrind, however the induced runtime overhead is terrible for fuzzing. We propose UAFuzz, the first (binary-level) directed greybox fuzzer dedicated to UAF bugs. The technique features a fuzzing engine tailored to UAF specifics (adapting standard fuzzing components: seed selection, distance metric and power schedule), a lightweight code instrumentation and an efficient bug triage step allowing to send only a fraction of the generated input to the sanitizer for bug confirmation. Our technique is implemented on top of AFL-QEMU and Valgrind. UAFuzz outperforms state-of-the-art directed fuzzers (AFLGO and Hawkeye) on bug reproduction (detection rate, time-to-exposure). UAFuzz has also been proven effective in patch-oriented testing, leading to the discovery of 30 new bugs, 7 CVEs and 4 buggy patches. Several fuzzing talks have already been given to Black Hat. Our proposal is the first to focus on directed fuzzing and use-after-free.Finally, we will publicly release our UAF fuzzing benchmark and the UAFuzz tool.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Bardin-About-Directed-Fuzzing-And-Use-After-Free-How-To-Find-Complex-And-Silent-Bugs.pdf)
### When Lightning Strikes Thrice: Breaking Thunderbolt 3 Security
Thunderbolt is a high-bandwidth interconnect promoted by Intel and included in laptops, desktops, and other systems. Being PCIe-based, Thunderbolt devices possess Direct Memory Access (DMA)-enabled I/O. In an "evil maid" DMA attack, where adversaries obtain brief physical access to the victim system, Maartmann-Moe (Inception), Frisk (PCILeech) and others have shown Thunderbolt to be a viable entry point in stealing data from encrypted drives and reading and writing all of system memory. In response, Intel introduced "Security Levels", a security architecture designed to enable users to authorize trusted Thunderbolt devices only. To further strengthen device authentication, the system is said to provide "cryptographic authentication of connections" to prevent devices from spoofing user-authorized devices.We present Thunderspy, a series of attacks that break all primary security claims for Thunderbolt 1, 2 and 3. So far, our research has found seven vulnerabilities: inadequate firmware verification schemes, weak device authentication scheme, use of unauthenticated device metadata, downgrade attack using backwards compatibility, use of unauthenticated controller configurations, SPI flash interface deficiencies, and no Thunderbolt security on Boot Camp. Finally, we present nine practical exploitation scenarios. In an "evil maid" threat model and varying Security Levels, we demonstrate the ability to create arbitrary Thunderbolt device identities, clone user-authorized Thunderbolt devices, and finally obtain PCIe connectivity to perform DMA attacks. In addition, we show unauthenticated overriding of Security Level configurations, including the ability to disable Thunderbolt security entirely, and restoring Thunderbolt connectivity if the system is restricted to exclusively passing through USB and/or DisplayPort. We conclude with demonstrating the ability to permanently disable Thunderbolt security and block all future firmware updates.All Thunderbolt-equipped systems shipped between 2011-2020 are vulnerable. Some systems providing Kernel DMA Protection, shipping since 2019, are partially vulnerable. The Thunderspy vulnerabilities cannot be fixed in software, impact future standards such as USB4 and Thunderbolt 4, and will require a silicon redesign.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Ruytenberg-When-Lightning-Strikes-Thrice-Breaking-Thunderbolt-3-Security.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Ruytenberg-When-Lightning-Strikes-Thrice-Breaking-Thunderbolt-3-Security-wp.pdf)
- [source_code](https://github.com/BjornRuytenberg/tcfp)
### Heroku Abuse Operations: Hunting Wolves in Sheep&#39;s Clothing
Black Hat attendees 'get' security - but strategically speaking, where does abuse management fit?Abuse Operations - at its core - is detection of and response to malicious activity when everything is working "as designed." Classical security is interested in prevention, governance, and compliance, while abuse operations looks at the wider picture of misuse, abuse, malice and crime. At any moment in time, multiple actors are bypassing detection and response systems masquerading as customers in order to take unfair advantage of your systems and services. Different from the full compromise scenarios we know and love, abuse is a slow simmering burn, where our customers can become a problem, and worse, your problem. Attendees in this session will get an insider's view into active abuse on one of the largest pure-play, remote-code-execution-as-as service (RCE-aaS) platforms on the Internet: Heroku.Allan and Spencer walk through the cat-and-mouse hunt for ever-evolving miscreant behavior hidden in the sea of legitimate users, build mechanisms to turn low value indicators into high value decisions, and show the value of "pushing left" to make the platform less hospitable for abuse.For attendees dealing with abuse - this session will start conversations on how we engage abuse at scale - and the scaffolding you can apply on Monday when you get back to work.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Cureton-Heroku-Abuse-Operations-Hunting-Wolves-in-Sheeps-Clothing.pdf)
### Remote Timing Attacks on TPMs, AKA TPM-Fail
Trusted Platform Module (TPM) serves as a hardware-based root of trust that protects cryptographic keys from privileged systems and physical adversaries. These devices are generally based on a cryptographic coprocessor such as Arm SecurCore and can be found on various computing platforms such as smartphones and industrial systems. In this talk, we first discuss our work on black-box timing analysis of TPM 2.0 devices deployed on commodity computers. Our analysis reveals that some of these devices feature secret-dependent execution times. We show how this information allows an attacker to apply lattice-based techniques to recover 256-bit private keys for signatures based on elliptic curves. As a result, we can even extract private keys from a hardware TPM manufactured by STMicroelectronics, which is certified at Common Criteria (CC) EAL 4+.We further highlight the impact of these vulnerabilities by presenting a remote attack against a StrongSwan IPsec VPN that uses a TPM to generate the digital signatures for authentication. In this attack, the remote client recovers the server's private authentication key by timing only authentication handshakes.These vulnerabilities we have uncovered emphasize the difficulty of correctly implementing known constant-time techniques and show the importance of evolutionary testing and transparent evaluation of cryptographic implementations. Even certified devices that claim resistance against attacks require additional scrutiny by the community and industry, as we learn more about these attacks. As a solution, we finally present a novel technique based on Dynamic Instrumentation and Mutual Information Analysis to efficiently locate and quantify memory-based and control-flow based leakages in software. We develop a software framework named MicroWalk for side-channel analysis of binaries, which can be extended to support new classes of leakage. We show that automatic testing using our tool would have discovered these issues during the development.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Moghimi-Remote-Timing-Attacks-On-TPMs-AKA-TPM-Fail.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Moghimi-Remote-Timing-Attacks-On-TPMs-AKA-TPM-Fail-wp.pdf)
### Improving Mental Models of End-to-End Encrypted Communication
Research has repeatedly established that although many messaging apps (WhatsApp, iMessage, Signal etc.) have incorporated end-to-end encryption (E2EE) as a feature, user understandings of E2EE communications are not completely accurate. As a result, some users may turn to less secure platforms (e.g., SMS or landline calls) to exchange confidential information, may not know how to react to some E2EE related tasks, such as performing authentication ceremonies. These misunderstandings can cause users greater security and privacy risks than they realize. Our work aims to tackle this issue by creating and utilizing practical explanations of E2EE to improve the functionality of users' mental models. We developed our educational efforts through a series of user studies. First, we conducted a participatory-design tutorial study (n=25) to understand what information about E2EE is most useful to and will likely be absorbed by end users. Based on the results, we generated short, medium, and long-length educational texts and measured their effectiveness in isolation with an online survey study (n=459). Finally, we evaluated the messages in context with a longitudinal study. We incorporated the best-performing messages into an exemplar open-source messaging app (based on Signal), and asked participants to interact with it for three weeks. Final results of the longitudinal study will be available this early July.In this talk, we will discuss our design approach and the results of our intervention on users' mental models. We will share the implications of our work for the UX design of privacy-preserving communications tools.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Akgul-Improving-Mental-Models-Of-End-To-End-Encrypted-Communications.pdf)
### The Dark Side of the Cloud - How a Lack of EMR Security Controls Helped Amplify the Opioid Crisis
The Opioid crisis has caused mass addiction of prescription painkillers. Tens of thousands have died from this. Families have been broken apart. Children have been born addicted. It has stretched the social support network we have to its breaking point.A major reason for this was the manipulation of a popular Electronic Health Records (EHR) system, Practice Fusion, on behalf of a pharmaceutical company. The US Department of Justice singled out the marketing department of an Opioid manufacturer for paying approximately $1M to change a decision support tool used by physicians, a Clinical Decision Support alert, to recommend their opioid products as part of treatment plans. This led to the unnecessary prescription of opioids to tens of thousands of patients and helped fuel a major crisis.The Electronic Health Record system utilized is targeted at smaller physician practices that do not have the resources of larger health systems to examine Clinical Decision Support alerts. In this case, Practice Fusion was utilized by over 100,000 small to medium-sized medical practices.Most medical practices, according to the American Medical Association, have 10 or fewer physicians. Approximately one third of hospitals, according to the American Hospital Association, have negative operating budgets and lose money. These are organizations that care about keeping the lights on.However, the HITECH Act and associated incentive programs have encouraged medical providers to get on board with Electronic Medical Records.This presentation will show evidence of how the Opioid Crisis exposed an operational security weakness with EHR systems, and why just patching those alerts doesn't address it. We will also discuss how to address it as part of a larger operational framework in partnership with larger health systems. With the current lack of support for smaller practices, we expect this attack type to continually occur unless resolved.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Parker-The-Dark-Side-Of-The-Cloud-How-A-Lack-Of-EMR-Security-Controls-Helped-Amplify-The-Opioid-Crisis.pdf)
### Exploiting Kernel Races through Taming Thread Interleaving
A kernel race condition vulnerability is difficult to exploit, because thread interleaving is non-deterministic and cannot be controlled. Thus, conventional exploitation techniques against kernel races simply attempt to brute force, i.e., keep exploiting the race in hopes that the execution orders happen to be indeed racing. However, we observed that many kernel races cannot be exploited through brute forcing including three recent Linux kernel race vulnerabilities, because the chance to race is virtually zero.This presentation introduces a new kernel race condition exploitation technique. The key idea behind our new race exploitation technique is to tame the thread execution order based on the clear understanding of the kernel’s thread interleaving mechanism. With our new exploitation techniques, we demonstrate how three Linux kernel races can be successfully exploited within 10-100 seconds, all of which were not exploitable given in 24 hours through simple brute forcing.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Lee-Exploiting-Kernel-Races-Through-Taming-Thread-Interleaving.pdf)
### Routopsy: Modern Routing Protocol Vulnerability Analysis and Exploitation
An often-overlooked area of network security are the routing and redundancy protocols used between routing endpoints. Specifically, Dynamic Routing Protocols (DRP) such as OSPF, RIP, EIGRP, and First Hop Redundancy Protocols (FHRP) such as VRRP and HSRP are poorly understood by InfoSec attackers and defenders, have limited tooling that is either aging and unmaintained or hard to understand without first having a mastery of the protocols. This talk will showcase several common misconfigurations of these protocols on networks, and how this can be used for Person-in-the-Middle attacks and network discovery. Additionally, Kubernetes Network Providers are reliant on some of these protocols and these misconfigurations could also be present. We'll be releasing new research into how these protocols and their weaknesses can be exploited leveraging a virtual router and orchestration that we've created for defenders to test their network for such vulnerabilities or pentesters to demonstrate the weaknesses.Most DRP's, such as OSPF, rely on multicasting to initiate the process of establishing neighbor adjacencies and are often configured without a proper authentication method or clear separation from the control plane. These vulnerabilities allow an attacker to introduce a rogue neighbor, allowing them to observe networks which are abstracted from computing end points, or to tamper with routing table entries. A malicious route can be used to cause DNS/SMB redirection to conduct Person-in-the-Middle attacks. DRP's are not the only protocols which could be configured insecurely. Layer three, FHRP's such as VRRP are often configured insecurely, where exploitation allows person-in-the-middle attacks similar to ARP spoofing.These attacks typically required either a virtual firewall bridged onto a target network, or use of a dated open source tool such as Loki or Yersinia. A modern alternative to solve these problems will be released during this talk.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Ziolkowski-Routopsy-Modern-Routing-Protocol-Vulnerability-Analysis-And-Exploitation.pdf)
- [source_code](https://github.com/sensepost/routopsy)
### Dive into Apple IO80211FamilyV2
Starting from macOS Catalina Beta, Apple refactored the architecture of the 80211 Wi-Fi client drivers and renamed the new generation design to IO80211FamilyV2. Compared with IO80211Family (V1), modules such as Version 2 and AppleBCMWLANCore integrate the original AirPortBrcm series drivers and further expand features such as Sidecar and Skywalk. These latest changes provide better support and protection for communication and data sharing between devices. Of course, we should also realize that new features are always accompanied by new vulnerabilities and potential risks of being attacked.This research will delve into each of the affected Wi-Fi kernel components and explore new attack surfaces. We will also share with you more than a dozen zero-day vulnerabilities, which can be classified into at least four categories from the high level of the architecture:Vulnerabilities affecting only V1. In other words, V2 fixes vulnerable functions. Unfortunately, these important improvements have not been synchronized with other system platforms, so we can use them to attack targets like the latest macOS High Sierra and Mojave.Vulnerabilities affecting only V2. In short, developers mistakenly introduced security flaws into Catalina when porting existing V1 functions.Vulnerabilities that affect both V1 and V2.Vulnerabilities in the new features of V2. In fact, many codes have not been rigorously audited and tested. Through these brand new cases, this presentation will help you better understand the design and security challenges of Apple's 80211 Wi-Fi subsystem.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Wang-Dive-into-Apple-IO80211FamilyV2.pdf)
### Experimenting with Real-Time Event Feeds
Today, defenders in a typical security operation center rely on their SIEM to do forensics on past logs, and to define real-time detections. This assumes that the SIEM was configured ahead of time to collect the subset of logs that are useful. But how does one decide what is useful? Further, some data comes at such high-volume that storing it in raw form is prohibitively expensive. Such data must be prefiltered and summarized before storage for query.We present tools and a method of comparing various options of filtering and pre-processing real-time feeds of data before storage. This can be done in isolated environments without SIEM coverage, such as labs/honeypots for researching Malware or Proof of Concept (POC) for exploits.The learnings of the method can be applied to understanding novel threats and creating true-real-time detections that work directly on the stream of events (no storage involved).
### My Cloud is APT&#39;s Cloud: Investigating and Defending Office 365
As organizations increase their adoption of cloud services, we see attackers following them to the cloud. Microsoft Office 365 is becoming the most common email platform in enterprises across the world and it is also becoming an increasingly interesting target for threat actors. Office 365 encompasses not only Exchange, but also Teams, SharePoint, OneDrive, and more. The sheer volume of data stored in Office 365 means that in many cases an attacker need not compromise the on-premise network to complete their mission.In this talk, we walk through a number of case studies taken from real APT intrusions that we've been a part of. We will begin with relatively unsophisticated techniques that are used by small-time actors and have been widely discussed. From there, we work our way up to the most sophisticated and stealthy techniques that we have only observed in the wild on a few occasions. These techniques utilize parts of Office 365 that are often poorly understood and not closely monitored.Along the way, we will provide insight into the various forensic artifacts available to an investigator and their many nuances. We will discuss some important gotchas that can trip up inexperienced analysts. Lastly, we will also discuss important best practices for administrators to defend their tenants against these increasingly sophisticated threats.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Bienstock-My-Cloud-Is-APTs-Cloud-Investigating-And-Defending-Office-365.pdf)
### Black-Box Laser Fault Injection on a Secure Memory
With the constant development of electronic devices, their increasing complexity and need for security, cryptography in embedded systems has become a strong requirement to protect data or secure communications. Some devices run on standard low-cost microcontrollers, which are vulnerable to low-budget physical attacks allowing the retrieval of secret materials, such as cryptographic keys. More sophisticated devices use dedicated security circuits able to withstand higher levels of physical attacks.We present vulnerability research conducted on one of those secure chips: the Microchip ATECC508A, a secure memory widely used in IoT devices, which is able to store small secret data blobs protected by cryptographic authentication. We present a vulnerability we found which allows a highly equipped and skilled attacker to retrieve a secret data slot by bypassing authentication using Laser Fault Injection.The talk walks through the experimental methodology we used to understand and develop the attack in a complete black-box approach, as the firmware of the device is an industry kept secret. Finally, we assess the difficulty of this attack in a real-case scenario: a PIN code and seed recovery on a hardware wallet, and demonstrate it is practical despite the setup cost.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Heriveaux-Black-Box-Laser-Fault-Injection-On-A-Secure-Memory.pdf)
### The Paramedic's Guide to Surviving Cybersecurity
The security world is fraught with cases of mental health issues, burnout, substance abuse, and even suicide. We live in a world of threats and responses that trigger the deepest parts of our psyche; with the barriers between "online" and the physical world constantly crumbling. While some deal in theory, many of us deal with real incidents, challenges, and dangers every day and are constantly looking for techniques to respond better while staying saner.

While we sometimes look to the experiences of the military to guide us, a closer analogy is that of emergency services in general, and Emergency Medical Services in particular. EMS is a relatively young profession, with the first Paramedic only hitting the streets in the 1970's. They deal with both real-time incidents and chronic systemic failures. They are constantly challenged by changing research and environments, and face multiple possible career paths. They also struggle with one of the highest burnout and suicide rates in the working world.

Rich Mogull has 30 years of experience as an EMT and Paramedic and over 20 years in information security. He's worked in inner cities, on mountaintops, and in major national disasters. Over the decades of following parallel careers he's realized not only the high degree of similarities between the two very-technical fields, but how security seems to be following a similar maturity path as EMS. In this story and research-filled session he will pull the lessons he learned in decades of emergency response and show how to apply them to your security career and daily practice to improve your effectiveness and mental resiliency, and perhaps avoid your first clean kill.
### TiYunZong: An Exploit Chain to Remotely Root Modern Android Devices - Pwn Android Phones from 2015 to 2020
As more and more mitigations have been introduced into Android, modern Android devices become much more difficult to be rooted, in particular, remotely rooted. This is especially true for Pixel Devices as they always have the latest updates and mitigations. In this presentation, we will explain why Pixel devices are difficult targets and will give an attack surface analysis of remotely compromising Android. Furthermore, we will introduce an exploit chain, named TiYunZong, which can be leveraged to remotely root a wide range of Qualcomm-based Android devices including Pixel Devices. The exploit chain includes three new bugs, which are CVE-2019-5870, CVE-2019-5877, CVE-2019-10567. We will also present an effective and stable approach to chain these three vulnerabilities for exploitation without any ROP, despite the fact that ROP is the most common technique to exploit complicated vulnerabilities. The exploit chain is the first reported one-click remote root exploit chain on Pixel devices and won the highest reward for a single exploit chain across all Google VRP programs.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Gong-TiYunZong-An-Exploit-Chain-To-Remotely-Root-Modern-Android-Devices.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Gong-TiYunZong-An-Exploit-Chain-To-Remotely-Root-Modern-Android-Devices-wp.pdf)
### Virtually Private Networks
Is Secure Remote Access like the emperor’s new clothes?Enterprise businesses equip staff with mobile devices such as laptops and smart phones to perform daily tasks. This makes the workforce much more mobile but places an implicit burden on the staff to ensure that they are always on-line. Security is handled by the underlying operating system and supporting solutions, for example a Secure Remote Access solution or “VPN”.Endpoint VPN technology has been around since at least 1996 when Microsoft created the Peer to Peer Tunneling Protocol (PPTP). OpenVPN and similar open source VPN technologies have advanced this tech from highly specialized to near commodity.However, enterprise Secure Remote Access solutions can be complicated and nuanced. One case involves remote workers that connect to complimentary Internet hotspots typically offered by coffee shops, airports, hotels, etc. Hotspots are Wi-Fi access points that offer free Internet bandwidth. Most hotspots today feature a captive portal that require either a password, voucher code, or some form of consent that involves agreeing to terms of use.A robust VPN implementation should not allow a user to interact with a network resource that bypasses the secure tunnel. What then happens in the time between connecting to the Wi-Fi hotspot and activating the tunnel? How vulnerable is the user during this time? Surely the Wi-Fi hotspot securely isolates guests and surely the local firewall on the laptop will protect the user from any attacker, but does this assumption hold even if the hotspot is fully under the control of an attacker?In this presentation, we will reveal research we conducted into the efficacy of modern commercial “VPN” solutions in the face of modern mobile worker use cases, typical endpoint technologies, and contemporary threat models.In short: How “secure” can remote access ever be?
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-vanderWalt-Virtually-Private-Networks.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-vanderWalt-Virtually-Private-Networks-wp.pdf)
### Lateral Movement and Privilege Escalation in GCP; Compromise any Organization without Dropping an Implant
Google Cloud's security model in many ways is quite different from AWS. Spark jobs, Cloud Functions, Jupyter Notebooks, and more default to having administrative capabilities over cloud API's. Instead of defaulting to no capabilities, permissions are granted to default identities. One default permission these identities have is called actAs, which allows a service by default to assume the identity of every service account in its project; many of which typically have role bindings into other projects and across an organization's resources. This means by default many API's and identities can compromise large swaths of an organization by moving laterally by impersonating or gaining access to other identities. This can all be done without dropping a single implant on a machine.In this talk, we'll demonstrate several techniques to perform identity compromise via the ActAs permission, privilege escalation, lateral movement, and widespread project compromise in Google Cloud. We will also release tools for exploitation.Next, we'll show what detection capabilities are possible in the Google Cloud ecosystem, by showing Stackdriver logs that correspond with our exploitation techniques, and showing limitations in what's available. We'll also release tools and queries that can be used for detection as well as insight to how we have attempted to tackle this problem at scale.Lastly, we'll go over remediation efforts you can take as a Google cloud customer, and show how difficult it can be to secure yourself against these attacks. We will release tools that can be used to harden your organization, and walk through user stories and anecdotes of what this process looks at scale within our organization.
### Beyond Root: Custom Firmware for Embedded Mobile Chipsets
Rooting a smartphone is often considered the ultimate method to allow a user to take complete control of their device. Despite this, many smartphones contain hardware which is closed off to any modification. This talk aims to show how this hardware can be reverse engineered in order to bypass its protections and further expand its functionality. 

Using proprietary NFC Controllers as an example, we will cover analysis of the protocols used by the chips, how the firmware protections could be broken, and how custom firmware could be developed and deployed to the phone with no hardware modifications. This will include methodologies for analysing weaknesses in firmware update protocols, leveraging the Unicorn CPU Emulator to bypass debugging restrictions, and techniques for reverse engineering the hardware capabilities of an unknown chip in order to implement custom features. This will end with demonstration of a smartphone with passive NFC sniffing capabilities and expanded tag emulation functionality.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Wade-Beyond-Root-Custom-Firmware-For-Embedded-Mobile-Chipsets.pdf)
- [source_code](https://github.com/Iskuri/Samsung-NFC-Controller-Reverse-Engineering)
### Operation Chimera - APT Operation Targets Semiconductor Vendors
This presentation provides an analysis of the advanced persistent threat (APT) attacks that have occurred during the past two years on the semiconductor industry. Our research shows that the majority of these attacks were concentrated on the Taiwan semiconductor sector. This is worthy of concern, as Taiwan's semiconductor industry plays a very crucial role in the world. Even a small disruption in the supply chain could have a serious ripple effect throughout the entire industry. Surprisingly, up until now, there has been less coverage on these attacks. In this presentation, we seek to shed light on the threat actors and campaigns of these attacks, where they are collectively referred to as Operation Chimera (a.k.a. Skeleton). Additionally, we provide a brief overview of the current information security status of Taiwan's semiconductor industry.Between 2018 and 2019, we discovered several attacks on various semiconductor vendors located at the Hsinchu Science-based Industrial Park in Taiwan. As these attacks employed similar attack techniques and tactics, a pattern could be discerned from the malicious activities. From this pattern, we deduced that these attacks, which we dubbed Operation Chimera, were actually conducted by the same threat actor. The main objective of these attacks appeared to be stealing intelligence, specifically documents about IC chips, software development kits (SDKs), IC designs, the source code, etc. If such documents are successfully stolen, the impact can be devastating. The motive behind these attacks likely stems from competitors or even countries seeking to gain a competitive advantage over rivals. Since the similar techniques and tactics to previous attack activities, we suspect the attacker is China-based hacker group. We thus hope that this presentation will help semiconductor companies gain a better understanding of the dangers from such attacks. Additionally, as we have worked with several of the semiconductor vendors to improve their cyber security, we wish to share this valuable experience, and highlight the current challenges facing the entire industry.In this presentation, we conduct a comprehensive analysis on the employed technologies, tactics, and customized malware of Operation Chimera. As this operation has not yet been documented, the techniques and tactics disclosed in this presentation can help blue teams design better defenses, and develop better detection and hunting methods. Below summarizes our findings of Operation Chimera.A unique account manipulation malware - SkeletonKeyInjector – was used. SkeletonKeyInjector contained code extracted from Dumpert and Mimikatz. This malware implanted a skeleton key into domain controller (DC) servers to continuously conduct lateral movement (LM). Additionally, by making direct syscalls, the malware could bypass security products based on API hooking. This malware was discovered in the two cases mentioned in this presentation.The threat actor utilized Cobalt Strike as their main remote-access Trojan (RAT). The mutated Cobalt Strike backdoor replaced and masqueraded as Google Update to confuse users. Additionally, as most corresponding (command and control) C2s were located in the Google Cloud Platform, it made it difficult to attribute the actor. Aside from the two cases mentioned in this presentation, we also detected the presence of this malware in other semiconductor vendors.Chimera used an old and patched version of RAR for data exfiltration. The same binary was found in the two cases mentioned in this presentation.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Chen-Operation-Chimera-APT-Operation-Targets-Semiconductor-Vendors-wp.pdf)
### Mind Games: Using Data to Solve for the Human Element
The security industry's traditional approach to mitigating human risk is predicated on the assumption that individuals will make the right security decisions if they have enough training and fear of the consequences. Years of security research indicates otherwise. This briefing will share key insights from nearly a dozen security training research studies and analysis of several dozen security behavioral change campaigns to more than 65,000 employees across industries.  We will show why traditional training approaches are ineffective in changing behaviors. Instead, our findings highlight techniques such as personal relevance, social proof, leveraging intrinsic motivation, and tight-feedback loops are key factors to reduce human risk.  This talk will explain why these behavioral change techniques are found to be most effective. We will then share concrete examples of how security teams can leverage these techniques to effectively reduce human risks such as phishing, malware downloads, and sensitive data handling in their own organizations.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Sedova-Mind-Games-Using-Data-To-Solve-For-The-Human-Element.pdf)
### You have No Idea Who Sent that Email: 18 Attacks on Email Sender Authentication
Our study demonstrates an unfortunate fact that even a conscientious security professional using a state-of-the-art email provider service like Gmail cannot with confidence readily determine, when receiving an email, whether it is forged. 

We identified 18 types of attacks to bypass email sender authentication (including SPF, DKIM, and DMARC). Leveraging those techniques, an attacker can impersonate arbitrary senders without breaking authentication and even forge DKIM-signed emails with a legitimate site's signature.  We evaluated our attacks against 10 popular email providers (e.g., Gmail.com, iCloud.com) and 19 email clients (e.g., Outlook, Thunderbird), and found all of them proved vulnerable to various attacks.  We reported our findings to the affected vendors, who rewarded our report and are actively addressing them. 

The root cause of the problem lies in insecure composition, a rising threat in today's distributed systems. The techniques we developed can be applied to identify similar vulnerabilities in other systems. We will make our testing tool publicly available via GitHub to aid the community in securing additional email systems.
- [slide](http://i.blackhat.com/USA-20/Thursday/us-20-Chen-You-Have-No-Idea-Who-Sent-That-Email-18-Attacks-On-Email-Sender-Authentication.pdf)
- [whitepaper](http://i.blackhat.com/USA-20/Thursday/us-20-Chen-You-Have-No-Idea-Who-Sent-That-Email-18-Attacks-On-Email-Sender-Authentication-wp.pdf)
- [source_code](https://github.com/chenjj/espoofer)
### A Hacker's Guide to Reducing Side-Channel Attack Surfaces Using Deep-Learning
In recent years, deep-learning based side-channel attacks have been proven to be very effective and opened the door to automated implementation techniques. Building on this line of work, this talk explores how to take the approach a step further and showcases how to leverage the recent advance in AI explainability to quickly assess which parts of the implementation is responsible for the information. Through a concrete set by step example, we will showcase the promise of this approach, its limitations, and how it can be used today.
### Locknote: Conclusions and Key Takeaways from Day 2
At the end of day two of this year's virtual conference, join Black Hat Review Board members Rodrigo Rubira Branco, Aanchal Gupta, Kymberlee Price, and Stefano Zanero for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day two and how these trends will impact future InfoSec strategies.