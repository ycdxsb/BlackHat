## BlackHat 2019
### Every Security Team is a Software Team Now
As software is eating the world, every company is becoming a software company. This doesn’t mean that every company is shipping software products, it means that services and products in every field are becoming increasingly driven, powered, and differentiated by software. Let’s explore what that will do to how cybersecurity is practiced in enterprises of all types.Peter Drucker famously said that “Culture eats strategy for breakfast.” There have been two large cultural shifts in software engineering over the last 20 years that created the successful strategies behind how software is eating the world. First, there was Agile (2001). In response to the inefficiencies of classic “waterfall” software development, Agile focused on breaking down the barriers between software requirements, development, and testing by having software development teams own their roadmaps as well as their quality. Separate product management organizations evolved into product owners working directly with the software team. Similarly, separate quality assurance organizations evolved into a focus on building quality into the software development process. This should remind us of how we talk about needing to build security in, but most importantly, this change was effected by software teams themselves vs. forced onto them by a separate security organization. There is a lesson to be learned there.Next came DevOps (2009), which brought the agile mindset to server operations. Software teams now began to own their deployment and their uptime. Treating software teams as the end-user and customer has driven the replacement of traditional ops with the cloud and replacing the traditional stack with serverless models. Ops teams evolved into software teams that provide platforms, tools, and self-service infrastructure to internal teams. They provide value by increasing internal teams’ productivity while reducing costs to the entire organization through economies of scale and other efficiencies. When a cross-functional team owns their features, their quality, their deployment, and their uptime, they fully own their end-to-end value stream. Next, they will evolve to also own their own risks and fully own their end-to-end impact.There are two big shifts involved as teams begin to own their end-to-end impact: software teams need to own their own security now and security teams need to become full-stack software teams. Just as separate product management and quality assurance organizations diffused into cross-functional software teams, security must now do the same. At his re:Invent 2018 Keynote, Amazon’s CTO Werner Vogels proclaimed that “security is everyone’s job now, not just the security team’s.” But if security is every teams’ job, what is the security team’s job? Just like how classic ops teams became internal infrastructure software teams, security teams will become internal security software teams that deliver value to internal teams through self-service platforms and tools. Security teams that adopt this approach will reduce the risk to the organization the most while also minimizing impact to overall productivity. In this talk, we’ll explore how this is already being done across high-performing companies and how to foster this security transformation at yours.
### A Decade After Bleichenbacher &#39;06, RSA Signature Forgery Still Works
In the 2006 CRYPTO rump session, Daniel Bleichenbacher gave a talk on how to exploit some implementation bugs of RSA signature verification for forgery attacks against key pairs with a small public exponent. What made his attack successful was that some implementations failed to enforce necessary verification checks required by the PKCS#1 v1.5 signature scheme. In its original form, the Bleichenbacher '06 attack took advantage of the fact that some implementations do not require the PKCS#1 payload to be right-justified with adequate padding. As a follow-up, Kuehn et al. in 2008 demonstrated new and more efficient variants of Bleichenbacher '06, exploiting different flaws where some middle parts of the PKCS#1 payload were ignored by the signature verifier. Subsequent research by Intel Security in 2014 found that Firefox and Google Chrome (both using Mozilla NSS back then) were susceptible to similar forgery attacks, and Valsorda also found similar issues in Python-RSA in 2016.The legacy of Bleichenbacher '06 however did not stop there - more than a decade after the original attack was reported, we revisit the problem of PKCS#1 v1.5 signature verification and discovered even more flaws in the code used by some popular IPSec software as well as TLS and crypto libraries, enabling new variants of the attack. Besides signature forgery, some flaws can even be abused by attackers to launch DoS on the signature verifier. Our investigation leverages dynamic symbolic execution to systematically analyze the signature verification logic in different implementations. We have released our toolchain and relevant artifacts. This research has resulted in 6 new CVEs (3 high and 3 medium severity) being assigned, and vendors were notified to harden their signature verification code. This briefing will conclude with a discussion on why such flaws happened and how to avoid similar mistakes.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Chau-A-Decade-After-Bleichenbacher-06-RSA-Signature-Forgery-Still-Works.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Chau-A-Decade-After-Bleichenbacher-06-RSA-Signature-Forgery-Still-Works-wp.pdf)
### ClickOnce and You&#39;re in - When Appref-ms Abuse is Operating as Intended
As tried-and-true methods of code execution via phishing are getting phased out, new research was required to maintain that avenue of gaining initial access. Sifting through different file types and how they operate led to further examination of the ".Appref-ms" extension, utilized by Microsoft's ClickOnce. This research led down a long and winding road, not only resulting in some new updates to be applied to our phishing methodology but an innovative method for C2 management as well - all while staying within the means of how appref-ms is intended to be used.Follow us down the rabbit hole as we delve into what an .appref-ms file is, how it operates, and some of the methods discovered that can be leveraged to deploy our own nefarious purposes. We will also provide insight on what this execution looks like from the user's perspective, and additional steps that can be taken throughout deployment to further mask and enhance these malicious capabilities.To play our own devil's advocate, we will also cover potential indicators of compromise that result from appref-ms abuse in addition to some preemptive measures that can be deployed to protect against it. Appref-ms abuse has the potential to be a great addition to any security tester's toolkit. It runs natively on Windows 10 and 7, blends in with normal operations, and is an easily adaptable method of code delivery and execution. It's up to you to determine how to use it.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Burke-ClickOnce-And-Youre-In-When-Appref-Ms-Abuse-Is-Operating-As-Intended.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Burke-ClickOnce-And-Youre-In-When-Appref-Ms-Abuse-Is-Operating-As-Intended-wp.pdf)
### Monsters in the Middleboxes: Building Tools for Detecting HTTPS Interception
The practice of HTTPS interception continues to be commonplace on the Internet. In a basic HTTPS connection, a browser (client) establishes a TLS connection directly to an origin server to send requests and download content. However, many connections on the Internet are not directly from a browser to the server serving the website, but instead traverse through some type of proxy or middlebox (a "monster-in-the-middle" or MITM). There are many reasons for a MITM to exist on a connection, both malicious and benign. Past research has shown that HTTPS interception is prevalent on the Internet and that it often degrades the security of Internet connections. A server that refuses to negotiate weak cryptographic parameters should be safe from many of the risks of degraded connection security, but there are plenty of reasons why a server operator may want to know if HTTPS traffic from its clients has been intercepted.First, detecting HTTPS interception can help a server to identify suspicious or potentially vulnerable clients connecting to its network. A server can use this knowledge to notify legitimate users that their connection security might be degraded or compromised. HTTPS interception also increases the attack surface area of requests between intercepted clients and servers, and presents an attractive target for attackers to violate the integrity and confidentiality of data between these two parties.Second, the presence of content inspection systems can not only weaken the security of TLS connections, but it can hinder the adoption of new innovations and improvements to TLS. Users connecting through TLS-terminating middleboxes may have connections downgraded to older versions of TLS still supported by the middleboxes; and therefore, may not receive the security, privacy, and performance benefits of new TLS versions. This can happen even if newer versions are supported by both the browser and server.In this talk, we will provide an overview of the various forms of HTTPS interception, the development of an open-source HTTPS interception detection tool, along with the insights we observed and want to share with the security community. (Check out the tool at: https://github.com/cloudflare/mitmengine).
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Valenta-Monsters-In-The-Middleboxes-Building-Tools-For-Detecting-HTTPS-Interception.pdf)
### Detecting Deep Fakes with Mice
Neural networks can generate increasingly realistic, human-like speech. These so-called "deep fakes" can be used in social engineering attacks. Bad actors can now impersonate any person's voice merely by gathering a few samples of spoken audio and then synthesizing new speech, utilizing off-the-shelf tools. But how convincing are these "deep fakes"? Can we train humans or artificial intelligence to spot the tell-tale signs of audio manipulation? In this work, we assessed the relative abilities of biology and machines, in a task which required discriminating real vs. fake speech. For machines, we looked at two approaches based on machine learning: one based on game theory, called generative adversarial networks (GAN) and one based on mathematical depth-wise convolutional neural networks (Xception).For biological systems, we gathered a broad range of human subjects, but also we also used mice. Recent work has shown that the auditory system of mice resembles closely that of humans in the ability to recognize many complex sound groups. Mice do not understand the words, but respond to the stimulus of sounds and can be trained to recognize real vs. fake phonetic construction. We theorize that this may be advantageous in detecting the subtle signals of improper audio manipulation, without being swayed by the semantic content of the speech.We evaluated the relative performance of all 4 discriminator groups (GAN, Xception, humans, and mice). We used a "deep fakes" data set recently published in Google's "Spoofing and Countermeasures Challenge" and we will report the results here.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Williams-Detecting-Deep-Fakes-With-Mice.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Williams-Detecting-Deep-Fakes-With-Mice-wp.pdf)
### Bypassing the Maginot Line: Remotely Exploit the Hardware Decoder on Smartphone
Though researchers have found lots of vulnerabilities in Stagefright framework for audio/video codecs on Android smartphones, all these vulnerabilities are in the software implementation of the AOSP. However, almost all smartphone chip manufacturers utilize the hardware implementation decoders to improve the performance and reduce battery consuming. For example, a complex video format, such as h264 or h265, will be given priority to decode by the hardware decoders.Therefore, lots of questions about hardware decoder remain unanswered. How does it work? What's the security status and overall impact to the whole system? What about the attack surface and mitigation? Can we find any vulnerabilities and exploit it? Our research will answer these questions.We focus on the hardware decoder named Venus on Qualcomm based smartphone. Venus is the dedicated video hardware decoder, which is a subsystem like Baseband, WLAN. This presentation will describe the architecture, the work principle, and the attack surface of Venus. Then we'll describe how to defeat the secure boot and setup the live debugger. Finally, we'll describe the vulnerabilities we found and how to exploit Venus remotely.Nowadays, there are plenty of security features and mitigations on the application processor of Android. For a real attack from the browser, we should gain arbitrary code execution first, escape from the sandbox, then break down the userspace application isolation. Finally, if we are lucky enough, we could escalate privilege into a process that can touch something like the device node exposed by the Kernel. The whole process can be a long journey. However, by attacking the hardware decoder, we can bypass all these defenses directly. In the hardware decoder, we have DMA, IO Port, shared memory with other processor, and messages with Kernel. There are plenty of attack surfaces into the Kernel and left behind security features like the Maginot Line.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Gong-Bypassing-The-Maginot-Line-Remotely-Exploit-The-Hardware-Decoder-On-Smartphone.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Gong-Bypassing-The-Maginot-Line-Remotely-Exploit-The-Hardware-Decoder-On-Smartphone-wp.pdf)
### Legal GNSS Spoofing and its Effects on Autonomous Vehicles
Many systems depend on accurate location information from Global Navigation System Satellites (GNSS) for normal operation. Public GNSS lacks integrity mechanisms and is vulnerable to spoofing. U.S. Federal law does not allow over-the-air spoofing of GNSS or other signals, which makes assessment of vulnerabilities difficult outside of an enclosed laboratory environment. This research proved the usefulness of a Mobile GNSS Spoofing System that enables legal, real-world evaluation of GNSS vulnerabilities. The mobile spoofing system was used to evaluate vulnerabilities in an Unmanned Ground Vehicle (UGV). The UGV GNSS was exploited using several different attacks including forced lane switching, driving off the road, and stopping the vehicle.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Murray-Legal-GNSS-Spoofing-And-Its-Effects-On-Autonomous-Vehicles.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Murray-Legal-GNSS-Spoofing-And-Its-Effects-On-Autonomous-Vehicles-wp.pdf)
### Biometric Authentication Under Threat: Liveness Detection Hacking
Biometric authentication has been widely used in scenarios such as device unlocking, App login, real-name authentication and even mobile payment. It provides people with a more convenient authentication experience compared with traditional technique like password.A classic biometric authentication process includes biometrics collection, preprocessing, liveness detection and feature matching. With the leakage of biometric data and the enhancement of AI fraud ability, liveness detection has become the Achilles' heel of biometric authentication security as it is to verify if the biometric being captured is an actual measurement from the authorized live person who is present at the time of capture. Previous research mainly focused on how to generate fake data but lack of systematic survey on the security of liveness detection. In this talk, we'll introduce our arsenal of attacking liveness detection and show how to apply them to bypass several off-the-shelf biometric authentication products, including 2D/3D facial authentication and voiceprint authentication. Our arsenal includes the following two kinds of weapons: -Injecting fake video or audio streams by evil hardware to hidden attack media-Creating specific recognition scene to trigger the defect of liveness detection algorithmMake use of above weapons and combinations thereof, we can:-Compromise App's biometric-based login or password recovery function then log in victim's account remotely by injecting fake video or audio streams which generated from a face photo or a short phone recording-Unlock a victim's mobile phone and then transfer his money through mobile payment App by placing a tape-attached glasses (we named it X-glasses) above sleeping victim's face to bypass the attention detection mechanism of both FaceID and other similar technologies.In addition, we propose a new attack model to log in App remotely based on hardware injection and device ID spoofing.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Chen-Biometric-Authentication-Under-Threat-Liveness-Detection-Hacking.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Chen-Biometric-Authentication-Under-Threat-Liveness-Detection-Hacking-wp.pdf)
### Battle of Windows Service: A Silver Bullet to Discover File Privilege Escalation Bugs Automatically
System services have always been an important component of Windows 10. In recent years, there have been quite a few privilege escalation vulnerabilities in them.At present, we can effectively automate the testing of memory corruption vulnerabilities by building fuzzers, but the discovery of logical vulnerabilities still relies more on manual inspection, and automated discovery has always been the goal to achieve.File privilege escalation is an important part of those bugs, if an attacker could gain full control of any file, they are able write shellcode into things like DLLs, then a system privilege process is created. After analyzing and summarizing the characteristics of historic vulnerability, I found there is a silver bullet to discover file privilege escalation bugs, and maybe there is a way to build a system based on it, so that's what I do next.I will share my full, in-depth details on this research. In this presentation, I will start from a historical bug analysis, then share the methodology about how I start this work with minimum knowledge as a web security researcher and knowing little about windows internal.I will explain the inner working of this technique about how I analyzed Advanced Local Procedure Call (ALPC), found new attack surfaces, and did some hot patches to make process monitor a command line tool to detect sensitive operation, make them combined together in a system, which could discover file privilege escalation bugs automatically. Also, will show some advanced skills about how I exploit those vulnerabilities, bypass the security check, and play with impersonation.Finally, I will talk about 4 new vulnerabilities found in one week, which could successfully perform local privilege escalation in windows 10 1803/1809, including one arbitrary file-read bug, one arbitrary file-delete bug, and two arbitrary file DACL rewrite bugs, which could get full control of any file with system privilege.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Wu-Battle-Of-Windows-Service-A-Silver-Bullet-To-Discover-File-Privilege-Escalation-Bugs-Automatically.pdf)
### SSO Wars: The Token Menace
It is the year 2019. Humanity has almost won its long-standing war against Single-Sign On (SSO) bugs. The last of them were discovered and eradicated some time ago and the world is now living in an era of prosperity while the Auth Federation enjoys peaceful CVE-free times. However, while things seem to be running smoothly, new bugs are brewing at the core of major implementation libraries. This is probably the last chance for the evil empire to launch a world scale attack against the Auth Federation.In this talk, we will present two new techniques:A new breed of SAML implementation flaws that break XML signature validation and enable arbitrary modification of the SAML assertion, which enables attackers to authenticate as arbitrary users or grant themselves arbitrary authorization claims. Although any implementation may be affected by this flaw, we will show how it affects Microsoft Windows Identity Framework (WIF) applications, Windows Communication Foundation (WCF) web services, and flagship products such as SharePoint and Exchange Servers.A bug in the .NET crypto library, which may allow attackers to gain Remote Code Execution (RCE) or Denial of Service (DoS) depending on the availability of code gadgets in the target server.A new tool to detect this type of vulnerability will also be discussed and released.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Munoz-SSO-Wars-The-Token-Menace.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Munoz-SSO-Wars-The-Token-Menace-wp.pdf)
### APIC's Adventures in Wonderland
Software-defined networking (SDN) along-side with micro-segmentation has been proposed as a new paradigm to deploy applications faster and, simultaneously, protect the individual workloads against lateral movement. Its implementation usually follows an application-centric view where the underlying network specifics are abstracted away from the management layers. Hence, an application developer only defines how similar parts of his application can communicate (e.g. web servers can connect to database servers on the following port) without considering the details of the network communication (e.g. IP addresses/subnets and routing tables).A prominent solution in this area is the Application Centric Infrastructure (ACI) by Cisco. ACI is based on Nexus switches in a spine-leaf configuration and one (or preferably more) Application Policy Infrastructure Controller (APIC). APICs are ACI's brain controlling the configuration of the switches to provide SDN and micro-segmentation capabilities for connected endpoints. Endpoints can then be aggregated into so-called endpoint groups (EPGs), which serve as the basic entities to apply filtering rules.In this talk, we will demystify the magic that surrounds the ACI wonderland and follow the APIC on its journey down the rabbit hole from when it gets first connected to the leaf switches till its configuration with EPGs and filtering rules. Along this journey we will participate in a crazy tea party. Here, the Mad Hatter will introduce us to the components involved in setting up the ACI fabric (including their background communication and used protocols), the March Hare will demonstrate what things can go wrong, and the Dormouse, before finally drifting to sleep, will release exploits for identified vulnerabilities.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Matula-APICs-Adventures-In-Wonderland.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Matula-APICs-Adventures-In-Wonderland-wp.pdf)
- [source_code](https://www.ernw.de/download/om/blackhat/us-19-Matula-Block-APICs-Adventures-In-Wonderland-Exploits.zip)
### Behind the Scenes: The Industry of Social Media Manipulation Driven by Malware
This talk is the 'grand finale' of a four-year long investigation that started with analyzing an IoT botnet, and led to discovering the structured industry that exists behind social media manipulation (SMM). SMM is the deliberate act of paying for popularity with followers or activity on social media.Adopting a bottom-up approach, the thorough methodology undertook to study the botnet will be presented: from building honeypots, infecting them with malware and conducting a man-in-the-middle-attack on the honeypots' traffic to access the decrypted HTTPS content between the C&Cs and social networks. Then, the various investigative paths taken to analyze this large data set, leading to the discovery of many industry actors involved in the supply chain of social media manipulation, will be presented. These investigative paths include traffic analysis, various OSINT approaches to reveal and understand actors, reverse-engineering the software that automates the use and creation of fake accounts, forum investigations, and qualitative profiling. All actors involved in the industry will be mapped, from malware authors, to reseller panels, and customers of fake popularity. The potential profitability of the industry will then be discussed, as well as the revenue division in the supply chain, demonstrating that the ones making the highest revenue per fake follower sold are not the malware authors, but rather those at the end of the chain. Different approaches to disrupt social media manipulation will also be discussed, giving practical insights for cybersecurity professionals, law enforcement agencies, and policy makers willing to curb this illicit industry.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Paquet-Clouston-Behind-The-Scenes-The-Industry-Of-Social-Media-Manipulation-Driven-By-Malware-up.pdf)
### PicoDMA: DMA Attacks at Your Fingertips
Direct Memory Access (DMA) attacks are typically performed in real-time by an attacker that gains physical access to a high-speed expansion port on a target device, and can be used to recover full disk encryption keys and other sensitive data from memory, bypass authentication, or modify process memory to facilitate backdoor access. To conduct the attack, an attacker connects a hardware device to a victim's Thunderbolt or ExpressCard port and reads physical memory pages from the target. Recent research has demonstrated the practicality and scope of these attacks to a general audience. Notable work includes Ulf Frisk's PCILeech framework, Trammel Hudson's Apple EFI firmware research ('Thunderstrike' I/II), the SLOTSCREAMER hardware implant by Joe Fitz, and most recently the release of the 'ThunderClap' tool and related academic research.Continuing in this vein, this talk will present PicoDMA: a stamp sized DMA attack platform that leverages the tiny (22 x 30 x 3.8mm), affordable (~$220 USD) PicoEVB FPGA board from RHS Research, LLC. The PicoEVB is no larger than a laptop's network card but well provisioned: this M.2 2230 form-factor board includes a Xilinx Artix-7 FPGA, and supports expansion via digital and analog I/O connectors. On its own, the PicoEVB, combined with our software, facilitates DMA security research at a more affordable price point. For real-world DMA attacks, the small size makes the PicoEVB easily embeddable in space-constrained platforms like laptops and routers. We support out-of-band management and payload delivery using radio modules including 802.11, cellular, and LoRA. Adding wireless capabilities to our platform allows interesting variations of a number of existing attacks that will be discussed.Our talk will include live demos and a public software release. Attendees will gain an enriched perspective on the risks posed by hardware implants and DMA attacks.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Sandin-PicoDMA-DMA-Attacks-At-Your-Fingertips.pdf)
### Attacking Electric Motors for Fun and Profit
Electric motors (EMs) account for more than 40 percent of annual global electricity consumption and an estimated market size of $214 Billion by 2025. They drive autonomous vehicles and transportation systems, precisely control robotic movements in industrial systems, and even vibrate your phone. They are ubiquitous and they are controlled by hardware and software. Attacks targeting EMs bridge the gap between cyber space and the physical world, resulting in real-world damage. To manage safety and security risks in cyber-physical systems with EM actuators, it is necessary to identify what attack objectives may exist against these components and determine what controls are required to mitigate these risks. Thus, our research aims to provide a comprehensive evaluation of cyber-attack objectives against EMs, which we don't believe has been done before in research, to provide risk assessors with new ideas to find vulnerabilities. We conducted a wide-scale analysis of EMs, researching different EMs and case studies of their application in real-world SCADA and transportation systems. We analyze different attack objectives against EMs based on system type and provide examples of attack techniques that can achieve the objective. Types of failures include loss of control, wearing down components, limiting torque, over-rotating servo motors, fire, and some really unintentional impacts of messing with Pulse Width Modulation (PWM). Attack techniques to achieve these outcomes are both based on previous research and have not been presented before. They include pin-control attacks disrupting PWM, DOS or injection network attacks, sensor attacks, and exploiting the lack of security controls of software libraries on the controller.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Jablonski-Attacking-Electric-Motors-For-Fun-And-Profit.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Jablonski-Attacking-Electric-Motors-For-Fun-And-Profit-wp.pdf)
### The Most Secure Browser? Pwning Chrome from 2016 to 2019
Browser security is always a prevalent topic in security research. Due to the great design and long-term effort, browsers have been more and more secure. The last time Chrome was pwned in Pwn2Own dates back to Mobile Pwn2Own 2016. In that contest, we, Keen Security Lab of Tencent, pwned Nexus 6P via Chrome browser. This year, we are willing to share our full, in-depth details on the research of Chrome security.JavaScript engines are an attractive target for browser attackers. Security researchers published their amazing methods, such as CodeAlchemist and Fuzzili. We developed a methodology Semantic Equivalent Transform (SET), and it is distinct becauseSimple. SET is inherently immune to grammar and semantic errors, so we don't need to write a lot of analysis code.Effective. We've found 8 pwn2own-available v8 bugs using it in the past three years.Versatile. There are many scenarios where SET can play a role.We will then share novel exploitation techniques we used in Pwn2Own. For instance, although most researchers have realized JIT is a good target for bug hunting, few people notice JIT could also be used to do exploitation. We will show how we used some general JIT fragments to exploit low-quality bugs. After that, we will share other interesting cases and our latest bug. Finally, we'll share our recent research on sandbox bypass. We have pwned Chrome three times since 2016. We will share the details of our IPC bugs and bring a demo when we pwned Chrome in March 2019.To the best of our knowledge, this presentation will be the first to talk about complete methodology to pwn Chrome (find and exploit bugs in both v8 and sandbox) in public.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Feng-The-Most-Secure-Browser-Pwning-Chrome-From-2016-To-2019.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Feng-The-Most-Secure-Browser-Pwning-Chrome-From-2016-To-2019-wp.pdf)
### Exploiting the Hyper-V IDE Emulator to Escape the Virtual Machine
Cloud proliferation continues to increase the worlds dependency on the security of virtualization stacks. But like all software stacks, virtualization stacks have vulnerabilities.In this talk, I'll examine a powerful vulnerability in Hyper-V's emulated storage component that was reported through the Hyper-V bug bounty. Then, I'll demonstrate how I exploited this vulnerability on Windows Server 2012R2. Next, I'll discuss how Windows has evolved between Windows 2012R2 and Redstone 3. I'll show you how I tried, failed, and then ultimately succeeded in exploiting the same vulnerability on Windows Redstone 3 with numerous hardening measures in place. This will provide empirical evidence for the impact that several years of platform hardening can have on exploitation.I'll wrap up the talk by discussing the takeaways Microsoft had from this exercise and how we're approaching hardening the Hyper-V stack (and other critical code) as a result.
### Hacking for the Greater Good: Empowering Technologists to Strengthen Digital Society
We’re at a critical juncture right now where the benefits from technological advances are increasingly counterbalanced by harmful applications and perilous consequences. Cyberattacks are crippling hospitals and threatening public health, governments are using malware and online propaganda to undermine elections and democracies and widespread surveillance to violate human rights, while consumer privacy has become a casualty of unchecked corporate greed. To address these issues we need the critical thinking, creativity, and passion that ethical hackers and technologists use to strengthen cybersecurity applied to social causes and protecting the public interest.In this panel, security technologist Bruce Schneier, Mozilla Fellow and Graphika Chief Innovation Officer Camille Francois and EFF Director of Cybersecurity Eva Galperin will discuss specific examples where public interest technologists are most needed to ensure an open, positive and safe digital society and provide suggestions for what hackers and security-forward companies can do to solve some of the biggest social problems we have and make a difference.
### Dragonblood: Attacking the Dragonfly Handshake of WPA3
One of its main advantages of WPA3 is that it provides forward secrecy and prevents offline dictionary attacks. However, the WPA3 certification program was created behind closed doors, meaning researchers could not critique it. This is problematic because, even though WPA3 relies on the existing Dragonfly handshake, this handshake received significant criticism during its standardization. This raises the question of how secure WPA3 is.In this talk, we will show that WPA3 is affected by several design and implementations flaws. Most prominently, we show that WPA3's Dragonfly handshake, in Wi-Fi also known as SAE, is vulnerable to side-channel attacks. We demonstrate that the leaked information can be abused to carry out password partitioning attacks. These attacks resemble a dictionary attack, and allow an adversary to recover the password by abusing timing or cache-based side-channel leaks. Our side-channel attacks target the protocol's password encoding method, for example, our cache-based attack exploits Dragonfly's so-called hash-to-curve algorithm. Additionally, we present invalid curve attacks against EAP-pwd, which internally uses a close variant of the Dragonfly handshake. This enables an adversary to bypass authentication. We will also discuss downgrade attacks to WPA2, which in turn enable dictionary attacks, and discuss denial-of-service attacks. Finally, we explain how we confirmed all vulnerabilities in practice, and discuss to which extend attacks can be mitigated in a backwards-compatible manner.Our conclusion is that WPA3 does not meet the standards of a modern security protocol. Either all countermeasures are implemented, in which case it might be affected by DoS attacks, or it does not implement the defenses, in which case it is vulnerable to our attacks. Nevertheless, WPA3 does remain an improvement over WPA2.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Vanhoef-Dragonblood-Attacking-The-Dragonfly-Handshake-Of-WPA3.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Vanhoef-Dragonblood-Attacking-The-Dragonfly-Handshake-Of-WPA3-wp.pdf)
### Attacking and Defending the Microsoft Cloud (Office 365 & Azure AD) 
The allure of the "Cloud" is indisputable. Organizations are moving into the cloud at a rapid pace. Even companies that have said no to the Cloud in the past have started migrating services and resources. The Cloud is a new paradigm and the rapid update pace makes it difficult to keep up, especially when it comes to security.  This presentation focuses on the Microsoft Cloud (Office 365 & Azure AD) and explores the most common attacks against the Cloud and describes effective defenses and mitigation. While the content is focused on the Microsoft Cloud, some of the attack and defense topics are applicable to other cloud providers and are noted where applicable.  Key items covered: Attacks against the Cloud Account compromise and token theft Methods to detect attack activity Cloud identity firewall Securing cloud infrastructure against attacks Secure cloud administration
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Metcalf-Attacking-And-Defending-The-Microsoft-Cloud.pdf)
### I&#39;m Unique, Just Like You: Human Side-Channels and Their Implications for Security and Privacy
Almost everything about us – our handwriting, DNA, faces, voices, fingerprints, even our eyes – can be used to distinguish us from the seven billion other people on the planet. These physical identifiers can allow law enforcement to trace back real-world crimes to offenders, and enable biometric authentication mechanisms. However, such identifiers are often irrelevant when it comes to attempting to track or disrupt threat actors. In this talk, I will discuss, explore, and explain identifiers which are unintentional, non-physical, and generated as a result of human behaviours and activities, but which can still be used to uniquely identify and/or track individual users in the digital realm. I call these identifiers "human side-channels", and will explore how they work; how they can be used for both attack and defense; and how they can be countered. I'll examine three human side-channels in particular: forensic linguistics; behavioural signatures; and cultural references. I will start by exploring the theories underpinning these side-channels, which are rooted in personality psychology and the concepts of consistency and distinctiveness as a result of our unique experiences, training, and feedback. I'll then explore how they work; walk through case studies and examples/demos of using them practically in security contexts; and discuss how they could be practically applied to investigate and track threat actors, in situations ranging from hostile social media profiles to post-compromise exfiltration and privilege escalation.I'll also examine the privacy implications of each technique, and how such characteristics – which are much harder to recognise, obfuscate, or spoof – could be used to erode privacy. I'll go into detail regarding possible countermeasures to disguise your own human side-channels, and I'll wrap up by outlining some ideas for future research in these areas.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Wixey-Im-Unique-Just-Like-You-Human-Side-Channels-And-Their-Implications-For-Security-And-Privacy.pdf)
### It&#39;s Not What You Know, It&#39;s What You Do: How Data Can Shape Security Engagement
When it comes to security training, one size does not fit all. Company-wide and even role-based security trainings do not acknowledge the strengths and weaknesses in an individual's security performance. It is redundant on topics where users are proficient and often appeals to the bottom denominator of understanding. This approach does not respect an employee's intelligence or recognize the successes and strengths in fulfilling security tasks. The end result is mediocre and unmotivating training that fails to empower users with the motivation and skills to defend against current threats.In early 2019, Autodesk, in partnership with Elevate security, rolled-out an innovative new approach to security learning. By leveraging the security behavioral traits of each employee, they created ongoing security snapshots with recommended security trainings and action items for each person.This behavioral data was used to highlight when employees were excelling at security tasks and where they needed most improvement. This gave each individual a quarterly security finish line, the opportunity to acknowledge when employees were meeting or exceeding a security task and provided customized follow-up when an employee had room for improvement. Further, data analytics were used to drive "social acceptance" of key security behaviors by demonstrating a comparison of performance between groups.This talk will walk through the Autodesk case study of how to create and deliver data-driven security snapshots. It will also go through an exploration of what data was chosen, how to effectively showcase this data for maximum impact in behavior change and share the successful measured outcomes on security behavior change from this initiative.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Sedova-Know-How-Data-Can-Shape-Security-Engagement.pdf)
### Cyber Insurance 101 for CISO’s
This session provides a basic understanding of a cyber policy including market dynamics, coverage terms and conditions, and services included with the product.  We also discuss the value a CISO can bring to the cyber insurance procurement process.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Smith-Cyber-Insurance-101-For-CISOs.pdf)
### All the 4G Modules Could be Hacked
Nowadays more and more 4G modules are built into IoT devices around the world, such as vending machines, car entertainment systems, laptops, advertising screens, urban cameras etc. But no one has conducted comprehensive security research on the 4G modules. We carried out this initiative and tested all the major brand 4G modules in the market (more than 15 different types). The results show all of them have similar vulnerabilities, including remote access with weak passwords, command injection of AT Command/listening services, OTA upgrade spoofing, command injection by SMS, and web vulnerability. Through these vulnerabilities we were able to get to the shell of these devices. In addition to using wifi to exploit these vulnerabilities, we created a new way to attack through fake base station system, triggered by accessing the intranet of cellular network, and successfully run remote command execution without any requisites. In this talk, we will first give an overview on the hardware structure of these modules. Then we will present the specific methods we use in vulnerability probe. In the final section we will demonstrate how to use these vulnerabilities to attack car entertainment systems of various brands and get remote control of cars.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Shupeng-All-The-4G-Modules-Could-Be-Hacked.pdf)
### The Path Less Traveled: Abusing Kubernetes Defaults
Kubernetes is a container orchestration framework that is increasingly widely used in enterprise and elsewhere. While the industry is starting to pay some attention to Kubernetes security, there are many attack paths that aren’t well-documented, and are rarely discussed. This lack of information can make your clusters vulnerable.In this live demonstration-filled talk, we are going to walk through the Kubernetes control plane before using sigs.k8s.io/kind to show some of the attack surface exposed by a default configuration of Kubernetes. There will be multiple exploits involving various moving parts, including cluster takeovers and host escapes. We’ll show you mitigations, and then show you how to get around those.Everything in this talk exploits features, not bugs! Kubernetes is powerful, and it’s insecure by design. Let’s see what it can do, and then let us show you how to better secure it.The audience will walk away from this talk with a better understanding of Kubernetes’ default attack surface, how it can be exploited, and how to keep their clusters safer.
### Selling 0-Days to Governments and Offensive Security Companies
Selling 0-days is a fascinating process that not a lot of people are familiar with. This talk will discuss a vulnerability brokerage company called Q-recon and provide a glimpse of how this market works. In the presentation the following questions will be answered from three different angles (researcher/broker/client):Who (researcher profile) is selling 0-days to governments / offensive security companies?What is the process of selling 0-days?How to sell 0-days?At the end of the presentation, I will give a few tips for researchers that want to sell 0-days to offensive security companies/governments.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Shwartz-Selling-0-Days-To-Governments-And-Offensive-Security-Companies.pdf)
### Selling 0-Days to Governments and Offensive Security Companies
Selling 0-days is a fascinating process that not a lot of people are familiar with. This talk will discuss a vulnerability brokerage company called Q-recon and provide a glimpse of how this market works. In the presentation the following questions will be answered from three different angles (researcher/broker/client):Who (researcher profile) is selling 0-days to governments / offensive security companies?What is the process of selling 0-days?How to sell 0-days?At the end of the presentation, I will give a few tips for researchers that want to sell 0-days to offensive security companies/governments.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Shwartz-Selling-0-Days-To-Governments-And-Offensive-Security-Companies.pdf)
### Sensor and Process Fingerprinting in Industrial Control Systems
Critical infrastructure, such as electricity and water distribution, is heavily dependent on automated control. The security of these cyber-physical systems is vital for the normal functioning of modern societies; attacks to those infrastructures can result in damage to the physical world and potentially harm human lives. In this talk we revisit some common cyber and cyber-physical attack vectors to critical infrastructure and defense strategies. We demonstrate how noise in industrial sensors and their inherent processes can be used to detect both cyber and physical attacks. We will show videos of attacks and defenses taken in a realistic and state-of-the-art water treatment testbed (SWaT) hosted by the Singapore University of Technology and Design. In particular, we will show how man-in-the-middle attacks can tamper with critical sensor data and cause unwanted behavior in the plant, as well as how physically tampering with sensors results in attacks. We will briefly review defense strategies against such attacks, including the use of physical invariants and process models. Next, we will illustrate how building a model based on the noise profile of both sensors and process can effectively detect the attacks illustrated. Sensors (such as ultrasonic distance sensors) have microscopic differences that make them produce slightly different noise patterns. Using noise for identification has been explored in other fields (predominantly in mobile phones) but has yet to be investigated in the context of CPS. We show that sensor noise can be a powerful sensor data authentication tool, especially in combination with model-based defenses.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Ochoa-Sensor-And-Process-Fingerprinting-In-ICS.pdf)
### HTTP Desync Attacks: Smashing into the Cell Next Door
HTTP requests are traditionally viewed as isolated, standalone entities. In this session, I'll introduce techniques for remote, unauthenticated attackers to smash through this isolation and splice their requests into others, through which I was able to play puppeteer with the web infrastructure of numerous commercial and military systems, rain exploits on their visitors, and harvest over $50k in bug bounties.Using these targets as case studies, I'll show you how to delicately amend victim's requests to route them into malicious territory, invoke harmful responses, and lure credentials into your open arms. I'll also demonstrate using backend reassembly on your own requests to exploit every modicum of trust placed on the frontend, gain maximum privilege access to internal APIs, poison web caches, and compromise what's possibly your most trusted login page. This is an attack the web is thoroughly unprepared for. Although documented over a decade ago, a fearsome reputation for difficulty and collateral damage has left it optimistically ignored for years while the web's susceptibility grew. By applying fresh ideas and new techniques, I'll unveil a vast expanse of vulnerable systems ranging from huge content delivery networks to bespoke backends. I'll help you tackle this legacy by sharing a refined methodology and open source tooling for black-box detection, assessment and exploitation with minimal risk of collateral damage. These will be developed from core concepts, ensuring you leave equipped to devise your own desync techniques and tailor (or thwart) attacks against your target of choice.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Kettle-HTTP-Desync-Attacks-Smashing-Into-The-Cell-Next-Door.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Kettle-HTTP-Desync-Attacks-Smashing-Into-The-Cell-Next-Door-wp.pdf)
- [source_code](https://github.com/portswigger/desynchronize)
### Behind the Scenes of Intel Security and Manageability Engine
Today low-level firmware vulnerabilities are becoming more a focus than in the past, mainly due to the nature of having highest privilege on the system and due to the advanced security protection and mitigation that exist in the host Operating System (OS).Intel has developed a security engine named CSME (Converged Security and Manageability Engine) that provides a key security value to the platform from start to enablement of the “Root of Trust” concept.Continuous improvements have been made to the CSME firmware during the past few years that aim to make it more difficult to exploit common memory corruption issues and reduce complexity/privileges of some of the CSME firmware (FW) modules due to security issues published in previous years. We will describe how Intel CSME FW is mitigating these type of security challenges by applying industry standards mitigation tailored to the FW environment.We will share deep technical detail on how other firmware environments can achieve the same results by applying the same technology and we will share the why of how we apply a feedback fuzzing and queue-management in a generic form, so it could be applied on any given existing fuzzer.Overall, in this presentation we will introduce the following:CSME Hardware, its limitation and security challenges it poses.CSME µKernel OS internals, boot flow, Debugging capabilities.Processes & Key features.CSME customizations support & OEM role in manufacturing.Recovery and update mechanisms.Exploitation mitigations against memory corruptions & defense in depthFuzzers & monitoring technologies.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Hasarfaty-Behind-The-Scenes-Of-Intel-Security-And-Manageability-Engine.pdf)
### New Vulnerabilities in 5G Networks
The security in the 5G network has evolved and is more efficient than the previous generations. In this talk, we visit security features of 5G radio networks and reveal new vulnerabilities affecting both the operator infrastructure and end-devices (including mobiles, NB-IoT, laptop etc). We demonstrate how these new vulnerabilities in the 5G/4G security standards can be exploited using low-cost hardware and software platforms. In particular, we introduce a new automated tool to carry out practical evaluation and share data-sets with the research community. In addition, we reveal implementation issues in hundreds of 4G base stations around the world and in commercially available NB-IoT protocols that can be used to mount battery draining, hijacking and bidding down attacks. Our attacks affect to the range from gigabit high speed LTE devices to NB-IoT devices.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Shaik-New-Vulnerabilities-In-5G-Networks.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Shaik-New-Vulnerabilities-In-5G-Networks-wp.pdf)
### Lessons From Two Years of Crypto Audits
Over the last two years, we've completed many successful crypto audits. These audits consisted of mostly paid engagements but also unsolicited ones, as well with a mixture of blockchain projects as well as good old cryptography. We've worked for major blockchain organizations and have seen the most complex crypto protocols ever deployed at scale, which is really exciting but at the same time terrifying—what if there's a critical bug that could compromise the entire network? What if we as security auditors miss something? Questions like these loom over anyone performing an audit. There is no shortage of places things can go wrong, bugs in source code, protocol defects, incorrect implementations, and the list goes on.In this talk we'll first describe some of the most interesting security issues we've found (at least the ones we're authorized to talk about), then we'll focus on the risks associated with one of the most popular memory-safe languages, namely Rust. We'll describe a list of sanity checks and security best practices that we use internally when auditing Rust code, along with examples from real Rust audits. Finally, we'll draw some lessons from our experience, providing advice to fellow security auditors and developers, to get the most out of a security audit.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Aumasson-Lessons-From-Two-Years-Of-Crypto-Audits.pdf)
### Responding to a Cyber Attack with Missiles
The lines between real and virtual worlds are blurring fast. Several governments have publicly stated that they reserve the right to respond to cyber attacks with kinetic force. Now we are seeing that happening for real. What are the rules of engagement in these new conflicts? And where is the cyber arms race taking us next?
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Hypponen-Responding-To-A-Cyber-Attack-With-Missiles.pdf)
### Finding a Needle in an Encrypted Haystack: Leveraging Cryptographic Abilities to Detect the Most Prevalent Attacks on Active Directory
Active Directory has always been a popular target for attackers, with a constant rise in attack tools attempting to compromise and abuse the main secret storage of the organization. Although defensive security products were able to mitigate some of the attack techniques by methods such as log collection or raw traffic inspection, some of the most common offensive techniques are left with no efficient countermeasures. One of the latter is the good old NTLM Relay, which is especially favored by attackers. Recently it has been exploited yet again in the PrivExchange vulnerability discovered earlier this year.We will present several new ways to abuse this infamous authentication protocol, including a new critical zero-day vulnerability we have discovered which enables attackers to abuse NTLM Relay and take over any machine in the domain, even with the strictest security configuration (including server signing). In addition, we will show another vulnerability we have discovered in the way NTLM implements channel binding, which might put your cloud resources at risk as well. We will then demonstrate a new defensive approach that leverages cryptographic operations to gain improved defensive capabilities against some of the most prevalent attacks today. Among others, we will explain how this method led us to devise the first known deterministic algorithm to detect NTLM Relay attacks.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Simakov-Finding-A-Needle-In-An-Encrypted-Haystack-Leveraging-Cryptographic-Abilities-To-Detect-The-Most-Prevalent-Attacks-On-Active-Directory.pdf)
### Look, No Hands! -- The Remote, Interaction-less Attack Surface of the iPhone
There have been rumors of remote vulnerabilities requiring no user interaction being used to attack the iPhone, but limited information is available about the technical aspects of these attacks on modern devices. This presentation explores the remote, interaction-less attack surface of iOS. It discusses the potential for vulnerabilities in SMS, MMS, Visual Voicemail, iMessage and Mail, and explains how to set up tooling to test these components. It also includes two examples of vulnerabilities discovered using these methods.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Silvanovich-Look-No-Hands-The-Remote-Interactionless-Attack-Surface-Of-The-iPhone.pdf)
### Infiltrating Corporate Intranet Like NSA - Pre-auth RCE on Leading SSL VPNs
SSL VPNs protect corporate assets from Internet exposure, but what if SSL VPNs themselves are vulnerable? They're exposed to the Internet, trusted to reliably guard the only way to intranet. However, we found pre-auth RCEs on multiple leading SSL VPNs, used by nearly half of the Fortune 500 companies and many government organizations. To make things worse, a "magic" backdoor was found to allow changing any user's password with no credentials required! To show how bad things can go, we will demonstrate gaining root shell from the only exposed HTTPS port, covertly weaponizing the server against their owner, and abusing a hidden feature to take over all VPN clients!In such complicated closed-source systems, gaining root shell from outside the box certainly ain't easy. It takes advanced web and binary exploitation techniques to struggle for a way to root shell, which involves abusing defects in web architectures, hard-core Apache jemalloc exploitation and more. We will cover every detail of all the dirty tricks, crazy bug chains, and the built-in backdoor. After gaining root shell into the box, we then elaborate on post exploitation and how we hack back the clients. In addition, we will share the attack vectors against SSL VPNs to kick start researches on similar targets. On the other hand, from our previous experience, we derive general hardening actions that mitigate not only all the above attacks, but any other potential 0days.In summary, we disclose practical attacks capable of compromising millions of targets, including tech giants and many industry leaders. These techniques and methodologies are published in the hope that it can inspire more security researchers to think out-of-the-box; enterprises can apply immediate mitigation, and realize that SSL VPN is not merely Virtual Private Network, but also a "Vulnerable Point of your Network".
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf)
### Integration of Cyber Insurance Into A Risk Management Program
This session will provide information on the current data breach landscape and then discuss how Cyber Insurance is being integrated into a risk management plan. Information Security professionals and incident responders are in many cases unaware of how the cyber insurance process works when there is a data breach and do not understand the requirements that can affect the incident response process.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Kouns-Integration-Of-Cyber-Insurance-Into-A-Risk-Management-Program.pdf)
### Worm Charming: Harvesting Malware Lures for Fun and Profit
It's no secret that client-side attacks are a common source of compromise for many organizations. Web browser and e-mail borne malware campaigns target users by way of phishing, social engineering, and exploitation. Office suites from vendors such as Adobe and Microsoft are ubiquitous and provide a rich and ever-changing attack surface. Poor user awareness and clever social engineering tactics frequently result in users consenting to the execution of malicious embedded logic such as macros, JavaScript, ActionScript, and Java applets. In this talk, we'll explore a mechanism for harvesting a variety of these malware lures for the purposes of dissection and detection.Worm charming (grunting or fiddling) is an increasingly rare real-world skill for attracting earthworms from the ground. A competitive sport in East Texas, most worm charming methods involve some vibration of the soil, which encourages the worms to surface. In our context, we'll apply a series of YARA rules to charm interesting samples to the surface from the ~1M files uploaded to Virus Total daily. Once aggregated, we'll explore mechanisms for clustering and identifying "interesting" samples. Specifically, we're on the hunt for malware lures that can provide a heads up to defenders on upcoming campaigns as adversaries frequently test their lures against AV consensus. Multiple real-world examples are provided, proving that an astute researcher, can harvest zero-day exploits from the public domain.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Amini-Worm-Charming-Harvesting-Malware-Lures-For-Fun-And-Profit.pdf)
### Come Join the CAFSA - Continuous Automated Firmware Security Analysis
Modern devices are complex and their firmware often consists of multiple parts that together make up the software stack of a product. Securing firmware is hard work since firmware changes over time and engineering focus shifts to different aspects like prototyping, development, testing, and finally production. Shipping 'bad' firmware can have a ripple effect on your entire product and infrastructure, possibly preventing security controls from being properly implemented to costing millions due to recall. Preventing this ripple effect to occur will ultimately save you money and keep your product reputation.This talk is about processes and tools that we designed, built, and deployed in the last couple of years while working on securing devices at multiple companies, most notably in my current role at Cruise Automation. We determined that well engineered simple yet powerful processes integrated into the development and release flow can achieve great victories.Our approach is centered around a tool for analyzing firmware images, specifically filesystem images. The tool provides an automated way to model and check the security properties of files and file content. Checks can be as simple as flagging suid executables or world writable files and as complex as ensuring that a release build contains production CAs signed with production keys. Our approach is vastly different and more impactful compared with traditional tools such as vulnerability scanners that try to identify buggy and insecure code or tools, CVEs within in your software stack.One core component of the process deals with reporting and further processing of information extracted and gathered during the analysis and checking phase. All steps generate machine readable reports that allow integration in continuous development environments as well as extending the process and tools to new targets. We plan to opensource the tool kit together with a library of checks for various targets.The talk is based on the experience of securing Linux-based devices including highly customized Android devices built in-house and by 3rd parties.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Mulliner-Come-Join-The-CAFSA-Continuous-Automated-Firmware-Security-Analysis.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Mulliner-Come-Join-The-CAFSA-Continuous-Automated-Firmware-Security-Analysis-wp.pdf)
### MITRE ATT&CK: The Play at Home Edition
You've seen the tactics and techniques. You've read the descriptions. However, something is missing…how do you take the theory of MITRE ATT&CK™ and actually DO something with it? At first glance, it is easy to be overwhelmed by the ATT&CK framework. Where do you start? Who should use it? What can you really do with a framework like ATT&CK? Combining the knowledge of an ATT&CK team member with the experience of a security practitioner who has helped implement it, Katie and Ryan will teach you how to take ATT&CK from a cool-sounding idea to a powerful force for creating a threat-informed defense in your company. They will walk the audience through the story of how ATT&CK helped a fictional organization solve real-world-inspired problems that defenders struggle with every day. The presentation will discuss how different teams like threat intelligence analysts, threat hunters, SOC analysts, red teamers, and even executives can use ATT&CK to improve how they track threats and protect against them. Regardless of their role, attendees will learn how they can hit the ground running with ATT&CK on the first day they return home.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Nickels-MITRE-ATTACK-The-Play-At-Home-Edition.pdf)
### Chip.Fail - Glitching the Silicon of the Connected World
All smart devices, from cars to IoT, are based around processors. Often these processors are not considered as part of the threat model when designing a product; instead, there is an implicit trust that they just work and that the security features in the data-sheet do what they say. This is especially problematic when the processors are used for security products, such as bitcoin wallets, cars, or authentication tokens.In this presentation we will take a look at using fault injection attacks to break some of the most popular IoT processors - using less than $100 USD of equipment.We will also release software & hardware tools to do so.
### Internet-Scale Analysis of AWS Cognito Security
This talk will show the results of an internet-scale analysis of the security of AWS Cognito configurations. During this research, it was possible to identify 2500 identity pools, which were used to gain access to more than 13000 S3 buckets (which are not publicly exposed), 1200 DynamoDB tables and 1500 Lambda functions.The talk starts with an introduction to the AWS Cognito service and how it can be configured by the developers to give end-users direct access to AWS resources such as S3 and DynamoDB. Access is restricted by IAM policies which are under the developer's control and, in many cases, do not follow the least privilege principle.The configuration weakness is first explained step-by-step for a specific AWS account and Cognito identity pool using a series of demos, the same concepts are then automated to perform an internet-scale analysis of AWS Cognito configurations.Because Cognito identity pool IDs are UUID4 it was necessary to download thousands of APKs from the Google Play store, decompile them, and extract the identifiers. Other sources such as Common Crawl were also used to identify valid identifiers. The tools used to perform these tasks will be made public.Each Cognito identity pool that was configured with an unauthenticated role was analyzed using an in-depth permission brute-force tool that identifies potential breaches to least privilege principle.The talk ends with recommendations for developers that want to configure the service in a secure manner, and an analysis of potential reasons for this widespread issue such as poor documentation and examples on AWS site.
### How Do Cyber Insurers View The World?
With the rise of data breaches there have been many discussions, presentations and articles written about cyber insurance, with many of them not being so flattered. Unfortunately there is a lot of misinformation and questions still remain.  This session provides and insider view on multiple topics including:• How Insurance Companies See Companies• Actuarial, Pricing and Underwriting • Do they insurance carriers actually pay claims? • How is the insurance industry evolving?
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Prevost-How-Insurers-View-The-World.pdf)
### Messaging Layer Security: Towards a New Era of Secure Group Messaging
The world is moving towards end-to-end encryption (E2EE) for person-to-person messaging, as more services now wish to reduce the amount of sensitive data that they must store. However, the protocols used for encryption are still being developed and only a few of them, such as the Signal protocol, have seen serious security analysis. Signal is the first E2EE protocol to achieve global deployment, via WhatsApp's billion+ users, and achieves strong security guarantees, such as forward-secrecy and post-compromise-security (recovery from key-compromise).This talk will provide an introduction to message encryption protocols and describe the current ecosystem, including why it's still not a solved problem in the corporate setting. While personal messaging systems have been adopting Signal, corporate messaging has not massively moved in that direction due to significant technical challenges such as scalability.To support groups, WhatsApp uses a protocol called Sender-Keys. However, this protocol does not provide post-compromise-security, meaning that in a simple deployment an employee losing a device or leaving the company might retain the ability to read messages. To prevent this, all employees' cryptographic keys must be rotated whenever a device is removed; this is just about feasible for small groups but is entirely impractical for whole-company groups.To remedy these issues, the IETF is building the "Messaging Layer Security'' (MLS) group messaging protocol. MLS goals significantly differ from pairwise protocols: it aims to cover multiple industry use-cases including federation and web-browser support, to have sub-linear complexities allowing practical groups up to 50000 clients, and to provide formal security guarantees.What kinds of security, privacy and implementation bugs have been exploited by adversaries in the past? What guarantees can MLS provide in the context of powerful attackers and how does it differ from current solutions? What is the cutting edge research used? These are the questions that we will try to answer throughout the presentation.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Robert-Messaging-Layer-Security-Towards-A-New-Era-Of-Secure-Group-Messaging.pdf)
### Arm IDA and Cross Check: Reversing the Boeing 787&#39;s Core Network
In 2008 the FAA issued several Special Conditions for The Boeing 787 Dreamliner. There were serious safety and security concerns about the brand-new network design Boeing had implemented, which provided the Dreamliner with some "e-enabled" capabilities never seen before. This scenario raised some alarms in certain security circles that eventually faded out.10 years later, this talk will provide the first public analysis of the Boeing 787's Core Network, revealing previously unknown vulnerabilities that would allow an attacker to compromise the security of the original design. The talk will also elaborate on the additional implications of these security flaws.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Santamarta-Arm-IDA-And-Cross-Check-Reversing-The-787-Core-Network.pdf)
### Hacking Your Non-Compete
Nearly everyone in the cybersecurity community found themselves contemplating leaving an employer, been offered an opportunity to really stretch their wings as part of a start-up or just become fed-up with their current work environment. While many of us are masters of technology few of us have a good understanding of what comes next when planning to leave one company and move to the next. Does your employment agreement allow you to take the next job or jump on that great opportunity? Are you going to be able to go to a company that your employer sees as a competitor or live that startup dream?We'll present real cases involving competing with a former employer, soliciting work from a current client at your new company and how to protect intellectual property you bring to a new employer. You'll hear from a computer forensics investigator on where people typically go wrong when transitioning from one employer to the next and from a technology and intellectual property attorney on the real legal outcomes of those cases.Commonly misunderstood concepts like "work for hire" and "right to work" will be explained. We'll talk attendees through the working details of non-compete agreements, operating agreements between tech company founders and what to do when it all goes wrong. Finally, we'll discuss what you should do after having left a previous employer and you receive an angry letter saying that you've violate multiple agreements and are about to be sued down to your socks. You'll leave the session better understanding of the details of your non-compete or employment agreement and what is enforceable versus hot air.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Stone-Hacking-Your-Non-Compete.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Stone-Hacking-Your-Non-Compete-wp.pdf)
### Hunting for Bugs, Catching Dragons
While browser and plugin exploits are frequent, it's less common to see exploits affecting targets without scripting capabilities. Are these worth attacking? How do we proceed? How do we identify valid entry points and bugs? This talk will cover some research done at Microsoft on Outlook and Exchange and discuss the results. Scary dragons will be spotted in this tour, hopefully you'll catch some too.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Joly-Hunting-For-Bugs-Catching-Dragons.pdf)
### Flying a False Flag: Advanced C2, Trust Conflicts, and Domain Takeover
Command and Control (C2) is at the center of successful malware development. Given the importance of reliable C2 for stable malware, it is also a core focus for many defensive teams. What happens though, when malware authors take advantage of shiny new cloud services, high level layer 7 abstractions, large-scale takeover primitives, and 3rd party trust? Do domains, IPs, or servers still matter?This talk will discuss the methodology, selection process, and challenges of modern C2. It will cover the details of recent HTTP/S advancements and tooling for new cloud service primitives such as SQS, AppSpot, S3, and CloudFront. We will demonstrate how trust can be abused for stealthy C2 techniques via internal mail servers, defensive platforms, and trusted domains. We will also cover the various options for domain takeover, and release tooling for exploiting domain takeover scenarios in Amazon Web Services (AWS), Azure, and Google Cloud Platform (GCP).What flags do you trust?
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Landers-Flying-A-False-Flag-Advanced-C2-Trust-Conflicts-And-Domain-Takeover.pdf)
### He Said, She Said – Poisoned RDP Offense and Defense
It's safe to assume that many people reading this text have heard of using the Remote Desktop Protocol (RDP) to connect to other machines. But has anyone ever considered that merely using RDP can compromise their own computer?

In this talk, we will not be covering a typical RDP vulnerability where a server is attacked - instead, we will show that just by connecting to a rogue machine, your own host can be reliably and silently compromised. Although there are numerous vulnerabilities in popular open source RDP clients, this talk heads straight for the crown jewel: the Microsoft Terminal Services Client, or MSTSC.EXE. Together, we will take a deep dive into the main synchronized resource between the client and the server: the clipboard. At the end of this journey, we will discover an inherent design problem with this resource synchronization, a design problem also inherited by Hyper-V.

For attackers, this design flaw enables new ways of escaping the sandbox. For defenders, there is a way to fight back. With the right optics, this technique can be detected using internal Windows telemetry.

In this collaborative talk, researchers from Check Point and Microsoft share the inside story of the attack from both the offensive and defensive perspectives.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Baril-He-Said-She-Said-Poisoned-RDP-Offense-And-Defense.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Baril-He-Said-She-Said-Poisoned-RDP-Offense-And-Defense-wp.pdf)
### Controlled Chaos: The Inevitable Marriage of DevOps &#38; Security
We've all heard "software is eating the world" – that most organizations are becoming software organizations in some form. In this new era, DevOps rises as the engine of the business, and organizations resisting its ascension empirically fall behind. Those in information security often view DevOps as demons by another name and assume that if they aren't a hyperscale tech organization, they can safely ignore these trends. 

In reality, information security has a choice: marry with their DevOps colleagues and embrace the philosophy of controlled chaos, or eventually be shoved aside, descending into impotence and irrelevancy. In this session, we'll explain the basics of DevOps and the concepts of resilience and chaos engineering. Using large-scale survey data, we'll illuminate which factors determine whether an organization is "elite" in this software-dominant world. We'll then uncover how DevOps' priorities and goals aren't so dissimilar from modern infosec's goals.

We'll delve into implications for security programs, particularly the shift from security for its own sake to security as an enabler of business objectives. Then, we'll expose why chaos and resilience engineering represents the future of security programs – and why it catalyzes the dawn of defensive innovation. We'll show how chaos and resilience fit with the C.I.A. triad and why the D.I.E. triad of distributed, immutable, and ephemeral might be the model of the future. Focusing on practical implementation, we'll examine metrics, GameDays, and existing resiliency tools that security teams can adopt and extend to meet their goals. 

Finally, we'll propose pragmatic approaches for security teams to make a marriage to DevOps last through a love of controlled chaos. We'll conclude by discussing partnership opportunities with DevOps to support the organization on its path to leetness – and to transform security from a frustrating cost center to a lean, mean, innovation machine.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Shortridge-Controlled-Chaos-The-Inevitable-Marriage-Of-DevOps-And-Security.pdf)
### The Cyber Shell Game – War, Information Warfare, and the Darkening Web
This year we celebrate a dubious anniversary – it’s been 20 years since the first major resolution on “information security” was submitted in the United Nations, and it was the first of many. But this is not the “information security” you are looking for. Instead of ISO2700x and protecting data, this version of information security is about content.  It’s not foremost concerned with a hyper-kinetic “cyber war” of burned-our critical infrastructure but is all about ““information warfare” and regime change. For many foreign governments see the current free Internet as the biggest threat to their own security and would like a very different Internet to emerge: top-down, intergovernmental, and framed around security.  And despite the best efforts, the US and her allies are not always able to resist the siren call of new legislation and moves towards an intergovernmental-dominated Internet system.  This clash of values is also a clash of visions, and strategic games – and increasingly the free Internet is a subject of a shell game, where sleights-of-hand and information warfare masquerade as cyber espionage attacks and preparation for all-out war.This talk will review the ideological differences of cyber-conflict, and how these have operationally been reflected in both major cyber campaigns and incidents as well as in international diplomacy and Internet governance. It traces the forces that threaten to shift the Internet fundamentally from its current utility as a enable of freedoms to one of security and control. And it asks how the Internet can be saved – from this outside threat, but also from itself.
### MINimum Failure - Stealing Bitcoins with Electromagnetic Fault Injection
How secure is a typical hardware bitcoin wallet? Surely such a device would not pin the security on the execution of a single instruction, that if mis-executed would immediately reveal the critical recovery seed, right? Right??This talk introduces an attack on the Trezor Bitcoin wallet that allows reading out of the recovery seed by performing electromagnetic fault injection (EMFI) through the enclosure of the device, without having to break or open the case. This means one can clone the device to steal bitcoins at a later date, without leaving any sign of tampering even should the physical seal be completely verifiable. And it comes down to a single comparison in the USB stack, which is replicated across many other devices (including most USB stacks on embedded systems).To assist with the attack, this talk also introduces the PhyWhisperer - an open-source tool for performing advanced triggering on USB packets. This tool is used as part of generating the required timing for fault injection. Dumping memory has never been so fun or profitable! On the plus side, countermeasures can be reasonably implemented in most systems (and have already been added to the Trezor), so rather than just presenting a depressing future, this talk also gives the motivation for implementing the countermeasures.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-OFlynn-MINimum-Failure-Stealing-Bitcoins-With-EMFI.pdf)
- [source_code](github.com/newaetech/phywhisperer-usb)
### Reverse Engineering WhatsApp Encryption for Chat Manipulation and More
As of early 2018, the Facebook-owned messaging application, WhatsApp, has over 1.5 billion users with over one billion groups and 65 billion messages sent every day. WhatsApp end-to-end encryption ensures only you and the person you're communicating with can read what's sent, and nobody in between, not even WhatsApp. However, we managed to reverse engineer WhatsApp web source code and successfully decrypted WhatsApp traffic. During the process we translated all WhatsApp web functions to python and created Burpsuit extension that you can use to investigate WhatsApp traffic and extend in order to find vulnerabilities.During the process we unveiled new vulnerabilities that could allow threat actors to intercept and manipulate messages sent in both private and group conversations, giving attackers immense power to create and spread misinformation from what appear to be trusted sources.Our team observed three possible methods of attack exploiting this vulnerability – all of which involve social engineering tactics to fool end-users. A threat actor can:Send a private message to another group participant that is disguised as a public message for all, so when the targeted individual responds, it's visible to everyone in the conversation.Use the 'quote' feature in a group conversation to change the identity of the sender, even if that person is not a member of the group.Alter the text of someone else's reply, essentially putting words in their mouth.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Zaikin-Reverse-Engineering-WhatsApp-Encryption-For-Chat-Manipulation-And-More.pdf)
### Detecting Malicious Files with YARA Rules as They Traverse the Network
YARA, the pattern matching swiss knife for malware researchers, has been extremely useful at detecting suspicious files on the endpoint. However, little or no information is publicly available on how to leverage this useful tool to scan for files as they are traversing the network. In this presentation, I will show how you can open source Zeek IDS (formerly bro) and how some custom developed scripts can be used to extract files from the network and identify attacks on an early stage before it causes more damage. Scanning for YARA files on the network has the benefit of increased performance, as compared to scanning several gigabytes or terabytes on the endpoint, as well as target specific mime types, used for malware delivery. Additionally, Zeek IDS can provide additional context whenever a YARA rule is triggered, that will provide defenders with more information to act more rapidly.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Bernal-Detecting-Malicious-Files-With-YARA-Rules-As-They-Traverse-The-Network.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Wednesday/us-19-Bernal-Detecting-Malicious-Files-With-YARA-Rules-As-They-Traverse-the-Network-wp.pdf)
### Defense Against Rapidly Morphing DDOS
In June 2018 ProtonMail suffered rapidly morphing sustained DDOS attacks that included Syn Floods, TCP handshake violations, TCP Zero Sequence, ACK floods, NTP non-standard port floods, reflection attacks on SSDP, NTP, Chargen, LDAP and Memcache protocols[1].We created an attack toolkit that mimics the ProtonMail attacks, and used it to study the efficacy of various defenses against an attack like ProtonMail suffered. We discovered that using standard techniques to fight off rapidly changing bursting attacks is near impossible for SOC operators, as speed of human action to understand the attack and apply well known mitigation is too slow. We found that a combination of an unsupervised Machine Learning algorithm to determine a baseline, perform anomaly detection and mitigation, and another Machine Learning algorithm to tune the performance of the first, yielded the most effective defense. With this scheme in place, the SOC operator did not have to react at machine speed but simply monitored the findings and the actions of the machine.References : https://protonmail.com/blog/a-brief-update-regarding-ongoing-ddos-incidents/
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Tyagi-Defense-Against-Rapidly-Morphing-DDOS.pdf)
### Going Beyond Coverage-Guided Fuzzing with Structured Fuzzing
Coverage-guided fuzzers like AFL and libFuzzer have led to a "fuzzing renaissance". This is because they made it possible for security researchers to write effective fuzzers for formats without knowing about the format's structure. However, structure-aware (aka structured) fuzzing is far from dead. In fact, the combination of structured and coverage-guided (aka coverage) fuzzing has quietly become the state of the art in automated vulnerability discovery.This talk will:Explain the problems in coverage fuzzing that structured fuzzing solves and how it solves them, including:How to ensure fuzzing reaches specific code to find vulnerabilities.How to ensure fuzzing does not fuzz specific code that makes fuzzing harder.How to fuzz code that doesn't accept an array of bytes.Highlight some of the places where structured coverage fuzzing has shined.Including Chrome's AppCache where it found a vulnerability used in a full-chain exploit and SQLite+Skia where it found bugs that other kinds of fuzzing did not.Present libprotobuf-mutator and custom mutators, two techniques for structured coverage fuzzing that are supported by libFuzzer. These can be used by anyone who can write a fuzzer.Share lessons on writing structured coverage fuzzers and how it can make fuzzing less of an art and more of a science.Show how structured coverage fuzzing can find more bugs than coverage fuzzing alone and how this technique is straightforward to use.The talk will ultimately benefit anyone who is interested in fuzzing. In particular, it will benefit security researchers trying to go beyond coverage fuzzing to find vulnerabilities in real code.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Metzman-Going-Beyond-Coverage-Guided-Fuzzing-With-Structured-Fuzzing.pdf)
### Transparency in the Software Supply Chain: Making SBOM a Reality
We can't buy a piece of candy without knowing its ingredients, or design and sell a piece of machinery without accounting for each nut and bolt. Yet, even as supply chain uncertainty has emerged as a top information security risk, there is limited visibility into the third party components on the software running on our networks, and little market incentive for software suppliers to actually track their third party dependencies. A "software bill of materials," or SBOM, can promote transparency of what code we're actually using across the entire software supply chain. Last summer, the US Department of Commerce launched a new "multistakeholder initiative" and convened experts to find consensus on the viability of this idea, and how we can make it a reality without government regulation. Participants from a range of sectors have spent the last year exploring this idea and its application in domains ranging from open source development to commercial DevOps to embedded medical devices. This briefing will announce the initial results of that open, international, stakeholder-driven process. Participants found a shared vision of what an SBOM looks like, including sketching out a minimum viable product and optional extensions for different use cases. They conducted research across a range of sectors to identify existing practices and how different parts of the supply chain could be improved with the availability of SBOM data. Stakeholders also identified two existing and interoperable data formats (SWID and SPDX) that can be used to convey the SBOM data. A set of stakeholders even launched and documented a proof-of-concept exercise. We have collectively started to identify tools and formal processes to enable automation. Moving forward, we will need even greater participation and community buy-in to promote awareness and adoption, as well as identifying further challenges that we can tackle together.
### Deconstructing the Phishing Campaigns that Target Gmail Users
With over 1.4 billion active users and million of companies entrusting it to handle their email, Gmail has a unique vantage point on how phishing groups operate. In this talk we look into Gmail telemetry to illuminate the differences between phishing groups in terms of tactics and targets. Then, leveraging insights from the cognitive and neuro-science fields on user's susceptibility and decision-making, we discuss why different types of users fall for phishing and how those insights can be used to improve phishing protections.
### Cybersecurity Risk Assessment for Safety-Critical Systems
When you consider critical infrastructure, we rarely consider the enabling technology and systems that realize such infrastructure; such as, agribusiness' reliance on weather and climate satellites, the U.S. military's reliance on intelligence satellites, and various transportation industries' reliance on global positioning system (GPS) satellites. Most of the world's critical infrastructure relies on space systems. Despite efforts to improve the cybersecurity of critical infrastructure, there has been little focus on cybersecurity for space systems. Challenges to secure space systems included technology development, ownership, and management perspective. This leads to the lack of guidance in the form of standards that govern space system security and, ultimately, policies that enforce these standards.This presentation first discusses the recent major cybersecurity threats to space systems, and the potential motivations for cybercriminals or nation states would be interested in compromising space systems. Next, we discuss the various perspectives required to secure space systems. The majority of the presentation describes a Honeywell technique for assessing security risks for safety-critical systems like space systems. We conclude with a discussion of possible next steps in advancing cybersecurity for space systems.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Vessels-Cybersecurity-Risk-Assessment-For-Safety-Critical-Systems.pdf)
### PeriScope: An Effective Probing and Fuzzing Framework for the Hardware-OS Boundary
The OS kernel is an attractive target for remote attackers. If compromised, the kernel gives adversaries full system access, including the ability to install rootkits, extract sensitive information, and perform other malicious actions, all while evading detection. Most of the kernel protection efforts have focused primarily on securing the system call interface, through which adversaries in user space can compromise the kernel. However, there are additional paths to kernel compromise that do not involve system calls, as has been demonstrated by recent remote kernel exploits. For example, by compromising the firmware of a peripheral device such as a Wi-Fi chipset and subsequently sending malicious inputs from the Wi-Fi chipset to the Wi-Fi driver, adversaries have been able to gain control over the kernel without invoking a single system call. Unfortunately, there are currently no versatile probing and fuzzing frameworks that can help developers find and fix vulnerabilities occurring along the hardware-OS boundary.In this talk, I will present PeriScope, a Linux-kernel-based in-kernel probing framework that enables fine-grained analysis of device-driver interactions. PeriScope hooks into the kernel's page fault handling mechanism to either passively monitor and log traffic between device drivers and their corresponding hardware, or mutate the data stream on-the-fly using a fuzzing component, PeriFuzz, thus mimicking an active adversarial attack. PeriFuzz accurately models the capabilities of an attacker on peripheral devices, to expose different classes of bugs including, but not limited to, memory corruption bugs and double-fetch bugs. To demonstrate the risk that peripheral devices pose, as well as the value of our framework, we have evaluated PeriFuzz on the Wi-Fi drivers of two popular chipset vendors, where we discovered 15 unique vulnerabilities, 9 of which were previously unknown.
- [slide](http://i.blackhat.com/USA-19/Wednesday/us-19-Song-PeriScope-An-Effective-Probing-and-Fuzzing-Framework-For-The-Hardware-OS-Boundary.pdf)
### Woke Hiring Won't Save Us: An Actionable Approach to Diversity Hiring and Retention
"Okay, so there are fewer women in infosec than there are men. Let's just hire more qualified women, right? ...Right? "Diversity hiring is a bandaid on top of broader, systemic issues. Compared to our male counterparts, women in information security and engineering have abysmal rates for both matriculation in computer science education programs and retention in full-time STEM employment. Solely encouraging increased recruitment of traditionally underrepresented groups, in this case women, fails to address the underlying issues that result in a smaller pool of women to hire, and double the attrition for women on the job. Despite broad adoption of diversity hiring, it is a fraction of a solution for a fraction of the problem. This limited approach does little to level the playing field to gaining necessary qualifications, nor does it do enough to combat the fact that, after securing full-time work, the quit rate for women is still over twice that of men. So what can we do to ensure equity in our field? How do we go beyond diversity hiring to address inequity? What does "equity" mean, and why do we care in the first place? How can we as a community secure a diverse pool of hiring candidates, and create a sustainable culture that promotes the professional growth of women in infosec?Combining multiple university studies on recruitment and retention in computer science education, and an analysis of business practices, cultures, and post-hire retention data, this talk aims to serve as a call-to-action for our community, and provide realistic practices for all professionals to foster a more inclusive workforce. With a data-driven discussion on effective education and business practices, each attendee will leave with a clearer understanding of their role in promoting the growth of a diverse workforce and a workplace where women are more likely to stay and succeed.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Lynch-Woke-Hhiring-Wont-Save-Us-An-Actionable-Approach-To-Diversity-Hiring-And-Retention.pdf)
### GDPArrrrr: Using Privacy Laws to Steal Identities
On May 25, 2018 the European Union's General Data Protection Regulation (GDPR) came into effect, bringing with it the most expansive governmental effort to regulate data security and privacy to date. Among the GDPR's many provisions is the "Right of Access," which states that individuals have the right to access their personal data. This provision can be easily abused by social engineers to steal sensitive information that does not belong to them.My research centers on a practical case study wherein I attempted to steal as much information as possible about my fiancé (with her consent) using GDPR Subject Access Requests. In a survey of more than 150 companies, I demonstrate that organizations willingly provide highly sensitive information in response to GDPR right of access requests with little or no verification of the individual making the request. This ranges from typical sensitive identity data like addresses and credit card information to esoteric data such as a history of train journeys or a list of domains owned. While far too often no proof of identity is required at all, even in the best cases the GDPR permits someone capable of stealing or forging a driving license nearly complete access to your digital life. Moreover, the highly standardized nature of GDPR requests makes it possible to automate this process at immense scale and provides one of the most reliable general phishing attack typologies to date.This is a solvable problem, and one which could have been incorporated into the initial GDPR if regulatory legislation were subjected to security assessments like those used for modern software. The presentation suggests possible remediations and offers a cautionary tale for future policymakers designing GDPR-inspired privacy legislation. It also suggests short-term ways in which individuals and businesses seeking to protect themselves against these attacks.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Pavur-GDPArrrrr-Using-Privacy-Laws-To-Steal-Identities.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Pavur-GDPArrrrr-Using-Privacy-Laws-To-Steal-Identities-wp.pdf)
### The Future of Securing Intelligent Electronic Devices Using the IEC 62351-7 Standard for Monitoring
Until recently, passive monitoring has been the standard approach for OT networks because of the critical processes these networks support. However, as industrial organizations embrace Industry 4.0 and with the increasing convergence of IT and OT, industrial infrastructure is now exposed to new advanced threats coming from the external perimeter. Addressing this requires OT security solutions that are more effective and efficient. Today there is a better understanding of OT devices and protocols and the availability of dedicated security monitoring protocols. Standards like IEC 62351 define network and system management data object models that can be used to monitor the health of networks and systems, to detect possible security intrusions, and to manage the performance and reliability of the information infrastructure.This makes it possible for industrial security systems to increase their environment awareness by introducing an active interaction with the devices deployed inside the network. This new approach opens an unprecedented number of detection scenarios not possible before, increasing the detection rate, providing better visibility during an incident and offering a cost-effective solution for distributed scenarios. In this session, Nozomi Networks Co-founder and CPO Andrea Carcano and security researchers from Nozomi Networks Labs will present a live coverage analysis of detecting threats with IEC 62351 and SNMP.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Carcano-The-Future-Of-Securing-IED-Using-The-IEC62351-7-Standard-For-Monitoring.pdf)
### Testing Your Organization&#39;s Social Media Awareness
The phishing landscape is rapidly changing, and in the last few years we have witnessed over a 10-fold increase in social media-based phishing. Yet social media sites have taken few steps to detect or block automated intelligence gathering on their platforms, and enterprises are far from understanding the new risks that users face via social media.In this talk, I will examine how new tools can automate social media intelligence gathering, correlating profiles across sites and scraping data on a mass scale. Organizations can use this new intelligence gathering as a way to better understanding who within their companies are the most likely targets of social media-based attack. From there they can test for risks such as employees who are accepting random connection requests on LinkedIn or Facebook, and who is clicking untrusted links sent to them on their work machines. Red team attackers will learn how to scale up their social media phishing campaigns and how to save time when conducting large scale social media-based phishing.During the talk, I will detail Social Mapper as well as release Social Attacker, the first open source, multi-site, automated Social Media Phishing Framework. I’ll be giving a high-level walk through on how you can use this along with Social Mapper to run mock social media phishing campaigns against your organizations. Join me to learn more about these tools and how they can help protect your enterprise.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Wilkin-Testing-Your-Organizations-Social-Media-Awareness.pdf)
### Mobile Interconnect Threats: How Next-Gen Products May be Already Outdated
"Walled garden" used to be the security principle backing SS7 networks. This is no longer the case, and some attackers may benefit from access to these networks to leverage mobile network functions: geolocation, access to subscriber's profile, interception of communications. Mobile network operators now deploy new equipments to detect attacks and protect their customers. These new equipments are expected to be robust against wild traffic and safe. We describe in this talk vulnerabilities we have discovered and what we look into when assessing security of such products.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Teissier-Mobile-Interconnect-Threats-Up.pdf)
### Death to the IOC: What&#39;s Next in Threat Intelligence
Humans cannot scale to the amount of Threat Intelligence being generated. While the Security Community has mastered the use of machine readable feeds from OSINT systems or third party vendors, these usually provide IOCs or IOAs without contextual information. On the other hand, we have rich textual data that describes the operations of cyber attackers, their tools, tactics and procedures; contained in internal incident response reports, public blogs and white papers. Today, we can't automatically consume or use these data because they are composed of unstructured text. Threat Analysts manually go through them to extract information about adversaries most relevant to their threat model, but that manual work is a bottleneck for time and cost. In this project we will automate this process using Machine Learning. We will share how we can use ML for Custom Entity Extraction to automatically extract entities specific to the cyber security domain from unstructured text. We will also share how this system can be used to generate insights such as:Identify patterns of attacks an enterprise may have facedAnalyze the most effective attacker techniques against the enterprise they are defendingExtract trends of techniques used in the overall eco-system or a specific vertical industryThese insights can be used to make data backed decisions about where to invest in the defenses of an enterprise. And in this talk we will describe our solution for building an entity extraction system from public domain text specific to the security domain; using opensource ML tooling. The goal is to enable applied researchers to extract TI insights automatically, at scale and in real time.We will cover:The importance of this process for threat intelligence and share some examples of actionable insights we can provide as a result of this researchOverall Architecture of the system and ML principles usedHow we automatically created a training dataset for our domain using a dictionary of entitiesSupervised and unsupervised featurization methods we experimented withExperimentation and results from Statistical Modeling methods and Deep Learning MethodsRecommendations and resources for Applied Researchers who may want to implement their own TI Extraction pipeline.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Soman-Death-To-The-IOC-Whats-Next-In-Threat-Intelligence.pdf)
### On Trust: Stories from the Front Lines
Time and again, we as consumers read about the latest significant data breach, and we feel a familiar disappointment. Disempowered, helpless, without recourse. Angry for being treated like a commodity. Frustrated that nothing's likely to change.On the other side of the coin, as security practitioners and businesspeople, we have lost sight of our stakeholders' perspectives -- our customers, investors, regulators, and others affected by the success or failure of our work. We focus on specific items like strengthening controls and obtaining compliance certifications, but what we miss is that the single most damaging thing to many companies has been a loss of TRUST.I’ll share my experiences leading the security programs of some of the world’s preeminent companies through times of great change – situations where their response to adversity or a growth opportunity colors their long-term reputation. We’ll explore how companies, like people, develop a character, and that a key determinant of that character is their approach to security and privacy. And we’ll see how this character can lead to, or away from, earning trust. Finally, we’ll consider several major industry happenings over the past few years as examples of companies who have successfully (and unsuccessfully) navigated times of transformative change.It's clear that the pendulum is swinging toward giving consumers more control over their relationships with firms, with watershed changes like the so-called "right to be forgotten", the EU GDPR, and most recently the California Consumer Privacy Act. Firms have to act quickly and decisively to build trust with their stakeholders, or else face lost customer preference, strict regulation, and other business-leveling outcomes.Security practitioners have a uniquely valuable role to play in leading and supporting a company’s ability to maintain trust. Come learn about the next evolution of security’s role in business and society, and practices you can take back to champion trust within your organization.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Farshchi-On-Trust-Stories-From-The-Front-Lines.pdf)
### WebAuthn 101 - Demystifying WebAuthn
Five years later and we're finally at the finish line: Proposed recommendation for W3C WebAuthn. This talk will go into some detail on the use cases WebAuthn sets out solve, how we got here, what's ready for implementation today and what's coming. *Any* service implementing authentication should take note.At Google I'm in the unique position to be part of the standards body, heading the team doing the implementation in platforms (Chrome, Android, CrOS) and responsible for our internal implementation so I have a pretty a unique perspective on this work.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Brand-WebAuthn-101-Demystifying-WebAuthn.pdf)
### Attack Surface as a Service
Protecting public facing assets is becoming increasingly problematic for any company with an online presence today. Growing online communities providing pre-built tools to easily bypass traditional defenses and a constant tug-of-war between usability and security contribute to this emerging, complex issue.What if we could force malicious actors into our own, controlled, battleground and move the attack surface away from our assets?By directing attacks away from the target website and onto our own environment, we force them to play by our rules. We can use this ‘attack surface’ to automatically adapt to new threats, gain direct feedback through network effect, and utilize automated processes and ML to evolve with each attack. This allows us to interrogate a suspect attacker through tests that are difficult to implement directly onto the asset.This talk will outline the practical and hypothetical applications of utilizing third party services as a democratized defense against attackers informed by network effect with an emphasis on the separated ‘attack surface’ introduced above. 
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Westelius-Attack-Surface-As-A-Service.pdf)
### Denial of Service with a Fistful of Packets: Exploiting Algorithmic Complexity Vulnerabilities
How many bytes do you need to take down a web server? The answer might be fewer than you think. Algorithmic complexity (AC) vulnerabilities allow an attacker to submit a small amount of input to an algorithm and cause the target to perform a large amount of work. By leveraging AC vulnerabilities, an attacker can create a denial of service effect without the large resource requirements of a traditional DDoS attack. AC vulnerabilities present attractive DoS opportunities for attackers because they aren't bugs, and are therefore difficult to fix. Exploits may be valid input and hence may not produce observables such as unusual log messages or errors.In this talk we will reveal three distinct zero-day AC vulnerabilities affecting PDF readers, common linux VNC servers, and a popular user authentication library. We'll show how to generate low-RAM, CPU DoS attacks against online OCR platforms, how to remotely exhaust the disk space on a VNC server without ever logging in, and how to launch a DoS attack against a web server from the user signup page. We will dive deep into the technical details of each exploit, examine the paths we followed that led to their discovery, and demonstrate each exploit against a range of vulnerable targets.Through these examples, we will show how AC vulnerabilities can be born out of intended functionality, and how existing security testing procedures fail to defend against AC attacks. In addition to providing specific mitigations against the attacks we discovered, we will introduce general strategies for improving your security posture against AC attacks. In coordination with our talk we will release PoC code for auditing your own applications as part of our ongoing contribution to the ACsploit project, an open-source platform introduced at Black Hat Asia 2019 for generating worst-case inputs to common algorithms.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Hauke-Denial-Of-Service-With-A-Fistful-Of-Packets-Exploiting-Algorithmic-Complexity-Vulnerabilities.pdf)
### Breaking Through Another Side: Bypassing Firmware Security Boundaries from Embedded Controller
Hardware security boundaries are really difficult to support and correctly design. On modern x86 platforms exist a lot of different hardware components. It's clear they should be included in the usual threat model's obvious external paths, but what if the attacker can compromise one of the trusted components? We have previously seen when researchers compromise TPM and start the initial point of the attack from inside of trusted boundary. All these points create concerns on the current threat modeling process because after attacker crosses a trusted boundary, the attack surface significantly changes. Does this mean the attack surface is dynamic and not static?In our presentation, we focus on reverse engineering Embedded Controller (EC) from one of the recent Lenovo Thinkpad laptops, attacks from EC trusted boundary the main platform firmware (BIOS) and we manage to bypass Intel BIOS Guard technology (Lenovo specific implementation). We will present multiple topics across security boundaries problems on x86 platforms, as well as demonstrate platform design problems with trust to third-party components as EC and show the real attacks from OS-level to EC/from EC to BIOS.This research targeting reverse engineering topics of EC firmware are based on ARC processor architecture, the internals of EC architecture and specific operating modes to support SMI-handlers on EC side (include BIOS Guard). Also, we reverse engineered the most interesting parts of communications and relations between BIOS and EC. The attack surface from EC with attacker perspective is quite large and can include DMA attacks, disclose of PCI memory space to attack devices and the possibility of persistent rootkit/implant installation.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Matrosov-Breaking-Through-Another-Side-Bypassing-Firmware-Security-Boundaries-From-Embedded-Controller.pdf)
### Project Zero: Five Years of &#39;Make 0Day Hard&#39;
This year marks the fifth anniversary of Project Zero, an applied security research team at Google that aims to "make 0day hard". It has been a tumultuous and exciting journey so far, and we've managed to explore a huge range of weird and wonderful attacks. Full-chain browser exploits. Remote WiFi firmware attacks. The trials and tribulations of Flash! Kernel and userland privilege escalation for Linux, Windows, macOS, chromeOS, iOS, and Android. Hypervisor escapes. Oh, and something about speculative execution...We've published a dizzying array of vulnerabilities and exploits. But why? How? And what does this all mean for user security? This presentation gives a behind-the-scenes look at Project Zero's work, and a retrospective assessment of the impact this work has had. We'll look at why a team like Project Zero is needed in the first place, and some of the core principles that we use to make decisions. We'll dive into some of the classic hits from Project Zero's portfolio, and share some of the technical insights that result. And finally, we'll share some of the lessons learned, and a sketch for the next five years of Project Zero.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Hawkes-Project-Zero-Five-Years-Of-Make-0day-Hard.pdf)
### Rough and Ready: Frameworks to Measure Persistent Engagement and Deterrence
The US is in the midst of its most dramatic shift in policy, emphasizing forward defense and deterrence and to "intercept and halt" adversary cyber operations. Supporters believe these actions should significantly reduce attacks against the United States, while critics worry they may incite more adversary activity. There is no standard methodology to measure which is the case. This talk details recent research to introduce transparent frameworks to better assess whether the new U.S. policy and actions are suppressing or encouraging attacks.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Healey-Rough-and-Ready-Frameworks-To-Measure-Persistent-Engagment-and-Deterrence.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Healey-Rough-and-Ready-Frameworks-to-Measure-Persistent-Engagement-and-Deterrence-wp.pdf)
### 100 Seconds of Solitude: Defeating Cisco Trust Anchor With FPGA Bitstream Shenanigans
First commercially introduced in 2013, Cisco Trust Anchor module(TAm) is a proprietary hardware security module that is used in a wide range of Cisco products, including enterprise routers, switches and firewalls. TAm is the foundational root of trust that underpins all other Cisco security and trustworthy computing mechanisms in such devices. We disclose two 0-day vulnerabilities and show a remotely exploitable attack chain that reliably bypasses Cisco Trust Anchor.We present an in-depth analysis of the TAm, from both theoretical and applied perspectives. We then present a series of architectural and practical flaws of TAm and describe theoretical methods of attack against such flaws. Next, we enumerate limitations in current state-of-the-art offensive capabilities that made the design of TAm appear secure.Using Cisco 1001-X series of Trust Anchor enabled routers as a demonstrative platform, we delve into a detailed analysis of a current implementation of TAm, including results obtained through hardware reverse engineering, Trust Anchor FPGA bitstream analysis, and the reverse engineering of numerous Cisco trustworthy computing mechanisms that depend on TAm. Finally, we present two 0-day vulnerabilities within Cisco IOS and TAm and demonstrate a remotely exploitable attack chain that results in persistent compromise of an up-to-date Cisco router. We will discuss the implementation of our TAm bypass, which involves novel methods of reliably manipulating FPGA functionality through bitstream analysis and modification while circumventing the need to perform RTL reconstruction. The use of our methods of manipulation creates numerous possibilities in the exploitation of embedded systems that use FPGAs. While this presentation focuses on the use of our FPGA manipulation techniques in the context of Cisco Trust Anchor, we briefly discuss other uses of our bitstream modification techniques.
### Planning a Bug Bounty: The Nuts and Bolts from Concept to Launch
Thinking about launching a vulnerability disclosure or bug bounty program and not sure where to start? Do you use a bug bounty platform or self-host; hire a 3rd party service provider or run things yourself? What should your program rules contain, and how should you engage your legal team? How much should you reward, and how do you pay researchers? How do you build partnerships with engineering teams and what do long product release cycles mean? There are lots of things to consider when planning a bounty program, and we’ll give you an actionable punch list of operational decisions to go through to ensure you’re set up for success!
### All Your Apple are Belong to Us: Unique Identification and Cross-Device Tracking of Apple Devices
Privacy is about people. Smartphones and laptops (e.g., iPhone, iPad, and MacBooks) are the most frequently used personal devices. Consequently, people with ulterior motives (e.g., advertisers) can easily connect to individuals through these devices. Although Apple is trying to provide the best protection of personal information on Apple devices, many approaches (e.g., private APIs and vulnerabilities) are being abused to uniquely identify users. Besides, identifying and correlating people's devices allows cross-device companies to track one person and target operations (e.g., advertising) on both of his/her devices. However, such cross-device tracking can principally reveal a complete picture of a person and become more privacy-invasive than the simple tracking.In this talk, we will show a study of unique identification and cross-device tracking technologies of Apple devices. We first list several approaches (e.g., public APIs and vulnerabilities like CVE-2018-4322) to uniquely identify the Apple device even after a system rebooting or resetting. Moreover, we present advanced algorithms and vulnerabilities (e.g., CVE-2018-4321) to associate Apple device through deterministic user IDs (e.g., Apple IDs and phone numbers) and probabilistic data (e.g., device names, coordinate information, and IP addresses). Last but not least, we discuss feasible solutions (e.g., instrumentation and differential privacy) to prevent unique identification and cross-device tracking. It is worth noting that all vulnerabilities we found were reported to Apple (follow-up id: 710526756) and we believe our study can help Apple to maintain and improve the privacy of their products.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Zheng-All-Your-Apple-Are-Belong-To-Us-Unique-Identification-And-Cross-Device-Tracking-Of-Apple-Devices.pdf)
### Playing Offense and Defense with Deepfakes
This presentation seeks to demonstrate how deepfaking can be leveraged for offensive and defensive purposes. Specifically, deepfake internals are presented including a fine grained, step-by-step breakdown of creation, including the details of all deep learning models used in the process. A test deepfake video is created. A malicious deepfake video is then created, in which an international politician is impersonated. This video is then temporarily circulated in the wild, as a means for measuring impact. The offense section of the presentation is followed by a defense section. This section provides an overview of contemporary techniques for detecting deepfake videos. A novel approach to detecting deepfake videos is then introduced. Finally, a tool for offensive and defensive research, known as deepstar, is announced and released at the time of the presentation.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Price-Playing-Offense-And-Defense-With-Deepfakes.pdf)
### The Enemy Within: Modern Supply Chain Attacks
I'm in your supply chain, and you're probably in mine. Our increasingly interconnected infrastructure leaves us all vulnerable. With hundreds of millions of devices and millions of enterprises betting on the cloud, we see sophisticated attacks every day. Hardware, software, and service-based attacks, good and bad engagements with suppliers and partners – we've seen it all.

Go behind the scenes and learn about previously undisclosed supply chain attacks – from the techniques and objectives of adversaries, the mechanisms that were effective in blunting their attacks, and the sometimes-comical challenges dealing with our most complex asset to defend… developers. 

It's a statistical certainty, everyone will eventually be a victim of a supply chain compromise. Whether you're in SecOps or App Development, you'll leave this presentation with practical guidance on how to defend against supply chain attacks and harden your systems.  Prevention is important, but how you respond when you get owned is the true test of character. Are you up to the challenge?
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Doerr-The-Enemy-Within-Modern-Supply-Chain-Attacks.pdf)
### Information Security in the Public Interest
Computer security is now a public policy issue. Election security, blockchain, "going dark," the vulnerabilities equities debate, IoT safety, data privacy, algorithmic security and fairness, critical infrastructure: these are all important public policy issues with a strong Internet security component. But while an understanding of the technology involved is fundamental to crafting good policy, there is little involvement of technologists in policy discussions. This is not sustainable. We need public-interest technologists: people from our fields helping craft policy, and working to provide security to agencies and groups working in the broader public interest. We need these people in government, at NGOs, teaching at universities, as part of the press, and inside private companies. This is increasingly critical to public safety and overall social welfare. This talk both describes the current state of public-interest technology, and offers a way forward for us individually and collectively for our field. The defining policy question of the Internet age is this: How much of our lives should be governed by technology, and under what terms? We need to be involved in that debate.
### Bounty Operations: Best Practices and Common Pitfalls to Avoid in the First 6-12 Months
Ever want to talk to someone that runs a bug bounty program and trade best practices and horror stories? Join this panel of bounty managers for real talk on signal vs noise, ROI, interacting with bounty hunters, and all the little things they wish they'd known before learning the hard way. Panelists will share strategies for day to day operations, triage strategies and scope setting, and chat about which vulnerability types are found most often and why they still end up in production code after over a decade of advances in security tooling and secure development practices.
### DevSecOps : What, Why and How
Security is often added towards the end, in a typical DevOps cycle through a manual/automated review. However, with DevSecOps, security can be injected at every stage of a DevOps pipeline in an automated fashion. Having a DevSecOps pipeline enables an organization to:Create a security culture amongst the already integrated “DevOps” team.Find and fix security bugs as early as possible in the SDLC .Promote the philosophy “security is everyone’s problem” by creating Security champions within the organization.Integrate all security software centrally and utilize the results more effectively.Measure and shrink the attack surface.In this talk, we shall focus on how a DevOps pipeline can easily be metamorphosed into a DevSecOps and the benefits which can be achieved with this transformation. The talk (assisted with various demos) will focus on developing a DevSecOps pipeline using free/open-source tools in various deployment platforms, i.e. on-premise, cloud native and hybrid scenarios. We will then dive into cultural aspects of DevSecOps and the changes needed to get tangible benefits. The talk will also present various case studies on how critical bugs and security breaches affecting popular software and applications could have been prevented using a simple DevSecOps approach.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Shrivastava-DevSecOps-What-Why-And-How.pdf)
### Breaking Encrypted Databases: Generic Attacks on Range Queries
Security researchers and practitioners have proposed many techniques for securely storing and querying outsourced data. I'll start this talk with an overview of common building blocks and the latest commercial and academic solutions, focusing on those that support range queries (e.g., selecting all records where the age attribute is between 18 and 65). These techniques are tailored to specific threat models. For example, if the database server is trusted but not the network, connections can be encrypted with TLS. If the database server is trusted but there is a risk of disk theft, full-disk encryption or page-level encryption of database files and logs (e.g., Transparent Data Encryption) can be enabled. If the database server isn't trusted at all, a system that encrypts all data before uploading it (e.g., via a CipherCloud gateway or CryptDB proxy server) could be employed.All of these solutions, however, leak some information when a query is processed -- like the set of records matching the query, or the size of this set. This information leaks even to an observer who doesn't have any cryptographic keys. The source of the leakage can vary; it could be network traffic, observed memory accesses, or database logs recovered by forensic analysis. I'll explain how this leakage can be exploited by an attacker to break the encryption and recover values in the database. These attacks are entirely generic and don't depend on the database implementation. They have connections to graph theory, Golomb rulers, and machine learning. I'll discuss proposed countermeasures, and finish by offering guidelines that practitioners can use when assessing the security claims of the latest and greatest database encryption solutions.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Lacharite-Breaking-Encrypted-Databases-Generic-Attacks-On-Range-Queries.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Lacharite-Breaking-Encrypted-Databases-Generic-Attacks-On-Range-Queries-wp.pdf)
### Finding Our Path: How We&#39;re Trying to Improve Active Directory Security
As the dominant directory service solution, Active Directory persists as the crucial backbone of identity, authentication, and security for organizations of all sizes. Over time, nearly every Active Directory environment becomes an unwieldy, complex, and dynamic web of operating systems, user behaviors, and configurations. Historically, understanding the implications of any one user logon or configuration has taken hours -- understanding the implications of millions of user logons and configurations was almost impossible.﻿In this talk, we will share our success stories, lessons learned, and methodologies for enumerating, understanding, and mitigating the risks posed by disparate user behaviors and configurations. Whether your network has 50, 5,000, or 500,000 computers joined to Active Directory, you’ll walk away from this talk knowing how to greatly enhance your organization’s Active Directory security posture in days or weeks, not years. We will also demonstrate several attack primitives that are newly tracked by BloodHound, including Resource-Based Constrained Delegation.
### API-Induced SSRF: How Apple Pay Scattered Vulnerabilities Across the Web
The 2016 WWDC saw the dawn of Apple Pay Web, an API that lets websites embed an Apple Pay button within their web-facing stores. Supporting it required a complex request flow, complete with client certificates and a custom session server. This proved detrimental, since Apple failed to caution against important side effects of taking in untrusted URLs. As a result, many new SSRF vulnerabilities entered the world. Worse yet, while they were exploitable and discoverable in similar ways, they were spread across distinct codebases in several programming languages, so could not be patched in any generic way.Apple is not alone - in the process of gluing the web together, Twilio, Salesforce, and others have all created similarly broad attack surfaces. When companies fail to take an honest, empathetic look at how clients will use a product, they shove along hidden security burdens. Those who integrate with an API have less context than those who create it, so are in a worse position to recognize these risks.Engineers have been talking about defensive programming for decades, but top companies still have trouble practicing it. In this talk, we explore these mistakes with demos of affected software, and propose actionable ways of rethinking API security.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Maddux-API-Induced-SSRF-How-Apple-Pay-Scattered-Vulnerabilities-Across-The-Web.pdf)
### Process Injection Techniques - Gotta Catch Them All
When it comes to process injection in Windows, there are only 6-7 fundamental techniques, right? That's what we thought in late 2018, when we started researching this area. Turned out we were way off the mark. We counted 20 techniques (so far…), which we had to collect, extract and analyze from many websites, blogs and papers. This in turn begged the question – where is that ultimate "Windows process injection" collection?In this presentation, we provide the most comprehensive to-date "Windows process injection" collection of techniques - the first time such resource is available, that really covers all (or almost all) true injection techniques. We focus on Windows 10 x64, and on injections from running 64-bit medium integrity process to another running 64-bit medium integrity process, without privilege elevation. We pay special attention to the new Windows protection technologies, e.g. CFG and CIG. We differentiate between memory write primitives and execution techniques, and discuss memory allocation strategies. Our collection is curated, analyzed, tabulated, with straight-forward, research-grade PoCs. We tested each technique against Windows 10 x64 with and without protections, and we report on the requirements, limitations, and quirks of each technique.And of course – no decent BlackHat presentation is complete without new attacks. We describe a new memory writing primitive which is CFG-agnostic. We describe a new "stack bombing" execution method (based on the memory write primitive above) that is inherently safe (even though overwriting the stack is a-priori a dangerous and destabilizing action).Finally, we provide a mix-and-match library of all write primitives and execution methods, so that process injection users can generate "tailor-made" process injections.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Kotler-Process-Injection-Techniques-Gotta-Catch-Them-All.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Kotler-Process-Injection-Techniques-Gotta-Catch-Them-All-wp.pdf)
- [source_code](https://github.com/SafeBreach-Labs/pinjectra)
### Women in Security: Building a Female InfoSec Community in Korea, Japan, and Taiwan
The information security industry has historically been a male-dominated field, and today, unfortunately, this situation has not changed much. Indeed, the survey conducted by Frost & Sullivan in 2017 concluded that women represented only 11% of the current information security workforce.

 While more women are expected to join the information security industry to reach new levels of innovation, still, it is difficult to increase their number because women face many obstacles, such as stereotype bias. One way to bridge this gap is a female community, which can support and motivate women, and produce more role models.

 In this talk, we will introduce three representative Asian female communities, Power of XX, CTF for GIRLS, and HITCON GIRLS, which are established in Korea, Japan, and Taiwan, respectively. We will first explain how we build and maintain each female community, and then go into the details of how we tackled various challenges, such as building a sustainable community and attracting and retaining new members. 

 Moreover, a comparison of these three communities reveals some of the crucial factors in starting and continuing a female community. One of the examples is that each community started by a few tech-savvy women with the support of an existing local community, such as POC, SECCON, and HITCON. Another example is that all the community members are connected by their interests in technology, such as binary analysis, web exploitation, and playing CTF, and they teach the related topics to each other interactively.

 We believe that our insights could help start a new female community and encourage other existing female communities.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Nakajima-Women-In-Security-Building-A-Female-InfoSec-Community-In-Korea-Japan-And-Taiwan.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Nakajima-Women-In-Security-Building-A-Female-InfoSec-Community-In-Korea-Japan-And-Taiwan-wp.pdf)
### Rogue7: Rogue Engineering-Station Attacks on S7 Simatic PLCs
The Siemens industrial control systems architecture consists of Simatic S7 PLCs which communicate with a TIA engineering station and SCADA HMI on one side, and control industrial systems on the other side. The newer versions of the architecture are claimed to be secure against sophisticated attackers, since they use advanced cryptographic primitives and protocols. In this paper we show that even the latest versions of the devices and protocols are still vulnerable. After reverse-engineering the cryptographic protocol, we are able to create a rogue engineering station which can masquerade as the TIA to the PLC and inject any messages favourable to the attacker. As a first example we extend attacks that can remotely start or stop the PLC to the latest S7-1500 PLCs. Our main attack can download control logic of the attacker's choice to a remote PLC. Our strongest attack can separately modify the running code and the source code, which are both downloaded to the PLC. This allows us to modify the control logic of the PLC while retaining the source code the PLC presents to the engineering station. Thus, we can create a situation where the PLC's functionality is different from the control logic visible to the engineer.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Bitan-Rogue7-Rogue-Engineering-Station-Attacks-On-S7-Simatic-PLCs.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Bitan-Rogue7-Rogue-Engineering-Station-Attacks-On-S7-Simatic-PLCs-wp.pdf)
### Operational Templates for State-Level Attack and Collective Defense of Countries
The veneer of modern civilization is thin and brittle. Given sufficient will, it is disturbingly easy to systematically dismantle the functions of government and the cohesion which binds society together. Armies are maneuvering in cyberspace right now. State cyberspace, electronic warfare, and information operations forces wield massive power that, when combined, can overwhelm fragile infrastructure and disjoint defenses. 

We see ongoing targeting and increasingly intense probing of critical infrastructure on a global scale. The trend is toward operations of increasing scope and impact, from passive surveillance to disruption to destruction. We must acknowledge that the groundwork has already been laid for even more aggressive attacks, and that today's operations serve to prove and hone those capabilities.

Enterprises and organizations attempting to stand as individuals against such threats will be defeated as individuals. Governments can help, but often stumble due to political indecisiveness, ponderous bureaucracies, and inability to focus beyond the near-term. We need collective defenses that match the agile, coordinated offensive techniques state forces can bring to bear. 

In this talk we examine templates for attacking and defending nations. Militaries have long used doctrinal templates – models based on known or postulated adversary doctrine – to support traditional kinetic warfare training and warfighting. The same approach works well for defending in cyberspace. We'll provide templates of ways threat actors could  disrupt or defeat a country, considering various time horizons and degrees of attribution. 

You'll leave this talk with a playbook for how nations might be attacked and defended, a methodology for creating templates and scenarios useful for your own defensive planning, and an enhanced understanding of our collective vulnerability and the need for teamwork to overcome the problem.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Conti-Operational-Templates-for-State-Level-Attack-and-Collective-Defense-of-Countries.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Conti-Operational-Templates-for-State-Level-Attack-and-Collective-Defense-of-Countries-wp.pdf)
### Exploiting Qualcomm WLAN and Modem Over The Air
In this talk, we will share our research in which we successfully exploit Qualcomm WLAN in FIRMWARE layer, break down the isolation between WLAN and Modem, and then fully control the Modem over the air.Setting up the real-time debugger is the key. Without the debugger, it's difficult to inspect the program flow and runtime status. On the Qualcomm platform, subsystems are protected by the Secure Boot and unable to be touched externally. We'll introduce the vulnerability we found in Modem to defeat the Secure Boot and elevate privilege into Modem locally so that we can setup the live debugger for baseband.The Modem and WLAN firmware is quite complex and reverse engineering is a tough work. Thanks to the debugger, we finally figured out the system architecture, the components, the program flow, the data flow, and the attack surfaces of WLAN firmware. We'll share these techniques in detail, along with the zero-days we found on the attack surfaces.There are multiple mitigations on Qualcomm baseband, including DEP, stack protection, heap cookie, system call constraint, etc. All the details of the exploitation and mitigation bypassing techniques will be given during the presentation.Starting from Snapdragon 835, WLAN firmware is integrated into the Modem subsystem as an isolated user space application constraint. We'll discuss these constraints, and then leverage the weakness we found to fully exploit Modem.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Pi-Exploiting-Qualcomm-WLAN-And-Modem-Over-The-Air.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Pi-Exploiting-Qualcomm-WLAN-And-Modem-Over-The-Air-wp.pdf)
### Zombie Ant Farming: Practical Tips for Playing Hide and Seek with Linux EDRs
EDR solutions have landed in Linux. With the ever increasing footprint of Linux machines deployed in data centers, offensive operators have to answer the call. 

In the first part of the talk we will share practical tips and code techniques the offense can use to slide under the EDR radar, and to expand its post-exploitation capabilities.

We will walk through examples and see how approved executables could be used as decoys to cleanly execute foreign code. We will review the primitives and building blocks of Linux malware that can be invoked by the dynamic ELF loader and the process bootstrap routines. Actionable and battle tested practical tips to assist Red Teams with evasion will be shown.

Part two will focus on expanding and weaponizing the capabilities. We will show how to create feature rich chained preloaders, and use mimicry to hide modular malware during execution. To support the discussion, we will demo a memory-assisted "Preloader-as-a-Service" capability by abstracting storage of malware from its executing cradles. We will talk about operationalizing Linux memory-based implants. Finally, we will show techniques for evading EDRs with cross memory attach injection in deliberately ASLR weakened executables.

We fully believe the ability to retool in the field matters more than standalone tools, so we have packaged the techniques into reusable code patterns in a toolkit you will be able to use or take inspiration from after the talk.

The talk will conclude with pointers for Defense to mitigate the techniques we have shown. And most importantly, we will reveal what Zombies have to do with Ants :)
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Snezhkov-Zombie-Ant-Farming-Practical-Tips-For-Playing-Hide-And-Seek-With-Linux-EDRs.pdf)
### 0-days & Mitigations: Roadways to Exploit and Secure Connected BMW Cars
Cyber security for connected cars has become a widespread concern over the past years. In years 2016 and 2017, Keen Security Lab has demonstrated two remote attacks against Tesla Model S/X; In March 2018, Keen Security Lab successfully implemented new exploit chains on multiple BMW car models through physical access and a remote approach without any user interaction. At that time, following a responsible disclosure procedure, Keen Security Lab released a security assessment report to make a brief vulnerabilities disclosure, instead of a full disclosure, a standard procedure in the security industry. The findings have been verified, addressed, and fixes and mitigation have been rolled out. Now we're ready to share the findings together with security experts from BMW Group. In this presentation, we will introduce the system architecture and external attack surfaces of connected cars, then give details about the vulnerabilities including multiple 0-days, which existed in two vehicle components: Infotainment System (a.k.a. Head Unit) and Telematics Control Unit. Keen Security Lab research findings have proven the possibility of arbitrary code execution in the Infotainment System via common external interfaces including USB, Ethernet and OBD-II, and also remote exploitation of the Telematics Control Unit over a fake mobile network with the payload delivered in HTTP and SMS (Short Message Service). Furthermore, Keen Security Lab will also explore the CAN network architecture of BMW cars and analyze how to combine logic flaws in the Gateway to trigger arbitrary, unauthorized diagnostic vehicle functions remotely using CAN buses from both Infotainment System and Telematics Control Unit. Lastly, we will summarize exploit chains and mitigation measures. Together with BMW Group security experts we are going to present details on analysis, validation and roll-out of countermeasures.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Cai-0-Days-And-Mitigations-Roadways-To-Exploit-And-Secure-Connected-BMW-Cars.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Cai-0-Days-And-Mitigations-Roadways-To-Exploit-And-Secure-Connected-BMW-Cars-wp.pdf)
### Predictive Vulnerability Scoring System
Effective prioritization of vulnerabilities is essential to staying ahead of your attackers. While your threat intelligence might expose a wealth of information about attackers and attack paths, integrating it into decision-making is no easy task. Too often, we make the mistake of taking the data given to us for granted – and this has disastrous consequences. 

We'll explain what we miss by trusting CVSS scores, and what should absolutely be taken into consideration to focus on the vulnerabilities posing the greatest risks to our organizations. We'll look at tens of thousands of vulnerabilities, CVSS scores, CVE, NVD, scraping mailing lists, collecting data feeds and ultimately end up with a few dozen data points that helped us understand the probability of a vulnerability being exploited.

Finally, we'll use all that data as well as billions of in-the-wild events collected over 5 years in order to create a machine learning model for predicting the probability of a vulnerability being exploited, a scoring system which outperforms CVSS on every metric: accuracy, efficiency and coverage.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Roytman-Jacobs-Predictive-Vulnerability-Scoring-System.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Roytman-Predictive-Vulnerability-Scoring-System-wp.pdf)
### Behind the scenes of iOS and Mac Security
With over 1.4 billion active devices and in-depth security protections spanning every layer from silicon to software, Apple works to advance the state of the art in user security with every new product and software release. We will discuss three iOS and Mac security topics in unprecedented technical detail, offering the first public discussion of several key technologies new to iOS 13 and the Mac.Code integrity enforcement has long been a critical part of the iOS security architecture. Starting with iPhone 7, we began to fortify core pieces of this security mechanism with new features built directly into Apple silicon. We will delve into the history of code and memory integrity technologies in the iOS kernel and userland, culminating in Pointer Authentication Codes (PAC) in the Apple A12 Bionic and S4 chips. PAC prohibits modification of function pointers, return addresses and certain data, preventing traditional exploitation of memory corruption bugs. We will take a close look at how PAC is implemented, including improvements in iOS 13. We will also discuss previously-undisclosed VM permission and page protection technologies that are part of our overall iOS code integrity architecture. The T2 Security Chip brought powerful secure boot capabilities to the Mac. Comprehensively securing the boot process required protections against sophisticated direct memory access (DMA) attacks at every point, even in the presence of arbitrary Option ROM firmware. We will walk through the boot sequence of a Mac with the T2 Security Chip and explain key attacks and defenses at each step, including two industry-first firmware security technologies that have not been publicly discussed before.The Find My feature in iOS 13 and macOS Catalina enables users to receive help from other nearby Apple devices in finding their lost Macs, while rigorously protecting the privacy of all participants. We will discuss our efficient elliptic curve key diversification system that derives short non-linkable public keys from a user’s keypair, and allows users to find their offline devices without divulging sensitive information to Apple.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Krstic-Behind-The-Scenes-Of-IOS-And-Mas-Security.pdf)
### Practical Approach to Automate the Discovery and Eradication of Open-Source Software Vulnerabilities at Scale
Over the last decade, there has been steady growth in the adoption of open-source components in modern web applications. Although this is generally a good trend for the industry, there are potential risks stemming from this practice that requires careful attention. In this talk, we will describe a simple but pragmatic approach to identifying and eliminating open-source vulnerabilities in Netflix applications at scale.Our solution at Netflix is focused on identifying, triaging, and eliminating vulnerabilities in common software packages and their transitive dependencies.This talk will cover the following topics:A brief history of open source security and vulnerabilitiesReasons why this attack surface is still a problem in modern open-source librariesMethods that attackers use to exploit vulnerabilities in open-source librariesReasons why it is easy to carry out attacks against any organizationWe will then explore how the Netflix AppSec team has worked to solve the problem at scale, describing the various stages in our automation strategy and the tools that we are using to help us achieve our goals.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Almubayed-Practical-Approach-To-Automate-The-Discovery-And-Eradication-Of-Open-Source-Software-Vulnerabilities-At-Scale.pdf)
### Managing for Success: Maintaining a Healthy Bug Bounty Program Long Term
Your bounty program has launched and is clicking along… but are you getting optimal results once the initial excitement wanes?  How do you measure and report on program success?  How can you build gamification and incentive models that lead to high value vulnerability reports, while discouraging low impact reports that distract your engineers from issues that put customers at risk?  And while everyone hopes to never need it, what’s the playbook for handling conflict or vulnerability disclosure situations?
### Ghidra - Journey from Classified NSA Tool to Open Source
This year was a momentous one for the National Security Agency (NSA) as we released our game-changing software reverse engineering (SRE) framework to the open source community: Ghidra. This was a long and arduous process and we want to give Black Hat attendees a chance to hear from two of our experts on how we developed Ghidra, what the tool does, and the process to release it to the public. We will also share some of the insight into what it is like for NSA researchers to interact with the dynamic nature of an open source tool… and the social media attention that it attracts.
### Firmware Cartography: Charting the Course for Modern Server Compromise
The modern server is the Matryoshka doll of computers, computers inside computers, a giant, undocumented mess. Undocumented devices have made homes at undocumented addresses, on buses, and in protocols most server owners don't know exist. With few exceptions, however, they and their secrets can't really stay hidden -- you just have to know how to look.In this talk, we'll cover our methodology for vulnerability hunting in undocumented server components, mapping the paths laid out in binary firmware images. Tracking the interactions between software, hardware, and everything in-between exposes the permeable (or missing!) security controls that attempt to block you from opening these new worlds to explore. Through PoC helper libraries and chaining useful primitives together, oh, the places you'll go.In addition to showing how to find new vulnerabilities, we'll use case studies of public vulns found by ourselves and others, explaining what makes them unique, or common, and other unreleased exploitation details. We'll release initial versions of Binary Ninja plugins we're working on at Atredis Partners, bringing UEFI coverage to the new platform and its hot MLIL. And who knows, we might disclose some new bugs or useful post exploitation details if we're able.
### Infighting Among Russian Security Services in the Cyber Sphere
Much Western coverage of Russian hacking focuses on "Russia," as if the nation were a monolithic whole and all of the various entities conducting offensive hacking campaigns share the same goals and incentives. But, as the cliché goes, "the Kremlin has many towers," and the security services are no exception. If anything, this phenomenon has increased in recent years, as the heightened levels of infighting in all branches of power directly affected the security services and their activities in the cyber realm. Honest people and institutions remain in Russia, but operating that way appears increasingly difficult. The competition between branches of the security services is periodically apparent to outside observers, such as when rival agencies both compromise the same targets at the same time, thereby increasing the risk of discovery for both, or in which agencies get public assignments for different aspects of cyber operations. It is also apparent in less concrete measures, such as unexpected criminal charges for officials or rumors within Russia of specific conflicts, sabotage and even treason designed to destroy institutional rivals. One place where all of these factors collide is the treason trial currently taking place in Moscow of two FSB agents, a businessman and the head of cybersecurity investigations at Kaspersky Lab. The actual criminal charges originated as conspiracy accusation by a soon to be convicted and imprisoned cybercriminal seeking to avoid prison in 2011, but were resurrected as a useful tool in 2016. The speaker is also involved in this case, as she was among those conducting cybercriminal research into the relevant case in 2011 and was subsequently included in the conspiracy accusations. She is named in the current trial as well, but is not charged (foreigners can't be traitors).This talk draws on more than a decade of research into the cyber threat environment of the RuNet (much of it conducted in Russia) and insight gained as a bit player in a trial that is itself a significant escalation among Russia's security agencies. It will discuss the competition between Russia's security agencies active in the cyber sphere, as well as the specific conflicts, and actions, that may have played a role in creating the current situation, and how the current situation could influence future decisions regarding international campaigns.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Zenz-Infighting-Among-Russian-Security-Services-in-the-Cyber-Sphere.pdf)
### Preventing Authentication Bypass: A Tale of Two Researchers
“I discovered a critical security issue that lets an attacker compromise any other user’s account without any user interaction."Join Terry Zhang, Ron Chen, and a Microsoft Engineer for the coordinated public disclosure of a critical elevation of privilege vulnerability. This is the story of a research collision by two security researchers and the emergency response investigation that was launched as a result of their vulnerability reports. Attendees will learn the techniques used by researchers to identify the vulnerability, how companies can effectively partner with researchers throughout the disclosure process to protect customers, and what application developers can do to more securely code web applications to avoid similar flaws.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Jaiswal-Preventing-Authentication-Bypass-A-Tale-Of-Two-Researchers.pdf)
### Automation Techniques in C++ Reverse Engineering
This presentation will discuss several generic, automated dynamic analysis techniques based on DLL injection for type analysis while reverse engineering C++ code. We focus on discovering the locations where structures are used within a C++ program throughout execution, as well as determining the types of function arguments. The data that we collect can also provide insight on inheritance and composition relationships, as well as subtype inference. Source code will be made available, including the injected DLLs and data visualization plugins for IDA and Hex-Rays. 
### Inside the Apple T2
Apple's T2 Security Chip promised to bring "a new level of integration and security" to new generation Mac systems. The T2 chip provides systems with a secure enclave coprocessor that is leveraged to protect Touch ID data, enable encrypted storage and provide secure boot capabilities. In this presentation we will share a deep dive into the inner workings of the T2 going way beyond the limited technical details Apple have made public up to now. In addition, we will share our methodology along with the tooling we developed and subsequently released in an effort to enable the audience to learn about our process of tackling complex security research tasks as well as being able to build on top of our initial research.

Our goal was to assess the current security posture of the T2 chip as well as build tools to enable future research into the platform. Two specific areas of interest for us were Apple's secure boot process as well as how the T2 chip communicates with macOS. Our research of Secure Boot functionality outlines how the process works, what attacks may be mitigated and what attack surface remains.  In addition we will cover how Apple implemented eSPI and what this means from an attacker's perspective. Attendees will obtain an understanding of how the T2 chip has been implemented and what services it exposes to both the OS and application layers. 

In exploring the T2's communication, we reverse engineered Apple's proprietary XPC protocol, which previously had near-zero third-party documentation. In addition to decoding the messaging format, we demonstrate the ability to interface directly with the T2 chip from unprivileged userspace code by writing our own client application. Our talk will present methods and tooling to query the T2's exposed services as well as decode and encode valid messages.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Davidov-Inside-The-Apple-T2.pdf)
### Making Big Things Better the Dead Cow Way
Trying to change the security culture of a single company can be daunting. The Cult of the Dead Cow managed to change the culture of the entire security industry.In this session, three key figures from the 35-year-old group's history — Mudge Zatko, Chris Rioux, and Deth Vegetable — will discuss the cDc's evolution from teenage misfits into industry leaders, its many contributions, and the enduring lessons for other hackers out to make a difference. They will be questioned by Joseph Menn, author of "Cult of the Dead Cow: How the Original Hacking Supergroup Might Just Save the World," published June 4. Appearing for the first time under his real name, cDc Minister of Propaganda Deth Veggie will discuss the group's formative years and how he engaged with the media for fame and infamy.After achieving notoriety, the Cult of the Dead Cow added tech luminaries like Zatko and Rioux and pushed the industry forward in a series of remarkable jumps. The release of Rioux's Back Orifice 2000 in 1999 forced Microsoft to grapple with unhappy business customers and hire hackers as security consultants, including those from Zatko and Rioux's @stake.Zatko went on to lead cybersecurity grantmaking at the Defense Advanced Research Projects Agency, the people who brought you the internet. Rioux co-founded Veracode, which dramatically improved code review by major software buyers. And Veggie continued as an internal leader at cDc, keeping the conversation moving forward in the politically charged areas of hacktivism, WikiLeaks, the hacker part of the #MeToo uprising, neo-Nazis, and the presidential candidacy of cDc alumnus Beto O'Rourke.
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Menn-Making-Big-Things-Better-The-Dead-Cow-Way-wp.pdf)
### Critical Zero Days Remotely Compromise the Most Popular Real-Time OS
VxWorks is the most popular operating system you have never heard about. It is a real-time operating system, used by over 2 billion devices of all kinds - from airplanes to MRI machines, from firewalls to industrial control systems, and even by SpaceX’s Dragon Spacecraft. It is pervasive and trusted. But like many systems we have come to rely on, its security can break given a single vulnerability. Our talk will reveal 11 such zero-day vulnerabilities we’ve discovered in VxWorks.Even though VxWorks is probably the oldest real-time OS still maintained, only 13 CVEs are listed by MITRE as affecting it in its 32 years of existence, making it an intriguing target for research. Due to its uncharted nature, we were able to find unusually low-level vulnerabilities affecting every VxWorks version released in the last 13 years. The vulnerabilities reside in the TCP/IP stack used by VxWorks, called IPNET, 6 of which are classified critical RCEs, and have a staggering potential. By exploiting them, attackers can bypass traditional security measures and take control over any VxWorks device with a network connection, without any user interaction.In our talk, we will demo the exploitation of these vulnerabilities on several devices and demonstrate their dangerous aptitude. We will show how they can be used to breach a network safely secured behind a NAT and a firewall through a normal TCP connection between a printer and its Cloud, as well as the life-threatening effect of pwning sensitive devices running VxWorks, such as a hospital bedside patient monitor.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Seri-Critical-Zero-Days-Remotely-Compromise-The-Most-Popular-Real-Time-OS.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Seri-Critical-Zero-Days-Remotely-Compromise-The-Most-Popular-Real-Time-OS-wp.pdf)
### Fantastic Red-Team Attacks and How to Find Them
Red team testing in organizations over the last year has shown a dramatic increase in detections mapped to MITRE ATT&CK™ across Windows, Linux and macOS. However, many organizations continue to miss several key techniques that, unsurprisingly, often blend in with day-to-day user operations. One example includes Trusted Developer Utilities which can be readily available on standard user endpoints, not just developer workstations, and such applications allow for code execution. Also, XSL Script processing can be used as an attack vector as there are a number of trusted utilities that can consume and execute scripts via XSL. And finally, in addition to these techniques, trusted .NET default binaries are known to allow unauthorized execution as well, these include tools like InstallUtil, Regsvcs and AddInProcess. Specific techniques, coupled with procedural difficulties within a team, such as alert fatigue and lack of understanding with environmental norms, make reliable detection of these events near impossible.This talk summarizes prevalent and ongoing gaps across organizations uncovered by testing their defenses against a broad spectrum of attacks via Atomic Red Team. Many of these adversary behaviors are not atomic, but span multiple events in an event stream that may be arbitrarily and inconsistently separated in time by nuisance events. Additionally, we introduce and demonstrate the open-sourced Event Query Language for creating high signal-to-noise analytics that close these prevalent behavioral gaps. EQL is event agnostic and can be used to craft analytics that readily link evidence across long sequences of log data. In a live demonstration, we showcase powerful but easy to craft analytics that catch adversarial behavior most commonly missed in organizations today.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Smith-Fantastic-Red-Team-Attacks-And-How-To-Find-Them.pdf)
### Towards Discovering Remote Code Execution Vulnerabilities in Apple FaceTime
Zero-click or one-click remote exploits targeting Apple FaceTime or iMessage attract increasing attention, but neither real world vulnerabilities nor the attack surfaces in such targets were fully studied and analyzed in the past. In this talk, we will share reverse engineering results of FaceTime, with a focus on the process of the initialization and connection of a FaceTime call. Along with the attacker-controlled data propagation path, we will discuss different attack surfaces for FaceTime. In particular, besides trivial denial of service issues, we will describe a number of vulnerabilities in FaceTime (and other relevant components), including memory corruption flaws such as heap and stack overflow and out-of-bounds read issues, and develop and demonstrate PoC exploits that can lead to a fully-controlled Objective C ISA pointer or program counter (PC) in FaceTime, affecting both Mac OS and iOS.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Huang-Towards-Discovering-Remote-Code-Execution-Vulnerabilities-In-Apple-FaceTime.pdf)
### Backdooring Hardware Devices by Injecting Malicious Payloads on Microcontrollers
Throughout the years, many studies have been published addressing different ways of backdooring devices by leveraging on their own hardware components. However, most of the existing work focuses on backdooring devices based on powerful microprocessors – such as ARM, Intel or AMD – instead of microcontrollers.Is targeting microcontrollers worth the effort? Nowadays, they are responsible for controlling a wide range of interesting systems, e.g., physical security systems, car's ECUs, semaphores, elevators, sensors, critical components of industrial systems, some home appliances and even robots.In this talk, it will be explained how microcontrollers can be backdoored too. After a quick review of basic knowledge about uC, we will dive into three different approaches to achieve payload injection, from basic to advanced techniques. The first method consists of locating the entry point of the firmware and inject our payload there, this is an easy way to execute it at least once. As a second, and more complex technique, we will backdoor the EUSART communication injecting a malicious payload at the code routine of that hardware peripheral; we will be able to get the right memory address by inspecting the GIE, PEIE and polling process at the uC interrupt vector. Finally, the third technique allow us to take control of the microcontroller's program flow by manipulating the stack writing memory addresses at the TOS; with this we can execute a payload made with instructions already written in the original program, performing it just like a ROP-chain technique.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Berta-Backdooring-Hardware-Devices-By-Injecting-Malicious-Payloads-On-Microcontrollers.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Berta-Backdooring-Hardware-Devices-By-Injecting-Malicious-Payloads-On-Microcontrollers-wp.pdf)
### Securing the System: A Deep Dive into Reversing Android Pre-Installed Apps
The Android security community has been predominantly focused on user-space applications for many years. However, there is a distribution mechanism for security issues that affects more unknowing users, generally allows more privileges, and is tougher to remediate once launched: problems in pre-installed applications. With thousands of OEMs and even more firmware images, the Android pre-installed ecosystem is a big space to both audit and secure. This talk will detail the differences in reversing and analyzing pre-installed Android applications compared to the user-space applications that most security research has focused on. This will include things like identifying when a pre-installed application is unlikely to run in an emulator without modification, detecting signals that the pre-installed app may be colluding with other components and be only one piece of the puzzle, and how bad behaviors can change when they instead are run in the more privileged context of a pre-installed application. We will then dive into case-studies of Android pre-installed security issues we discovered in 2018 & 2019: malware, security misconfigurations, and remote code execution backdoor. We will walk through the code and reverse engineering process. In addition, we'll cover detection and remediation for each and how it differs from a user-space application. This talk will be a detailed tour through the Android pre-installed ecosystem: the analysis challenges and how to get around them and the interesting security issues one might uncover.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Stone-Securing-The-System-A-Deep-Dive-Into-Reversing-Android-Preinstalled-Apps.pdf)
### Hacking Ten Million Useful Idiots: Online Propaganda as a Socio-Technical Security Project
Online propaganda and election influence have received much attention recently. Defense leaders and the general public are aware of the risks, but have little understanding of the techniques involved, nor relevant technical details of social networks. The cybersecurity community has a ready understanding of the protocols, services, etc. of a tech platform, but less understanding of how these networks affect society and politics collectively. There is now a thriving field of computational social science that studies how social networks and other digital media affect society, but the field does not generally address the topic as a security question—let alone a defense problem. Here we will present an integrated view of Socio-Technical Systems (STS) amenable to application of security principles. Applying this novel approach requires unification of three skill sets: data science, psychology, and security thinking, which are not commonly found together. An STS consists of a social network, the human population that uses it, and an output system where effects are targeted, such as a political system or economic market. By combining analytical techniques from political or market economics, voting theory, etc. with the ML models that run tech platforms, an entire STS could be modeled as a single system. While tech platforms are already skilled at predicting individual behaviors for marketing purposes, enhanced models could enable the development of improved monitoring systems for hostile campaigns of political or financial influence. We will also provide examples of what a red team/blue team process could look like in the context of STS security, and walk through some examples of red-team analysis of influence operations.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Perlman-Hacking-Ten-Million-Useful-Idiots-Online-Propaganda-As-A-Socio-Technical-Security-Project.pdf)
### The Discovery of a Government Malware and an Unexpected Spy Scandal
In early 2019, we revealed the existence of a new intrusion software built and primarily used in Italy by the authorities. The company that created this software managed to stay under the radar for several years, until we identified their Android mobile surveillance product, dubbed “Exodus.”Exodus is a spyware equipped with extensive collection capabilities, able to turn a phone into a faithful surveillance companion—and distributed openly on the Google Play store. At the same time, it has some significant problems, both at the code level, and how it was deployed in the wild, accumulating hundreds of infections. Little did we know, this was only going to be the tip of an iceberg that went deeper and darker than we expected—a major spy scandal in the heart of Europe.The “Exodus” scandal is a poster boy for the sorry, dangerous state of the spyware industry, also known as the “lawful intercept” industry. Due to the growing ubiquity of encryption on online services and communication systems, traditional passive wiretapping is becoming increasingly ineffective and collecting data off of the devices directly has become the new frontier of surveillance. The so-called “lawful intercept” industry is worth $12 billions, according to Moodys. NSO Group, one of the market leaders, employs 600 people, and has more than 40 customers all over the world.How did we get here?In this talk, we’ll delve into the case study of eSurv, a small Italian government contractor that was providing spyware all over Italy. From there, we’ll go back in time and draw the history of lawful intercept. From the 90s, where it was all Windows Trojans and some Symbian RATs, to the 2000s with the first professionalized boutique companies that made spyware for police and intelligence agencies all over the world. Finally, we’ll look at the present, where several companies battle to control a global unregulated market outside of the Five Eyes.This is spaghetti, pizza, and spyware, a talk with the full spicy backstory of a threat intel and journalistic investigation.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Franceschi-Bicchierai-The-Discovery-Of-A-Government-Malware-And-An-Unexpected-Spy-Scandal.pdf)
### Attacking iPhone XS Max
With the release of iPhone XS and XS Max, Apple's implementation of Pointer Authentication Code (PAC) on the A12 SoC comes more into play for exploit mitigations. While PAC effectively makes many of our own kernel vulnerabilities unexploitable on iPhone XS/XS Max, we were able to achieve tethered jailbreaks on iPhone XS/XS Max. This talk will describe this process. Specifically, this talk will first discuss Apple's PAC implementation based on our tests, introduce an ancient bug in the XNU that is still affecting the latest official release of iOS (i.e. 12.1.4), and then elaborate how to exploit it to bypass PAC and gain arbitrary kernel read/write. Finally, this talk will explain post exploitation techniques including how to make arbitrary kernel function call based on arbitrary kernel read/write.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Wang-Attacking-IPhone-XS-Max.pdf)
### Everybody be Cool, This is a Robbery!
HSMs (Hardware Security Modules) bring cryptographic mechanisms to environments where the highest level of security is required. As an example, HSMs are widely used by cryptocurrency exchanges to secure crypto assets, by banks to protect cryptographic keys and customer PINs, and by telecommunications operators to manage SIM secrets. Basically, HSMs generate, store and protect cryptographic keys and rely on software and hardware mechanisms to prevent secrets from being stolen.This highly technical presentation targets an HSM manufactured by a vendor whose solutions are usually found in major banks and large cloud service providers. It will demonstrate several attack paths, some of them allowing unauthenticated attackers to take full control of the HSM. The presented attacks allow retrieving all HSM secrets remotely, including cryptographic keys and administrator credentials. Finally, we exploit a cryptographic bug in the firmware signature verification to upload a modified firmware to the HSM. This firmware includes a persistent backdoor that survives a firmware update.Every vulnerability found has been responsibly disclosed to the manufacturer, who published firmware updates with security fixes. We eventually show how it's possible to drastically reduce the attack surface by developing a custom module which prevents almost all vulnerabilities found from being exploited.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Campana-Everybody-Be-Cool-This-Is-A-Robbery.pdf)
### The Future of ATO
Account Takeover (ATO) is the silent killer of online security. Between password megalists, massive PII breaches and ever more sophisticated attackers, it's becoming almost impossible to help regular users to thread the needle of a usable, but secure, experience. Coinbase is one of, if not the, largest single store of consumer cryptocurrency in the world. Attackers have enormous motivation to target our customers, and we have enormous motivation to defend our customers. This has resulted in a flurry of innovation over the past few years, on both sides. In this talk, I'll give a look behind the scenes on how Coinbase protects our customers, encourages them to be more secure and handles everything from phone porting to SIM swapping to credential stuffing. I'll also share a view into where we see attackers actively innovating. You will walk away with a window into what ATO may look like in the years to come and some specific, actionable steps you can take to protect your customers right now.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Martin-The-Future-Of-ATO.pdf)
### Securing Apps in the Open-By-Default Cloud
Services created in cloud environments like GCP or AWS are open to the internet by default. This is a problem that compounds in a workplace where developers are empowered to create new microservices faster than a security team can review them. Even if all of these services could be reviewed before launch it is infeasible for security teams to track and review all security-impacting code changes, often leading to improper auth controls and exposed services.

We present a generalizable solution which automatically enforces auth controls for all services throughout their development lifecycle. Our solution is designed to require minimal operational overhead for the development and security teams and holds no opinions about the project's development process, allowing development teams to maintain their autonomy.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Howes-Securing-Apps-In-The-Open-By-Default-Cloud.pdf)
### Adventures in the Underland: The CQForensic Toolkit as a Unique Weapon Against Hackers
Best practices come out when true experts’ experience meets the power of science! Let’s face it: hackers’ creativity has no end. What is more, people, the most valuable resource, are not always aware of the level of security in their companies, possible points of entry, how operating systems are attacked, and how to protect the infrastructure from successful attacks which are, in some cases, triggered by configuration mistakes. The secure infrastructure configuration should be the most important line of defense in every organization. Although hackers often win the race, your OS is not defenseless!This session is based on CQTools; several of them are the result of discoveries made by CQURE Team! Some took years to be completed, and all of those work in a straightforward manner. CQTools is the ultimate toolkit to have when delivering penetration tests – the tools work simply, and we use them in practice during our cybersecurity projects. Furthermore, Paula and CQURE Team made a DPAPI world discovery where they have reverse-engineered this mechanism to tell you at the moment how it works and if it is safe. During the session, participants could also hear about 2 great discoveries CQURE made. First is about how to decrypt DPAPI protected data by leveraging usage of the private key stored as a LSA Secret on a domain controller. The second discovery is a great way to find the way how to decrypt SID-protected PFX files even without access to user's password but just by generating the SID and user's token. Attendees become familiar with completely unique CQForensic toolkit which can build an attack timeline, extract information from the USN journal, recover files, also from MFT, decrypt user's and system's stored secrets, like encrypted data, extract information from Prefetch and from Remote Desktop Session cache, extract information from the configuration of the used for administration tools.Beware: extremely technical and detailed session!
### A Compendium of Container Escapes
Containers are a hot topic because of the simplicity they bring to the process of software development, shipping, and deployment. They are insanely useful for eliminating environmental constraints such as library version conflicts, and for the overall organization and hygiene of software. Containers also provide some security properties, including version management, an expression of intent, and often reduced attack surface. However, it is important to understand that although the organizational isolation of containers is what enables these security properties, isolation itself is not a security property of containers.As such, it becomes important to understand the security properties of containers, how they have been escaped in the past, and how they are likely to be escaped in the future. This year kicked off with a container escape vulnerability in runc, used by various container engines, which seemed to come as a shock for many users of containers. The goal of this talk is to broaden the awareness of the how and why container escapes work, starting from a brief intro to what makes a process a container, and then spanning the gamut of escape techniques, covering exposed orchestrators, access to the Docker socket, exposed mount points, /proc, all the way down to overwriting/exploiting the kernel structures to leave the confines of the container.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Edwards-Compendium-Of-Container-Escapes-up.pdf)
### HostSplit: Exploitable Antipatterns in Unicode Normalization
This talk demonstrates new exploit techniques that leverage Unicode normalization behavior to bypass URL security filters and, in some cases, allow one domain to impersonate another. Where previous attacks against internationalized domain names relied on visual spoofing, these attacks fool software with URL strings that are parsed as belonging to one hostname but resolved as belonging to a different host name.The vulnerabilities that enable these attacks are widespread, because they result from practical compromises in implementing IDNA standards. The author of this talk identified several new CVE's which will be discussed, including vulnerabilities in Edge/IE, .NET, Python, Java, Office 365, and Gmail. A more general exploit pattern against OAuth is also explained.Although some platform-level problems have already been corrected, many of the fixes for these vulnerabilities will need to be made at an application level. It is likely that there are still many software packages with Unicode normalization vulnerabilities of this type. This talk discusses methods to test for these vulnerabilities as well as coding and design best practices for preventing them.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization-wp.pdf)
### Command Injection in F5 iRules
BigIP F5 products are used by large corporations and governments all around the world. Its performance and load sharing capabilities has made it a preferred choice as reverse proxy to route web traffic in complex high performance projects. The F5 product contains a subset of rules written in a language called iRules developed from the scripting language TCL. TCL language interpretation is defined in a set of rules called the dodekalogue. Common misinterpretations of the dodekalogue often leaves iRules exposed to security vulnerabilities. An attacker can inject iRule code in to a request and force the load balancer to execute remote code, sniff connections or scan internal networks. Organizations using F5 with iRules will be made aware of how to find and avoid writing vulnerable code along with a demonstration of the consequences of post exploitation of this vulnerability. An attacker that successfully exploits iRule injections can gain a foothold in the F5 device memory, break out of the TCL interpreter and cause severe damage without leaving a trace in logging facilities. The research includes code scanning and automatic exploitation tools to detect and eliminate the iRule injection vulnerability from a running F5 instance.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Jerkeby-Command-Injection-In-Irules-Loadbalancer-Scripts.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Jerkeby-Command-Injection-In-Irules-Loadbalancer-Scripts-wp.pdf)
### Breaking Samsung's ARM TrustZone
The increasing popularity of connected devices in recent years has led manufacturers to put a greater emphasis on security, finding themselves in need of robust designs that would protect their users. From these requirements emerged the ARM TrustZone, a system-wide hardware isolation technology. It introduces a trusted Secure World that can process code and data while ensuring their integrity and confidentiality. This Secure World can also watch over the user-controlled (and therefore untrusted) Normal World to verify its integrity, similarly to the mechanism implemented in Samsung's TIMA.It can also access hardware peripherals, such as keyboards, screens, or crypto-processors in a secure and isolated manner to create trusted UIs, implement DRMs, etc. All the sensitive data and the critical interruptions are directly handled by the Secure World without ever passing through the Normal World.However, the usage of this technology comes at a cost. By widening the attack surface and exposing privileged components, TrustZone can potentially introduce a single point of failure that allows the compromission of the entire system. Using Samsung's TrustZone implementation as a target, this presentation explains and demonstrates how this new attack surface can be leveraged to hijack and exploit trusted components. After explaining the internals and interactions of these components developed by Samsung, different vulnerabilities will be detailed and exploited to execute code at EL3, the highest privilege level on an ARM-based system.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Peterlin-Breaking-Samsungs-ARM-TrustZone.pdf)
### Lessons and Lulz: The 5th Annual Black Hat USA NOC Report
Back with another year of soul crushing statistics, the Black Hat NOC team will be sharing all of the data that keeps us equally puzzled, and entertained, year after year. We'll let you know all the tools and techniques we're using to set up, stabilize, and secure the network, and what changes we've made over the past year to try and keep doing things better. Of course, we'll be sharing some of the more humorous network activity and what it helps us learn about the way security professionals conduct themselves on an open WiFi network. Spoiler Alert: It's poorly. We conduct ourselves poorly.
### Exploring the New World : Remote Exploitation of SQLite and Curl
Over the past years, our team has used several new approaches to identify multiple critical vulnerabilities in SQLite and Curl, two of the most widely used basic software libraries. These two sets of vulnerabilities, which we named "Magellan" and "Dias" respectively, affect many devices and software. We exploited these vulnerabilities to break into some of the most popular Internet of things devices (including Google Home with Chrome), one of the most widely used Web server (Apache+PHP) and one of the most commonly used developer tool (Git). In this presentation, we will share new methods to discover vulnerabilities in SQLite and Curl through Fuzz and manual auditing. Through these methods, we found "Magellan", a set of three heap buffer overflow and heap data disclosure vulnerabilities in SQLite ( CVE-2018-20346, CVE-2018-20505 CVE-2018-20506 ) We also found "Dias", two remote memory leak and stack buffer overflow vulnerabilities in Curl ( CVE-2018-16890 and CVE-2019-3822 ). Considering the fact that these vulnerabilities affect many systems and software, we have issued a vulnerability alert to notify the vulnerable vendor to fix it.We will disclose the details of "Magellan" and "Dias" for the first time and highlight some of our new vulnerability exploitation techniques. In the first part, we will analyze how to use Magellan to complete the first public remote exploit of Google Home. In the second part, we will talk about how to use Dias to complete the remote attack on Apache+PHP and Git. Finally, we will summarize our research and provide some security development advice to the basic software library developers.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Qian-Exploring-The-New-World-Remote-Exploitation-Of-SQLite-And-Curl.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Qian-Exploring-The-New-World-Remote-Exploitation-Of-SQLite-And-Curl-wp.pdf)
### How to Detect that Your Domains are Being Abused for Phishing by Using DNS
As a high-profile public-sector organization, the Dutch Tax and Customs Administration deals with criminals claiming to be representatives of the organization and contacting the public with phishing e-mails every day. By using RFC's like, RFC7208 – Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, we have developed a technique to identify phishing attacks that are carried out under the disguise of the Dutch Tax and Customs Administration. This technique is universally applicable. A precondition is access to the DNS logging. By means of this technique, insight can be obtained where the phishing e-mails are sent from and to whom the phishing e-mails are sent. In this talk we will start by explaining which standards are available to increase e-mail security. We will briefly discuss protocols such as: STARTTLS, SPF, DKIM, DMARC, DANE and MTA-STS. We also discuss advanced SPF options. Finally, we will link all of those protocols to detect if our domains are being abused for phishing attacks. The framework we have developed gives you more insight in phishing attacks conducted under the disguise of your organization's name. We firmly believe that if these techniques are used everywhere, it would lead to a significant decrease of phishing e-mails.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Hoelzel-How-To-Detect-That-Your-Domains-Are-Being-Abused-For-Phishing-By-Using-DNS.pdf)
### Debug for Bug: Crack and Hack Apple Core by Itself - Fun and Profit to Debug and Fuzz Apple Kernel by lldb Script
As we know for security researchers, almost every operation system vendor has highly raised the bar of security vulnerability credit or bonus criteria and lots of security mitigations such CFI on Android 9 or PAC based on hardware on iOS 12 have been integrated to vendor system.What is more, industrial standard fuzzers (typical as AFL, syzkaller based on code coverage feedback) have been deployed on large scale. The survival space of bug hunting left for security researchers seems to be much smaller. Code reviewing based on threat expert knowledge seems to be the only way but which is obvious time consuming and dummy effort.Any idea on how to break the deadlock now? As security researchers, maybe you could try our debug fuzzer for bug hunt. This method we pledged has been verified to be effective to find and expand new attack interface but also flexible, scalable and scriptable for vulnerability research utilities. Based on our fuzzing methodology, we found dozens of vulnerabilities, including double free, oob read/write etc. which we will provide a detailed analysis of. However, these 10 vulnerabilities is the only part of we found, others will be analyzed later and submitted to Apple.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Lilang-Debug-For-Bug-Crack-And-Hack-Apple-Core-By-Itself-Fun-And-Profit-To-Debug-And-Fuzz-Apple-Kernel-By-LLDB-Script.pdf)
### Shifting Knowledge Left: Keeping up with Modern Application Security
With security "shifting left" into DevSecOps, it's more difficult than ever to keep up with a rapidly evolving landscape of web technologies and the threats that come with them. While familiar vulnerability classes continue to plague our apps with the likes of XSS and SQL injection attacks, many frameworks are adopting automatic defences that protect against common abuse cases. At the same time, as the work of developers is abstracted away from these security decisions, remaining points of failure can more easily go overlooked.

To keep our applications secure in a world where developers own deployments and commit production code many times a day, we need every software engineer to be well versed and up to date in secure coding techniques relevant to their particular language and framework. Education in application security is hard, and the days of passive compliance-based training through outdated videos and slideshows can't keep up. Meanwhile, traditional cybersecurity has little to do with modern appsec, and security teams are often seen by developers as a punitive function and (un)necessary evil.

Beyond relying on slow-to-update measures like the OWASP Top 10 to guide us, we must find better ways to share appsec knowledge, both within teams and across the industry. To this end, Duo and Hunter2 have partnered to bring a set of free training resources that can be shared among development teams, including interactive training labs that allow engineers to practice exploiting and patching up modern web applications in their stack of choice. We are also opening this platform up to the community, so that attendees can publish their own labs demonstrating specific vulnerability and remediation examples as well.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Stanislav-Shifting-Knowledge-Left-Keeping-Up-With-Modern-Application-Security.pdf)
### Moving from Hacking IoT Gadgets to Breaking into One of Europe&#39;s Highest Hotel Suites
We're taking Bluetooth LE hacking from toys and padlocks to the real world. Improving the tools and methods we used in previous research to break the AES cryptography of the NOKE Padlock, we went to do the one thing a mobile hotel key is supposed to prevent: wirelessly sniff someone entering his room - or just unlocking the elevator - and then reconstruct the needed data to open the door with any BTLE enabled PC or even a raspberry pi.

In this talk we will show and explain the tools and methods we used and developed to break the BTLE based mobile phone key system of a large hotel chain. And then come from the academic proof of concept to a reliable setup that can be used in real life scenarios to carry out the attack.

Methods shown will cover the reverse engineering of the wireless protocol based on BTLE captures, analyzing the decompiled mobile phone app and intercepting the TLS encrypted traffic to the back end API, which in combination led to the compromise of the system.
- [slide](https://i.blackhat.com/USA-19/Thursday/us-19-Ray-Moving-From-Hacking-IoT-Gadgets-To-Breaking-Into-One-Of-Europes-Highest-Hotel-Suites.pdf)
### Paging All Windows Geeks – Finding Evil in Windows 10 Compressed Memory
FireEye's FLARE team analyzed the Windows 10 memory compression implementation to enable access to data in the newly introduced (and undocumented) virtual store. This closes the door to malware evading detection during memory forensic analysis. We open source and present this work to help advance the state of the art in computer forensics.Traditionally, a complete Windows memory inspection only required forensic tools to parse physical memory and fill in any missing gaps from the page file. Each page in memory, whether it resided in physical memory or the pagefile, could be inspected by simply viewing the contents. The deployment of the virtual store has upended this well-understood paradigm by introducing compressed pages. To inspect pages in the virtual store, the analysis tools must be able to identify which pages are compressed, locate and decompress the contents for inspection. The results of the research are open-sourced in the form of Volatility and Rekall plugins to benefit IR investigators and forensicators.This presentation focuses on the details of the memory compression implementation in Windows 10, and explores the undocumented structures and algorithms involved in the process. The information in this presentation will enable the community to support new Windows 10 builds in their forensic tools of choice. The FLARE team is releasing a tool to automate the process of structure extraction on new Windows builds. The tool leverages the FLARE-EMU emulation framework to automatically generate the undocumented structures.
- [slide](http://i.blackhat.com/USA-19/Thursday/us-19-Sardar-Paging-All-Windows-Geeks-Finding-Evil-In-Windows-10-Compressed-Memory.pdf)
- [whitepaper](http://i.blackhat.com/USA-19/Thursday/us-19-Sardar-Paging-All-Windows-Geeks-Finding-Evil-In-Windows-10-Compressed-Memory-wp.pdf)