## BlackHat 2020
### Hacking Government Cybersecurity
This session delivered by Pete Cooper, the Deputy Director for Cyber Defence at the Cabinet Office will focus on his perspectives and the latest developments in cyber security across government and beyond. From understanding and managing risk at government scale, to collaborating with industry partners and the hacker community, this session will explore how we can view and work through our cyber challenges to reduce risks to our societies.  As hostile actors seek to exploit the COVID-19 pandemic for their strategic advantage, confidence in the security of our digital lives becomes ever more important. Pete will talk about cyber security across government and utilising his diverse military, private sector and government background to drive cutting edge thinking, collaboration and change.
### It&#39;s not FINished: The Evolving Maturity in Ransomware Operations
Ransom demands are becoming larger, attackers smarter, and intrusions longer. Ransomware threat actors are hitting European companies hard with more effective ransomware deployment resulting in devastating impacts to victim organisations. When they strike, their ransomware deployments are more complete, more effective, and they are crippling many organisations to the point where there is often no clear path back to business.We will be sharing tradecraft we've seen ransomware threat actors employ across Europe in 2020. We cover how we're seeing ransomware crews leverage high-profile critical vulnerabilities to gain footholds in as many victims networks as possible, only to come back weeks or even months later to leverage those footholds into full-scale ransomware deployments.Not only are intrusion tactics improving, but attackers are also transitioning and developing sleek ransomware-as-a-service platforms. Threat actors are professionalising and streamlining their platforms. These platforms are being used by threat actors to generate malware, to communicate and negotiate with victims, and in some cases, for payment processing and decryption utility delivery.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Wednesday/eu-20-Clarke-Its-Not-FINished-The-Evolving-Maturity-In-Ransomware-Operations-wp.pdf)
### Shield with Hole: New Security Mitigation Helps Us Escape Chrome Sandbox to Exfiltrate User Privacy
More security mitigations always mean securer software and more exploit cost. Chrome browser keeps introducing all kinds of security mitigation measures such as multi-process architecture[1], sandbox and CORS, which help Chrome become one of the securest browsers all over the world.  

However, we find that some mitigation won't make software safer but even introduce new vulnerabilities. Recently, network stack can be set out of 'Chrome browser process', running as a separate process called 'Network service'. And a new mitigation named 'OutOfBlinkCors'[2] (aka OOR-CORS) has landed in 'Network service'. We find that the Same-Origin policy will be broken if 'OutOfBlinkCors' is enabled on Chrome for Android. After a period of deep research, we succeed in developing a full exploit chain with six bugs/features to escape Chrome Sandbox to exfiltrate user privacy, such as personal pictures, private documents, and even clear text account credentials(username and password) of Google, Facebook and other third-party websites. And our exploit chain can be triggered inside Chrome Sandbox remotely,  once the link in SMS, Email or websites is clicked. Besides Chrome for Android, Android webview is also vulnerable to the above bugs. We will choose one app called 'Wish' as a demo to show the attack effects.

The process of our research is very interesting. Originally, our exploit chain works well on version 81 of Chrome for Android. But the chain is broken because of a fix of version 83. Finally, we come up with an interesting exploit skill to bypass it with the help of a pre-installed app in Pixel device, we name the exploit skill as 'reflection attack'. In this talk, we will detail the full exploit chain and analyze the Root-Cause of bugs in the chain. We will also demystify the trick which we have used to bypass the Scoped-Storage[3] enforcing, which is a mitigation measure introduced in Android 10. Besides, we will explain how we can escape Chrome Sandbox to carry out the attack. The bug chain has been reported to Google, assigned as 'Critical' severity, which is the most serious level in Chrome Vulnerability Reward Program.

In short, security mitigations are designed to help protect against vulnerabilities, but it can introduce new vulnerabilities if implemented carelessly. To developers, more attention should be paid to avoid negative effects when introducing new mitigations. To security researchers, new mitigations could be good targets for bug hunting.

References:
[1] https://developers.google.com/web/updates/2018/09/inside-browser-part1
[2] https://www.chromestatus.com/feature/5768642492891136
[3] https://developer.android.com/about/versions/10/privacy/changes#scoped-storage
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Wang-Shield-With-Hole-New-Security-Mitigation-Helps-Us-Escape-Chrome-Sandbox-To-Exfiltrate-User-Privacy.pdf)
### Jack-in-the-Cache: A New Code injection Technique through Modifying X86-to-ARM Translation Cache
Recently, the adoption of ARM processors for laptop computers is becoming popular due to its high energy efficiency. Windows 10 on ARM is a new OS for such ARM-based computers. Several laptop computers with this OS have already been shipped; notably, the recent launch of Microsoft Surface Pro X will be a driving force to facilitate the widespread use of Windows 10 on ARM.You might think that there are new threats to such a new OS. Yes! We found such a threat.In this talk, we present a new code injection technique to abuse a novel feature of Windows 10 on ARM: X86 emulation.Remarkably, Windows 10 on ARM can run X86 apps via the X86 emulation feature that translates binary from X86-to-ARM just in time. To reduce the performance overhead of JIT binary translation, the OS has the mechanism to cache already-translated results as X86-to-ARM (XTA) cache files.Our new code injection technique is performed by modifying this XTA cache file. Since this technique is difficult to detect and trace, appropriate countermeasures are necessary. Moreover, this technique can be used as an API hooking invisible to an X86 process. Therefore, this technique has already been a threat to Windows 10 on ARM.We believe that future OSs have a JIT translation mechanism at the processor transition. For example, Apple has recently announced Rosetta 2, which is a similar mechanism for introducing their own ARM-based chip. For these OSs, the caching of already-translated results as files is a reasonable way to decrease performance overhead.Our new code injection technique might also apply to such OSs.This presentation becomes a beneficial advisory for the developers of such future OSs, not limited to Windows 10 on ARM. PoC code of our new code injection technique and analysis results of the X86 emulation will be public on GitHub after this talk.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Nakagawa-Jack-In-The-Cache-A-New-Code-Injection-Technique-Through-Modifying-X86-To-Arm-Translation-Cache.pdf)
### Finding Bugs Compiler Knows but Doesn&#39;t Tell You: Dissecting Undefined Behavior Optimizations in LLVM
"Undefined Behavior", like signed integer overflow or accessing null pointer, is an erroneous action that makes programs unpredictable. There are no rules on how to generate code for "Undefined Behavior." Compiler writers can treat "Undefined Behavior" as "nasal demons" and do anything they choose.We try to figure out how LLVM optimizes "Undefined Behavior" by digging into LLVM internals. We find most of "Undefined Behavior" can be recognized by compilers. But compilers prefer to optimize out "Undefined Behavior" rather than throw a warning. It may make "Undefined Behavior" bugs hide in the programs or even make bugs more powerful during optimizations.We developed tools to look for the hidden "Undefined Behavior" bugs. We scanned Chrome and Android AOSP and found several security bugs. One of them is originally a negligible "Null pointer deference" bug in chrome, which, however, can be used to compromise Chrome renderer. In this talk, we will share our exploitation techniques.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Wu-Finding-Bugs-Compiler-Knows-But-Does-Not-Tell-You-Dissecting-Undefined-Behavior-Optimizations-In-LLVM.pdf)
### The Subtle Art of Chaining Headers  - IKEv2 Attack Surface Case Study
Internet Key Exchange (IKE) is a significant component of IP Security (IPsec), a suite of protocols used extensively for creating Virtual Private Networks. IKE is used for performing mutual authentication, establishing and maintaining the required Security Associations. IKE is of a particular interest in the context of IPSec since a part of it is neither encrypted, nor authenticated and hence, it constitutes the only attack surface for unauthenticated attackers. This paper provides a network protocol analysis of the attack surface of the latest version of the protocol, IKE version 2 (IKEv2). By diving into the corresponding specifications, the main points of interest are identified and attacking opportunities are discussed. As it will be shown, despite IKEv2 has considerably been simplified in comparison with IKEv1, the format of its messages can vary multifariously, mainly due to the different types and number of payloads that can be incorporated. This complexity has already resulted in several known vulnerabilities.  An open-source tool, authored especially for implementing the identified attack opportunities, is used to describe and test the described scenarios.  By using this tool in combination with the described attack scenarios, potential flaws on IKEv2 implementations can be identified and hence, have them fixed before they are exploited in the wild.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Atlasis-The-Subtle-Art-Of-Chaining-Headers-IKEv2-Case-Study.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Wednesday/eu-20-Atlasis-The-Subtle-Art-Of-Chaining-Headers-IKEv2-Case-Study-wp.pdf)
### Graph Convolutional Network-Based Suspicious Communication Pair Estimation for Industrial Control Systems
Whitelisting is considered an effective security monitoring method for networks used in industrial control systems, where the whitelists consist of observed tuples of the IP address of the server, the TCP/UDP port number, and IP address of the client (communication triplets). However, this method causes frequent false detections. 

To reduce false positives due to a simple whitelist-based judgment, we propose a new framework for scoring communications to judge whether the communications not present in whitelists are normal or anomalous.

To solve this problem, we developed a graph convolutional network-based suspicious communication pair estimation (GCN SCOPE) using relational graph convolution networks, which are learning based methods that operate on graph domain, and evaluate the performance of this method, and evaluated its performance. 
　　
For this, we collected the network traffic of three factories owned by Panasonic Corporation, Japan.  Each factory produces different items, and the installed facilities, communication protocols,  and network configurations are completely different depending on the factories. 

The proposed method achieved a receiver operating characteristic area under the curve of 0.957, which outperforms baseline approaches such as DistMult, a method that directly optimizes the node embeddings, and heuristics, which score the triplets using first- and second-order proximities of multigraphs. This method enables security operators to concentrate on significant alerts.
### A New Hope: The One Last Chance to Save Your SSD Data
There are some reasons why vendors keep their details of controller and flash chip information confidential. One of the reasons is that their unique management techniques are deployed differently, that is relevant to SSD capacity and speed, such as TRIM, Garbage Collection, and Wear Leveling are preserved code on flash. Despite these techniques being used by vendors, we show that SSD do not erase all the stored physical data because it might wear lifespan sooner.We figured out that SSD still leaves sensitive data when overwritten to the same logical block, so they do not overwrite to fixed physical block, they only grab other empty physical block and write over that, so they leave the erased data. For these analyses, we perform extract the Nand chip data with only internal controller PBA manipulation because logical block address cannot be used anymore in normal. In the case of SSD used to crypto engine built into the SSD's controller encrypt every block data stored on the flash memory, we recover old LPN which used before erased/overwritten to be decrypted naturally in the controller.As a practical case, we study how to recover data after a Ransomware attack even if prior L2P table's value has changed with new one. We also analyze that feasibility to recover data depending on the number of overwrites on same physical block.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Lee-A-New-Hope-The-One-Last-Chance-to-Save-Your-SSD-Data.pdf)
### Debug Resurrection on Nordic nRF52 Series
Nordic nRF52 System-on-Chips (SoCs) are unquestionably dominating the IoT dedicated platforms market today, especially for short range communications (BLE, Zigbee…) and asset tracking segments.The entire family consists of six different nRF52 platforms, all built around the ARM Cortex-M4F CPU. In order to prevent an attacker with physical access to dump the Code/Data stored in Flash memory and start reverse-engineering, Nordic Semiconductors has implemented a security feature called APPROTECT. Once this feature set, the SWD Debug Interface is permanently disabled and there is no way to deactivate this protection without erasing the entire Flash Memory (according to the vendor).During this talk, LimitedResults will present a way to bypass the APPROTECT, leading to a permanent reactivation of the Debug Interface, offering full debug capabilities on the target (R/W access to Flash/RAM/Registers, Code Exec and Reflash). All the nRF52 versions are impacted, from the classic nRF52810 to the most advanced nRF52840 platforms. Due to its intrinsic characteristics, the exploit cannot be patched without silicon redesign, leading to a countless number of vulnerable devices on the field for ever.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-LimitedResults-Debug-Resurrection-On-nRF52-Series.pdf)
### LadderLeak: Breaking ECDSA with Less than One Bit of Nonce Leakage
Although one of the most popular signature schemes, ECDSA presents a number of implementation pitfalls, in particular due to the very sensitive nature of the random value (known as the nonce) generated during the signing algorithm. It is known that any small amount of nonce exposure or bias can in principle lead to a full key recovery by solving the hidden number problem (HNP). This has been practically exploited in many attacks in the literature, taking advantage of implementation defects or side-channel vulnerabilities. However, most of the attacks so far have relied on at least 2 bits of nonce bias (except for the special case of curves at the 80-bit security level, for which attacks against 1-bit biases are known, albeit with a very high number of required signatures).In this talk, we uncover LadderLeak, a novel class of side-channel vulnerabilities in implementations of the Montgomery ladder used in ECDSA scalar multiplication. The vulnerability is present in several recent versions of OpenSSL. However, it leaks less than 1 bit of information about the nonce, in the sense that it reveals the most significant bit of the nonce, but with probability less than 1. Exploiting such a mild leakage would be intractable using techniques present in the literature so far. However, we present a number of theoretical improvements to solving the HNP (an approach originally due to Bleichenbacher), and this lets us practically break LadderLeak-vulnerable ECDSA implementations over the sect163r1 and NIST P-192 elliptic curves. In doing so, we achieve several significant computational records in practical attacks against the HNP.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Aranha-LadderLeak-Breaking-ECDSA-With-Less-Than-One-Bit-Of-Nonce-Leakage.pdf)
### From Zero to Sixty: The Story of North Korea's Rapid Ascent to Becoming a Global Cyber Superpower
In a relatively short period of time, North Korea has evolved its offensive cyber capability from that of a fledgling nation to a global cyber superpower. Having shifted their focus from purely destructive campaigns, which culminated in 2014 with the attack against Sony Pictures, North Korea appears to have shifted to a dual-pronged approach where they prioritize both maintaining control for the current Kim regime, as well as attacks designed to diversify and otherwise energize their economy. 

What's notable about North Korea is the rate at which they have modernized the speed of their offensive capabilities as well as the competency they have demonstrated relative to other nation-state actors. According to intelligence reporting, North Korea is the second fastest threat actor in terms of breakout time (how long it takes the actor once inside the network to move laterally). On average, it took North Korea 2 hours & 20 minutes to achieve breakout, whereas it took China an average of about 4 hours and Iran an average of about 5. In terms of their efficacy and the ability to engage in impactful attacks, the US National Security Council contends that North Korea has stolen at least $2 billion USD in the course of its malicious currency generation offensive cyber activity – more than any other known threat actor (both nation-state and criminal).

Given the above, the purpose of this presentation is to illustrate from both a technical perspective as well as a strategy perspective how North Korea became the cyber superpower that they are today. By demonstrating and detonating malware variants that most of the world has never seen, this presentation will review major historical attacks, will assess the malware involved in these attacks, and will review how those attacks played into the larger strategic objectives of the North Korean regime.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Rivera-From-Zero-To-Sixty-The-Story-Of-North-Koreas-Rapid-Ascent-To-Becoming-A-Global-Cyber-Superpower.pdf)
### FPs are Cheap. Show me the CVEs!
SAST tools are notoriously hard to evaluate and benchmark. The most important thing you want to know about a tool before spending time and money on it: does it give me relevant results? Does it really find the vulnerabilities it promises? Vendors are quick to tell you that their technology will find every vulnerability category out there, and claim to cover every CWE under the sun. But, how do you verify such bold claims? How many vulnerabilities will their tool really uncover, and how many frustrating false positives will you have to trawl through?We've all been there: planting mock vulnerabilities in our code bases to challenge a SAST product. It takes a lot of time, and it really only gets you a synthetic set of vulnerabilities to test against. Or you might run tools against one of the many synthetic benchmarking repositories that are riddled with vulnerabilities. Deep inside you know that those codebases have aged and don't really test coverage for modern web frameworks, and rarely test for vulnerabilities that arise due to complex interplay between dependencies and your own code.If only we could test tools against *real* vulnerabilities! But hold on… We carefully give every major security vulnerability a globally unique CVE identifier and a collection of metadata. Why not use those! We've triaged hundreds of CVEs in open source codebases and identified the fix commit(s) for every single vulnerability. At Black Hat Europe, we will release this benchmarking dataset and tooling to the open source community.This is an initiative by the recently founded Open Source Security Foundation, a part of the Linux Foundation. The working group in which this initiative was developed includes partners from GitHub, Google, Microsoft, Mozilla, and OWASP.
### Manufacturing Hardware Implants from Idea to Mass Production: A Hacker&#39;s Journey
This presentation wants to be a motivational talk for all those hackers out there that always wanted to share some cool hacking devices with the community but didn't know how to deal with R&D, Quality Assurance, and Mass Production. In this talk, I will be presenting the entire life-cycle of a couple of hacking toys I developed: WHID Injector & WHID Elite. From their inception to release in production, passing through some blockers and failures I encountered during the journey.Why is this topic interesting you ask… Easy! Both R&D processes that I used were not backed by any crowdsourcing fund and the sale of these devices is not going in any form to me. I am just doing this as hobby, fun and (most importantly) I believe in giving back something to the InfoSec community without making any profit out of it.What about listening to how I did it and then trying yourself? There will also be examples of other hackers, inspired by my adventure who followed my example and started similar not-for-profit projects.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Bongiorni-Manufacturing-Hardware-Implants-From-Idea-To-Mass-Production.pdf)
### Discovering 20 Year Old Vulnerabilities in Modern Windows Kernel
With the continuous upgrade by Microsoft, the latest windows 10 version has become more and more powerful and supports more and more features. On the other hand, certain components always exist in windows system, such as printer driver.The function of the print driver consists of the GDI kernel and the user-mode printer driver.Printer Driver is too old, it turned out that few people payed attention to the security issues for it. However, the interaction between UMPD(user mode printer driver) and GDI kernel created a big attack surface.This talk presents how we found some novel and unique vulnerabilities in ancient windows code. In particular, we designed a special fuzzer for the user-mode print driver, which effectively found multiple vulnerabilities in windows graphics kernel. We will introduce the design idea and implement skills used in the fuzzer, and disclose the details of the two fixed vulnerabilities to deeply reveal the security impact of the UMPD attack surface.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Han-Discovery-20-Yeas-Old-Vulnerabilities-In-Modern-Windows-Kernel.pdf)
### Design Pitfalls in Commercial Mini-Programs on Android and iOS
A new, commercial mobile-computing paradigm, dubbed app-in-app, is gaining high popularity in the past years. Under the paradigm, a mobile app, called host app or host, operates a set of sub-apps (a.k.a. mini-programs) as its in-app components. These mini-programs give users native app like experience and enriched functionalities (e-commerce, banking, health, travel management, food delivery, etc.), thereby increasing their "stickiness" to the host: one does not need to leave the app if it does everything. Mini-programs are installed by the users from the host's mini-program store, just like Google Play and Apple app store, which fosters an ecosystem around the host app. Wechat, for example, a host with one billion users, has one million mini-programs in its store and 200 million daily mini-program users. Nowadays, this app-in-app paradigm has been hosted by many popular apps such as Wechat, Alipay, TikTok, Baidu, etc., with other app vendors (e.g., Amazon, Google, Microsoft, Samsung, Airbnb, HSBC) actively releasing mini-programs to these hosts.Mini-programs access system resources (e.g., camera, microphone, location, contacts) through the mediation of the hosts, which developed access control to manage mini-programs, similar to how the OS manages apps. Less clear, however, is whether the host, a third-party app without OS-level privilege, is capable of securely managing system resources and mini-programs. In this research, we show the first systematic security analysis on 11 popular commercial app-in-app ecosystems. We found four new, serious vulnerabilities, which allow the adversary (zero-permission mini-program) to stealthily escalate his privilege (e.g. accessing the camera, photo gallery, microphone, etc.) or acquire sensitive data (e.g. location, passwords of Amazon, Google, etc.). The problems affect all 11 hosts on both Android and iOS, with more than 2.6 billion users. We further discuss the lessons learned and possible mitigation strategies.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Lu-Design-Pitfalls-In-Commercial-Mini-Programs-On-Android-And-IOS.pdf)
### How Embedded TCP/IP Stacks Breed Critical Vulnerabilities
In the past few years, there's been a rise in critical vulnerabilities affecting embedded TCP/IP stacks which had remained undiscovered for over a decade. The direct, unauthenticated and sometimes cross-perimeter network exposure of these stacks, the often privileged portions of the system they run in and their position at the top of opaque supply chains complicating vulnerability management efforts make for a highly dangerous mix resulting in periodic waves of critical vulnerabilities affecting billions of devices across industry verticals. But contrary to what many assume, the fragility of these fundamental components isn't limited to specific vendors or older, closed-source stacks alone.In this talk, we will present over a dozen new vulnerabilities in multiple widely used embedded TCP/IP stacks deployed in everything from networking equipment and medical devices to industrial control systems. We will discuss the nuances in their exploitability & potential impact and demonstrate a proof-of-concept against a yet-to-be-disclosed high profile target. In addition, we will present the first quantitative & qualitative study into vulnerabilities affecting embedded TCP/IP stacks showing a clear pattern to the affected components & features as well as the root causes of the vulnerabilities that affect them. Finally, we will provide concrete advice on how to mitigate and manage vulnerabilities affecting billions of devices in the absence of centralized patching and notification efforts.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-dosSantos-How-Embedded-TCPIP-Stacks-Breed-Critical-Vulnerabilities.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Wednesday/eu-20-dosSantos-How-Embedded-TCPIP-Stacks-Breed-Critical-Vulnerabilities-wp.pdf)
### IAM Concerned: OAuth Token Hijacking in Google Cloud (GCP)
Imagine you've protected your production Google Cloud environment from compromised credentials, using MFA and a hardware security key. However, you find that your GCP environment has been breached through hijacking of OAuth session tokens cached by gcloud access. Tokens were exfiltrated and used to invoke API calls from another host. The tokens were refreshed by the attacker and did not require MFA. Detecting the breach via Strackdriver was confusing, slowing incident response. And there are multiple confusing options to revoking the active OAuth sessions and most do not work, causing further delays in remediation.This talk will demonstrate a compromised credential attack in Google Cloud Platform by:hijacking cached OAuth tokens stored on a GCP administrator's client machine andreusing existing gcloud CLI sessions to gain access to multiple GCP environmentsshowing that MFA does not apply to OAuth token refreshes for cached credentials (only the initial login)We will then discuss various approaches and challenges to defending:PreventionMFA is not required to refresh the OAuth token. Google cloud session timeout (GSuite Admin) is effective and should be set. IP whitelisting (using VPC Service Controls and Access Context Manager) should be used but is not well understood. Explicit client-side revocation of cached accounts by the user can help but is manual and unreliable.Detection OAuth token values are not logged in Stackdriver logging, nor in G Suite Audit logs, meaning that suspicious behavior can be tracked to the account but not the token itself, causing more confusion during incident response, as well as limiting remediation options.RemediationOAuth tokens can be revoked, but there are multiple options, some of which are not useful/effective as they do not affect API/CLI sessions or require an OAuth token, which is not logged.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Hwong-IAM-Concerned-OAuth-Token-Hijacking-In-Google-Cloud-GCP.pdf)
### Hermes Attack: Steal DNN Models In AI Privatization Deployment Scenarios
The AI privatization deployment is becoming a big market in China and the US. For example, company A has a private high-quality DNN model for live-face authentication, and it would like to sell this DNN model to other companies with a license fee, e.g., million dollars per year. In this privatization deployment scenario, company A (the model owner) allows company B to use the DNN model but has the motivation to protect its confidentiality, while company B has the physical access to its own machines and also has the motivation to steal the DNN model to save the license fee for the coming years. Here company A usually protects its model with existing software-hardening and model-protection techniques on the host side, e.g., with secure boot, full disk encryption, runtime access control, and root privilege restrictions, etc. Luckily, all existing model extraction attacks are NOT able to reconstruct the whole DNN model. Thus, at this point, people still have the illusion that the model is safe (or at least the leakage is acceptable). However, in this talk, we identify that the PCIe bus connecting the host and the GPU/AI-accelerator is a new attack surface, which allows an adversary to FULLY reconstruct the WHOLE DNN model. We believe this attack technique can also work in other similar scenarios, such as a smartphone with NPU. This attack has three main steps:intercept PCIe traffic;do reverse-engineering to recover high-level semantics; andfully re-construct the DNN model.The 2nd reverse-engineering step is very challenging due to the closed-source runtime, driver and GPU instructions, as well as millions of noises due to level out-of-order traffic and unrelated control traffic.In the presentation, we will present the details of the attack steps and the algorithm of reconstructing the DNN model. We will also show three demos using 3 real-world GPUs, i.e., NVIDIA Geforce GT 730, NVIDIA GeforceRTX 1080 Ti, and NVIDIA Geforce RTX 2080 Ti, and 3 DNNs (i.e., MINIST, VGG, and Resnet). We believe our attack technique is able to work on all existing GPUs and AI accelerators. At last, we will discuss the potential countermeasures to mitigate such attacks. We hope that through our work, people could rethink the security of AI AI privatization deployment and harden the AI systems again from both software and hardware levels.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Cheng-Hermes-Attack-Steal-DNN-Models-In-AI-Privatization-Deployment-Scenarios.pdf)
### efiXplorer: Hunting for UEFI Firmware Vulnerabilities at Scale with Automated Static Analysis
Existing UEFI analysis instruments lack systemic approach to firmware vulnerability research focused on specifics of x86-based systems. No publicly known tools available for UEFI firmware vulnerabilities research focused on static analysis. Most of the common reversing tools focused on simplifying some reconstruction routines but not rebuilding the full picture based on firmware image. Previously, researchers have presented some work on statically analyzing UEFI firmware images at scale but more focused on misconfiguration issues (like Secure Boot not enabled or firmware update is not authenticated).In our talk, we will introduce a vulnerability research approach with unique static analysis sauce aimed to find vulnerable code patterns. efiXplorer plugin REconstructs key elements and data types (like EFI protocols) with cross-references (by analyzing the full firmware image) valuable for UEFI reverse engineering. Without reconstruction cross-references, it's hard to find classes of issues such as SMM (Intel System Management Mode) callout (where a pointer is referencing a not validated buffer in untrusted memory (NVRAM, ACPI ...) controlled by the attacker) and others.efiXplorer IDA plugin - Most comprehensive open-source IDA plugin for UEFI reverse engineering. Authors open-sourced this plugin recently and continue to work on it focusing more on vulnerability research.The presented IDA plugin discovered multiple previously unreported vulnerabilities in recent widespread hardware platforms from common vendors (like ASUS, ASRock, MSI, Gigabyte, Lenovo, and some others). In this Briefing, we will push a new version of the plugin with functionality to trigger all presented classes of the issues during the talk.
- [slide](http://i.blackhat.com/eu-20/Wednesday/eu-20-Labunets-efiXplorer-Hunting-For-UEFI-Firmware-Vulnerabilities-At-Scale-With-Automated-Static-Analysis.pdf)
### Locknote: Conclusions and Key Takeaways from Day 1
Join members of the Black Hat Review Board for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day one and how these trends will impact future InfoSec strategies.
### Precursor: Towards Evidence-Based Trust in Hardware
In hardware, the status quo is that we may have faith in our wares, but we have no direct, evidence-based reason to trust it. Even the best microscopes can only reveal partial information about the way a chip is constructed, and typically only in a destructive fashion. Trusted fabs are also insufficient, especially considering literal MITM agents such as delivery couriers and customs inspectors.Ideally, the case to trust a specific instance of hardware should be built on evidence that can be collected using relatively inexpensive tools that an end-user directly operates. This talk will discuss my vision for evidence-based trust in hardware, through the lens of the Precursor platform. Precursor is an FPGA-based, open hardware platform. Critically, the use of an FPGA delays the binding of the CPU core to the hardware, giving users the option to design-in countermeasures and apply patches. This shifts the balance of power, taking us from a situation where users have no choice but to have faith in their hardware, to one where users have some agency to reason about its security properties, as well as having options to defend their turf apropos to their threat model. We will also touch on how Precursor also extends the boundary of evidence-based trust to the input and output attack surfaces.
### Fingerprint-Jacking: Practical Fingerprint Authorization Hijacking in Android Apps
Many mobile devices carry a fingerprint scanner nowadays. Mobile apps utilize the fingerprint scanner to facilitate operations such as account login and payment authorization. Despite its security-critical nature, relatively little effort has been devoted to the security analysis of fingerprint scanner, especially from the system security aspect.In this talk, we introduce fingerprint-jacking, a type of User-Interface-based (UI) attack that targets fingerprint hijacking in Android apps. We coin the term from clickjacking, as our attack also conceals the original interface beneath a fake covering. Specifically, we discover five novel attacking techniques, all of which can be launched from zero-permission malicious apps and some can even bypass the latest countermeasures in Android 9+. Our race-attack is effective against all apps that integrate the fingerprint API.As apps' implementation flaws intensify the fingerprint-jacking vulnerability, we have designed a static analyzer to efficiently identify apps with implementation flaws that can lead to fingerprint-jacking. In our evaluation of 1630 Android apps that utilize the fingerprint API, we found 347 (21.3%) apps with different implementation issues. We have successfully performed proof-of-concept attacks on some popular apps, including stealing money via a payment app with over 100,000,000 users, gaining root access in the most widely used root manager app, and more. Finally, we discuss potential mitigations for both the apps and the Android framework.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Wang-Fingerprint-Jacking-Practical-Fingerprint-Authorization-Hijacking-In-Android-Apps.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Wang-Fingerprint-Jacking-Practical-Fingerprint-Authorization-Hijacking-In-Android-Apps-wp.pdf)
### This is for the Pwners : Exploiting a WebKit 0-day in PlayStation 4
Despite an active console hacking community, only few public PlayStation 4 exploits have been released. The exposed WebKit-based browser is usually the entrypoint of a fullchain attack: from browser exploitation to kernel exploitation. However, browser-engine hardening techniques together with the total absence of debugging capabilities make it very hard to successfully exploit bugs in the latest PS4 firmwares. In this talk, we will present how we managed to debug then exploit a 0-day WebKit vulnerability on 6.xx firmwares. The bug has been reported by our fuzzers and is currently under the process of responsible disclosure.The bug is a Use-after-Free (UAF) vulnerability in WebKit engine. The exploitation of this bug requires a deep understanding of WebKit's primary heap allocator. The key concepts of the allocator as well as the primitives required to massage the heap will be introduced to the audience.In this talk, we will introduce the root cause of the bug. This bug provides limited exploitation primitives. However, thanks to a weakness we identified in ASLR mechanism, we were able to make this bug exploitable. In this presentation, we will focus on the exploitation strategy we adopted to get code execution in the context of the browser process and how we turned in particular a Use-After-Free into a R/W primitive leading to code execution. We will conclude our talk by outlining some of the hurdles we faced while attempting to port the exploit on the latest PS4 firmware.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Meffre-This-Is-For-The-Pwners-Exploiting-A-Webkit-0day-In-Playstation4.pdf)
### Bypassing NGAV for Fun and Profit
In this talk, we demonstrate the first methodological approach to "reverse engineer" a NGAV model and features without reversingthe product, and generate a PE malware that bypasses next generation anti-virus (NGAV) products (e.g., Cylance). Previous such attacks against such machine learning based malware classifiers only add new features and do not modify existing features to avoid harming the modified malware executable's functionality, making such executables easier to detect.In contrast, we split the adversarial example generation task into two parts:find the importance of all features for a specific sample using explainability algorithms, andconduct a feature-specific modification (e.g., checksums, timestamp, IAT, etc.), feature-by-feature.In order to apply our attack to NGAV with unknown classifier architecture, we leverage the concept of transferability, i.e., different classifiers using different features subsets and trained on different datasets still have similar subset of important features. Using this concept, we attack a publicly available classifier and generate malware PE files that evade not only that classifier, but also commercial NGAV. We also demonstrate additional techniques, such as the sliding window approach to understand the most important features in the attacked classifier.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Rosenberg-Bypassing-NGAV-For-Fun-And-Profit.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Rosenberg-Bypassing-NGAV-For-Fun-And-Profit-wp.pdf)
### BinTyper: Type Confusion Detection for C++ Binaries
Type confusion bug (or bad casting) is a popular vulnerability class that attacks C++ software like web browser, document reader. This bug occurs once a program typecasts and uses an object as an incompatible type. An attacker can exploit this vulnerability to execute malicious code in the target software.Previous research to detect type confusion bugs has been performed at the source-level. It inserts codes that verify type compatibility in the typecasting operator to perform detection at runtime. These approaches cannot be applied in binary-level, because high-level information such as class hierarchy and the typecasting operator does not exist in the compiled binary. However, many popular software such as Adobe Reader, Microsoft Office, third-party software, and legacy software are provided in binary format.In this talk, we propose BinTyper, a type confusion detection tool that can be used in binary-level. BinTyper splits internal layout of classes into multiple areas via static analysis. After that BinTyper recovers the minimum type information required for the binary to be executed without triggering the type confusion bug via dynamic analysis. Based on this information, the target binary can be executed with the verification to detect the type confusion bug.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Kim-BinTyper-Type-Confusion-Detection-For-C-Binaries.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Kim-BinTyper-Type-Confusion-Detection-For-C-Binaries-wp.pdf)
### My Ticks Don't Lie: New Timing Attacks for Hypervisor Detection
Hypervisor detection is a pillar of sandbox evasion techniques. While hardware-assisted virtualization solutions are indispensable for scalable dynamic malware analysis, compared to bare-metal machines they all introduce timing discrepancies that expert malware writers may reveal using low-level measurement sequences. Today, the most advanced sandboxes fight such attempts by massaging the values malware can read from classic time sources.In this talk, we will see how this battle is far from over: by taking advantage of recent developments in microarchitectural research, we will build and exercise two novel hypervisor detection primitives that current anti-evasion approaches seem incapable of handling. The first idea is to build a high-resolution covert time source using a dedicated counter thread that can tick just as accurately as an unpatched TSC counter, often with an even better resolution. We revisit well-known detections from evasive malware and academic works using this new source. The second idea is a prime+probe attack on the last-level cache to detect pollution caused by the execution of the virtual machine monitor from the hypervisor.An investigation conducted over real-world sandboxes showed that while several classic time evasions seem no longer effective, counter threads can immediately bring them back to life without raising alerts related to time query attempts. Also, microarchitectural attacks do not seem to be on their radars, and may thus be a promising addition to the malware realm.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-DElia-My-Ticks-Dont-Lie-New-Timing-Attacks-For-Hypervisor-Detection.pdf)
### POSWorld. Should You be Afraid of Hands-On Payment Devices?
The dark market is full of cloned Point of Sales terminals and offers for fake merchant accounts. But how do they get there if every terminal is built to have anti-tampering mechanisms, segregated memory for private crypto keys, and multiple other layers of protection? In this talk, we follow the life cycle of the most popular PoS terminals of major vendors from their release onto the retail market through to breaking the device and cloning the terminal. We show you exactly what it takes for hackers to use PoS terminals to cash out.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Stennikov-POSWorld-Should-You-Be-Afraid-Of-Hand-Ons-Payment-Devices.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Stennikov-POSWorld-Should-You-Be-Afraid-Of-Hand-Ons-Payment-Devices-wp.pdf)
### Effective Vulnerability Discovery with Machine Learning
Software Composition Analysis (SCA) products report vulnerabilities in third-party dependencies by comparing libraries detected in an application against a database of known vulnerabilities. These databases typically incorporate multiple sources, such as bug tracking systems, source code commits, and mailing lists, and must be curated by security researchers to maximize accuracy.

We designed and implemented a machine learning system which features a complete pipeline, from data collection, model training, and prediction on data item, to validation of new models before deployment. The process is executed iteratively to generate better models with newer labels, and it incorporates self-training to automatically increase its training dataset.

The deployed model is used to automatically predict the vulnerability-relatedness of each data item. This allows us to effectively discover vulnerabilities across the open-source library ecosystem.

To help in performance stability, our methodology also includes an additional evaluation step to automatically determine how well the model from a new iteration would fare. In particular, the evaluation helps to see how much it agrees with the old model, while trying to increase metrics such as precision and/or recall.

This is the first study of its kind across a variety of data sources, and our paper was recently awarded the ACM SIGSOFT Distinguished Paper Award at the Mining Software Repositories Conference (MSR) 2020.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Sharma-Ang-Effective-Vulnerability-Discovery-With-Machine-Learning.pdf)
### Portable Data exFiltration: XSS for PDFs
PDF documents and PDF generators are ubiquitous on the web, and so are injection vulnerabilities. Did you know that controlling a measly HTTP hyperlink can provide a foothold into the inner workings of a PDF? In this session, you will learn how to use a single link to compromise the contents of a PDF and exfiltrate it to a remote server, just like a blind XSS attack.I'll show how you can inject PDF code to escape objects, hijack links, and even execute arbitrary JavaScript - basically XSS within the bounds of a PDF document. I evaluate several popular PDF libraries for injection attacks, as well as the most common readers: Acrobat and Chrome's PDFium. You'll learn how to create the "alert(1)" of PDF injection and how to improve it to inject JavaScript that can steal the contents of a PDF on both readers. I'll share how I was able to enumerate the various PDF objects to discover functions that make external requests using a custom JavaScript enumerator, which enable you to exfiltrate data from the PDF. Even PDFs loaded from the filesystem in Acrobat, which have more rigorous protection, can still be made to make external requests. I've successfully crafted an injection that can perform a SSRF attack on a PDF rendered server-side. I've also managed to read the contents of files from the same domain, even when the Acrobat user agent is blocked by a WAF. Finally, I'll show you how to steal the contents of a PDF without user interaction, and wrap up with a hybrid PDF that works on both PDFium and Acrobat.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Heyes-Portable-Data-ExFiltration-XSS-For-PDFs.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Heyes-Portable-Data-ExFiltration-XSS-For-PDFs-2-wp.pdf)
### The Hunt for Major League IoT-ICS Threats: A Deep Dive into IoT Threat Terrain
Because the Internet of Things is a major part of modern life, security threats are everywhere. Security incidents as well as the results of our many threat hunts have shown us that hundreds of millions of devices have been traumatized by attackers' malicious actions, made part of large botnets, or disrupted through malicious programs taking advantage of zero-day or one-day vulnerabilities.In order to reinforce detection and defensive capabilities against such IoT-ICS threats, we have deployed hundreds of automated threat hunting engines worldwide. In the past year, we have received and analyzed more than 45 TB of traffic, detected over 1.1 billion attacks from over 200 countries, and hunted 400 million plus suspicious IPs, 30 million plus suspicious domains, and over 1 million malicious files (RATs, trojans, worms, ransomware, and so on). Among those malicious files, more than 40% are unknown -- VirusTotal couldn't recognize them. We also found that more than 1.1 million devices may have been assimilated into botnets.This talk will share in detail how we built an automated large-scale threat hunting system, and give a deep look into the overall threat situation and trends from 6 hunting examples from the past year. We will share the benefits and responses to the threats we found, and the next steps for our threat hunting project.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Cheng-The-Hunt-For-Major-League-IoT-ICS-Threats-A-Deep-Dive-Into-IoT-Threat-Terrain.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Cheng-The-Hunt-For-Major-League-IoT-ICS-Threats-A-Deep-Dive-Into-IoT-Threat-Terrain-wp.pdf)
### Quantum Security and Cryptography: You Are (Probably) Doing it Wrong
Quantum Cryptography is not just Alice and Bob exchanging qubits: There is a whole world of exotic applications that use quantum effects for securing information and that are just impossible to achieve with traditional cryptography. But why should we care given that most of these applications are still at a far research stage?In this talk, we will face an uncomfortable fact about quantum computing (QC) and cryptography: all the recent attention brought to quantum-resistant cryptography (fueled by the advancement in QC research and the NIST standardization process) leads only to a short-term security solution once QC becomes available. The reason: quantum-resistant cryptography (often dubbed "post-quantum") can only protect classical digital (binary) information. But given the very peculiar characteristics of quantum information (such as the impossibility of copying data and the destructive action of observation), new encryption systems able to cope with quantum data and quantum networks have to be designed with a completely different approach, and show surprising behaviors. Not to be confused with currently existing "quantum key distribution" (QKD), which is a very specific and limited branch of it, quantum cryptography is designed to be run natively on a QC device proper, and able to act on quantum data.In this talk (that does not assume expertise in quantum mechanics) we will dive into quantum cryptography and we will see:How many classical cryptographic tasks (one-time pad, block ciphers, public-key encryption, etc.) have a quantum counterpart;How some other ones are very hard to translate quantumly (e.g., authentication) or simply impossible (digital signatures);How quantum cryptography enables new functionalities that have no counterpart in traditional cryptography: unclonable keys, offline money, quantum lightning, one-time programs, and much more!
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Gagliardoni-Quantum-Security-And-Cryptography-Youre-Probably-Doing-It-Wrong.pdf)
### Circumventing the Guardians: How the Security Features in State-of-the-Art TLS Inspection Solutions can be Exploited for Covert Data Exfiltration
In this talk, we will reveal a new stealthy method of data exfiltration that specifically bypasses security solutions created to detect this attack scenario. By using our exfiltration method SNIcat, we will show how we can bypass a security perimeter solution performing TLS inspection, even when the Command & Control domain we use is blocked by threat prevention and reputation features.Generally speaking, the complexity of exfiltrating data is relatively low, especially when a security device is not present to attempt detecting it. One would expect that a SOC analyzing decrypted data on the wire, or data being mirrored to an IDS, would have the ability to detect exfiltration attempts. However, what if the aforementioned traffic never reaches the IDS in the first place? This is the case with almost every security solution we have tested SNIcat on, be it from solutions from F5 Networks, Palo Alto Networks to Fortinet. All of these products are designed to work as legitimate MiTM devices, in order to decrypt and inspect traffic, either by mirroring a copy of the traffic to other security devices (IDS), inspect the traffic themselves, or forward the traffic to in-line devices (IPS, NGFW, etc).In addition, for some products, the ability to create false negatives is possible, wherein traffic is logged as 'blocked' whilst being successfully exfiltrated.We will begin by presenting how the exfiltration method works, its consequences and most importantly; how it remains undetected and not blocked by security features in devices performing TLS inspection.Furthermore, we will talk about our disclosure process with a few vendors, their proposed workarounds and other ways to mitigate the issue. Finally, we will finish with a live demo of our exfiltration tool exchanging data with its C2 while bypassing an in-line security device, acting as a MiTM performing TLS inspection.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Marstrander-Circumventing-The-Guardians-How-The-Security-Features-In-State-Of-The-Art-TLS-Inspection-Solutions-Can-Be-Exploited-For-Covert-Data-Exfiltration.pdf)
### Cross-Site Escape: Pwning macOS Safari Sandbox the Unusual Way
Sandbox escape plays a vital role in a full chain exploit. For the past few years, we've seen several favorite targets of researchers like WindowServer have fallen apart on Pwn2Own. Most of them are memory safety issues in IPC endpoints that are reachable from the sandbox. However, there are underrated attack surfaces like private API, platform-specific features, and legacy components on macOS.

In this talk, I'll present a novel attack targeting the design flaws of the reachable IPC and their associated WebViews by utilizing the classic web security attack, i.e., Cross-Site Scripting (XSS). Without re-exploiting WebKit twice, native code execution outside the sandbox is achieved. Such flaws often involve a multi-stage chain across several components that don't usually have connections at all, making them hard to spot, not to mention the impossibility to fuzz. They don't require a single byte of memory corruption (except the initial renderer exploit), so all the state-of-the-art memory safety mitigations don't stop them at all. Compared to traditional ways, they were incredibly stable and cleaner to implement.

This talk will revisit the big picture of Safari sandbox attack surfaces, especially those forgotten by previous publications, analyzing various WebViews in different contexts and their weakness. I'll detail three unique standalone exploits respectively affecting from OS X Yosemite (or even earlier) to macOS Catalina 10.15.2, including the one used in TianfuCup 2019 Safari category. They covered features like Dashboard, OTA Updates, Dictionary lookup, etc. to execute native code unexpectedly. One of them even has a persistence attack scenario on iOS.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Zhou-Cross-Site-Escape-Pwning-MacOS-Safari-Sandbox-The-Unusual-Way.pdf)
### How to Better Fuzz Windows 10 Directx Kernel at Present
DirectX is the engine that handles rendering on the Windows platform. Many outstanding people have made outstanding contributions in the research of DirectX. In this talk, I will share new research content of DirectX including the discovery of new attack methods, new paths, and how to design targeted fuzz based on these, and find related vulnerabilities. I will also introduce the experience of designing Windows kernel fuzz and explore how to better design closed source fuzz.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Liu-How-To-Better-Fuzz-Directx-Kernel-At-Present.pdf)
### Please Make a Dentist Appointment ASAP: Attacking IOBluetoothFamily HCI and Vendor-Specific Commands
In order to control the firmware link manager and baseband controller, Bluetooth stacks usually abstract a set of command interfaces called Host-Controller Interface (HCI). Through these interfaces, the host can access and modify control registers and hardware status on the SoC side. In addition to common inquiry, reset and other basic control functions, HCI mostly allows callers to send vendor-specific commands and events in the form of raw data. These undocumented interfaces further introduce potential attack surfaces to the system.

Since HCI is open to low-privileged processes, the InfoSec community has always been concerned about the security impact of these interfaces. In recent years, binary auditing and fuzzing against drivers such as IOBluetoothFamily have never stopped. We can also prove this from the output of IDA Pro/Hex-Rays. The routine IOBluetoothHCIUserClient::ValidParameters has expanded from 300 lines of code on macOS High Sierra to more than 3000 lines on macOS Catalina. With the joint efforts of Apple and the security community, hunting for new vulnerabilities is not an easy task.

This presentation will share more than a dozen IOBluetoothFamily HCI kernel zero-day vulnerabilities, most of which have been hidden in plain sight for a long time. One of them is very similar to the well-known Win32K User Mode Callback vulnerability, this design flaw affects all HCI handlers (more than 200). Furthermore, due to the existence of raw data requests, we can also attack undocumented vendor commands, and I will show an interesting overflow case about Broadcom LE Meta VSC.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Wang-Please-Make-A-Dentist-Appointment-ASAP-Attacking-IOBluetoothFamily-HCI-And-Vendor-Specific-Commands.pdf)
### Story of Jailbreaking iOS 13
Jailbreaking refers to obtaining the kernel privilege of iOS, by means of the development of vulnerabilities. Usually, at least one kernel vulnerability is used. By overwriting the sensitive data structure in the kernel, the jailbreaker could run unauthorized code on the device without restrictions. It could then be used for performing code injection and data interception upon any process on the device. Thus, sometimes, a jailbreaker may not be the owner of the device, but an intruder who wants to steal or manipulate information, and that includes spreading misinformation.This talk will cover in detail how a series of iOS vulnerabilities are exploited to achieve Jailbreak on iOS 13.7. I'll be talking about their root cause, techniques used during the exploit development to bypass the mitigations that are unique to iOS, ultimately get the privilege of reading and writing kernel memory and demonstrate the potential malicious impact of the attack. The rest of my talk will be related to how these vulnerabilities were discovered, tips for reverse engineering. As an independent researcher, I hope to give some inspiration to the audience.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Hu-Story-Of-Jailbreaking-IOS-13.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Hu-Story-Of-Jailbreaking-IOS-13-wp.pdf)
### Light Commands: Hacking Voice Assistants with Lasers
In the near future, our homes will employ potentially dozens of IoT devices. These devices listen to our voice commands using sophisticated microphones. Our laser-based injection attack Light Commands shows how microphones can respond to light as if it was sound. By simply modulating the amplitude of laser light, we can inject fully inaudible and invisible commands into microphones of smart speakers, phones, and tablets, across large distances and through glass windows.In this talk, we will show:How Light Commands works by exploiting a physical vulnerability of MEMS microphones,How it's possible to remotely inject and execute unauthorized commands on Alexa, Portal, Google, and Siri voice assistantsHow the ecosystem of devices connected to these voice assistants, such as smart-locks, home switches, and even cars, fail under common security vulnerabilities (e.g. PIN bruteforcing) that make the attack more dangerous
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Rampazzi-Light-Commands-Hacking-Voice-Assistants-With-Lasers.pdf)
### Permission Mining in GCP
Do you know exactly what each user can do in your Google Cloud Platform (GCP) environment? Do you know if you have users who can assume other identities to escalate their privileges? Do you know the effective permissions the users would have if they assume other identities? CodeSpaces went completely out of business in 2014 after an attacker used their IAM misconfiguration to delete all of their AWS infrastructure. Every enterprise should be aware of and monitoring this risk in their public cloud environments.

In this talk, we'll discuss an effective strategy to assess the full Identity and Access Management (IAM) exposure of a GCP environment. We'll discuss the complexity of this problem with some real world examples, and demonstrate how a misconfigured member can escalate privileges via direct service account impersonation or by launching resources. This threat has existed for years in public cloud providers. While GCP and their recommended open-source tools address some IAM misconfiguration use cases, they do not provide full visibility into the potential for privilege escalation or lateral movement. The solution we designed provides the missing visibility.

Finally, we'll cover our approach to solve this problem, which uses a graph. Once we obtain all the relevant information via API calls, the graph allows us to map-out the permissions granted to members, the structure of the GCP environment, and the service accounts. The demo will show how we designed the graph, the way we traverse it, and the output.

We ran this solution in multiple environments, including production environments where we found dozens of 'shadow admin' identities. The identities were able to escalate their privileges to become administrators with control over all resources, permissions, and logging. You will see how the results were used to remediate those environments.
- [slide](http://i.blackhat.com/eu-20/Thursday/eu-20-Estep-Permission-Mining-In-GCP.pdf)
- [whitepaper](http://i.blackhat.com/eu-20/Thursday/eu-20-Estep-Permission-Mining-In-GCP-wp.pdf)
- [source_code](https://github.com/netskopeoss/iaas_permission_mining)
### Locknote: Conclusions and Key Takeaways from Day 2
Join members of the Black Hat Review Board for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day one and how these trends will impact future InfoSec strategies.