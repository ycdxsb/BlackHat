## BlackHat USA 2020
### Lessons From 11 Billion Breached Records
Security flaws, hackers and data breaches are the new normal. It’s not just those of us in the industry facing these foes every single day, it’s everyone. Whether you’re online or offline, you simply cannot exist today without your personal information being digitised in systems which are often left vulnerable and exploited at the whim of attackers. But who are these people, the ones who seek to break through our defences and exploit our data? And how are they continually so effective at doing so, despite our best efforts?In this talk, you’ll hear from the creator of “Have I Been Pwned” about the lessons he’s learned after processing more than 11B records of breached data. You’ll get a glimpse behind the scenes of what caused some of these devasting incidents and how they continue to wreak havoc today, despite how much more aware the industry is becoming. It’s a frightening, eye-opening and entertaining look at infosec and data breaches.
### Disappeared Coins: Steal Hashrate in Stratum Secretly
Most cryptocurrencies with high value are based on proof-of-work (PoW), including Bitcoin, Litecoin, and Ether. The process to "produce" them is usually called "mining", and the people involved are called "miners". The mining process is one of the most important infrastructures in the PoW based blockchain system. As the number of miners increases, mining becomes more and more difficult. Many miners decided to establish mining pools for cooperation so that miners who join the mining pools can share the profit according to the computing power they contributed to the pool. Stratum is the mainstream communication protocol between miners and mining pools. Its security is very important to the participants. In our work, we propose two novel man-in-the-middle (MITM) attack schemes towards Stratum, which means attackers can steal miners' computing power to any mining pool on the basis that TCP connections can be hijacked. Compared with existing attack schemes, our work is more secretive, more suitable for the real environment, and more harmful. The proof-of-concept (PoC) shows that our work works perfectly on most mining softwares and pools. Since the ISPs are hijacking traffic for advertisement all over the world, our work whistles to blockchain miners for a more hidden and profitable potential attack scheme.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Liu-Disappeared-Coins-Steal-Hashrate-In-Stratum-Secretly.pdf)
### A Walk Through Historical Correlations Between Vulnerabilities & Stock Prices
By common sense, we know that security vulnerabilities, data breaches, ransomware, privacy concerns and state-sponsored attacks impact negatively on the stock prices of public companies, but to what extent? How quickly will they recover? And, which sectors or industries are the most affected?To answer the aforementioned questions, in this talk I'll present some assumptions that resulted from the data compilation and analysis of (in)famous security issues that affected stock prices. For instance, I’ll review some of the recent hacks, such as the SolarWinds ($SWI) breach, that affected many other companies, including FireEye ($FEYE). Also, I will discuss how much time it took to recover from important data breaches, such as the ones in Equifax ($EFX), Home Depot ($HD) and in multiple financial entities. When it comes to vulnerabilities, we’ll see the impact in the stock price by critical-risk vulnerabilities such as Meltdown in Intel ($INTC) chips and in the autopilot feature of Tesla ($TSLA) cars. Privacy concerns vs Facebook’s ($FB) stock price will be discussed as well. The core of this talk is key points that explain which security-related issues are more impactful against the stock prices as well as other conclusions such as which sectors/industries are the most impacted and the time it takes for stocks to recover. This will help you not to panic when you hear in the news "the stock plunged after a security vulnerability was reported". After this talk, you will understand better how impactful cybersecurity-related issues really are, and you’ll have some reference figures for the future in case you invest/trade in stocks, so you’ll know when it’s the right time to buy/sell.            
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Hernandez-A-Walk-Through-Historical-Correlations-Between-Security-Issues-And-Stock-Prices.pdf)
### Racing the Dark: A New TOCTTOU Story From Apple&#39;s Core
When developing operating system kernels and drivers, functions related to user data mapping, accessing and parsing are often found vulnerable. In order to solve this type of problem, almost every system defines standard operating rules when touching untrusted user input. For example, on Linux platforms, the kernel or third-party drivers should use copy_from_user, copy_to_user and other functions to manipulate user mode buffers. A similar set of operations on Windows is called Probe and Capture. Routines that violate the rules will at least introduce double-fetch or TOCTTOU vulnerabilities to the kernel. On macOS/iOS platforms, the situation becomes a little more complicated. Functions like io_connect_method can automatically handle user input for the kernel and extensions, while BSD functions such as copyin and copyout provide support for manual operations. In other words, with the help of *_io_connect_method, we seem to only need to pay attention to data parsing and secondary pointers processing, but is this really the case?This presentation will share with you more than a dozen macOS kernel memory mapping related zero-day vulnerabilities. Some subtle cases show that developers can only identify the most obvious problems when the vulnerable function is mixed with different types of vulnerabilities, which directly leads to the security update can be bypassed by race conditions. These cases remind us that we must re-examine the memory mapping mechanism of macOS/iOS.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Wang-Racing-The-Dark-A-New-Tocttou-Story-From-Apples-Core.pdf)
### Pre-built JOP Chains with the JOP ROCKET: Bypassing DEP without ROP
ROP has become virtually synonymous with code-reuse attacks in exploit development, but the reality is there is another way: Jump-oriented Programming (JOP). Until recently, there were no dedicated tools to do JOP, unlike with ROP, which has many excellent tools, such as Mona and ROPgadget. In fact, there were even claims that JOP had never been done in the wild (not true). There is virtually no practical information on how to perform JOP, and it would have been a monumental effort to do pure JOP, without a dedicated tool. Thus, JOP was a phantom, lurking in the shadows, unknown. Times have changed; JOP is now possible with the new JOP ROCKET, a reverse engineering and exploitation framework for JOP developed by Brizendine as part of his doctoral dissertation research. With the latest version of JOP ROCKET, the tool can now produce a pre-built JOP chain, which under ideal circumstances, can work with minimal user modification. With JOP ROCKET, you can develop a JOP exploit that, similar to ROP, allows for the bypass of Data Execution Prevention (DEP), or other mitigations such as ASLR; we show both in demo.This talk serves to bring this previously arcane, esoteric knowledge of JOP to the people. It introduces the challenging, technical details of how to perform JOP exploits. The talk focuses heavily on giving examples and demos of JOP exploits, and explaining the many nuances. While JOP is similar to ROP, it is also extremely different, and there are many non-obvious gotcha's. JOP is a challenging, non-trivial code-reuse attack, seldom discussed, and this talk teaches people how to use it with the JOP ROCKET. Our major update is the prebuilt JOP chain to bypass DEP with VirtualProtect() or VirtualAlloc(). While JOP exploit development can be challenging, this pre-built JOP chain simplifies the process.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Brizendine-Babcock-Prebuilt-Jop-Chains-With-The-Jop-Rocket.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Brizendine-Babcock-Prebuilt-Jop-Chains-With-The-Jop-Rocket-wp.pdf)
- [source_code](https://github.com/Bw3ll/JOP_ROCKET/)
### The Rise of Potatoes: Privilege Escalations in Windows Services
Privilege escalation is a required step for an attacker in order to get full control of a system starting from a lower privileged access.In Windows there are many ways to reach this goal. This talk will be focused on showing all the recent techniques used to do privilege escalation starting from a service account.This scenario is quite common when attacking web applications hosted on Windows servers. When a web server is compromised (through code execution or arbitrary file write) it is possible to run commands on behalf of the web server that is running as a service. MSSQL servers are another example of services that could be compromised by a malicious attacker.WSH (Windows Service Hardening) is a feature enabled since Windows Vista with the goal of hardening services. These "isolation" techniques are often not applied and, in some cases, can be abused too. As an example, the famous Rotten/JuicyPotato exploit uses the DCOM/NTLM reflection vulnerability.Those techniques require SeImpersonatePrivilege which is considered a God privilege by MS. The impersonation privilege is assigned by default to any service account and that opens a hole that could be abused by the attackers in order to escalate privileges. MS does not consider this boundary (going from SERVICE with SeImpersonate to SYSTEM ) as a security boundary but just a safety boundary. For this reason, those vulnerabilities are classified as "won't fix" by MS.This talk will describe all the recent techniques, showing how it is still possible to escalate privileges from SERVICE to SYSTEM in multiple ways.Some mitigations will be advised too; sysadmins should never rely on default service account configuration to segregate services/processes.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as21-Cocomazzi-The-Rise-of-Potatoes-Privilege-Escalations-in-Windows-Services.pdf)
### Vibe Check: IDK About This…. Why Students May Shy Away From Cyber in a Surveillance State
Are you a threat researcher? Interested in ethical hacking, but worry you might wind up on a “list”? Surveillance is nothing new to the Asia Pacific region. Facial recognition is ubiquitous. But how does the pressure of complying to strict laws and censorship change or influence cyber talent in the region?If you are a member of the information security community, or a proponent of the next generation of pentesters, analysts, and investigators - you might also be concerned about filling vacant positions. Many college students are about to enter the workforce. Those with the potential to be great white hat hackers may “play it safe” instead of exploring their skills. Can what they learn at hack-the-box or pwn2own actually hurt their chances of landing a decent job at a bank? How do governments or employers judge grey hat hackers?This talk will present community insight and some general guidelines to help attendees navigate offensive security education. These first-hand accounts (mostly anonymous) come from researchers in the field or on college campuses. 
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Devonshire-Vibe-check-IDK-about-this.pdf)
### Mining and Exploiting (Mobile) Payment Credential Leaks in the Wild
Over the past decade, an increasing number of mobile apps have integrated the third-party payment function from service providers or so-called Cashiers. Thus, end-users can perform the payment within the smartphone through these Cashiers readily. To secure their services, the Cashiers define various payment credentials, e.g., PKCS#12 certificates, and share them with mobile apps for authentication and authorization operations, such as refund. Despite the security-critical nature of these payment credentials, the existing works focus on the specific credential leaks from known sources, e.g., Android APKs or GitHub. In contrast, little effort has been spent to study the prevalence of payment credential leaks in the wild and their security impacts.In this talk, we begin by giving the background of the mobile payment service from four first-tier Cashiers that serve over 1 billion users globally. After that, we introduce the potential leaking sources of the payment credentials, including the new ones that have not been investigated on a large scale before. For example, we find that the backend servers of mobile apps can expose payment credentials to the public inadvertently. Then, we describe four exploits enabled by the payment credential leaks when combining other implementation flaws. These exploits all bring about serious consequences, ranging from direct financial loss to the mobile apps to privacy violations for end-users. Specifically, with the leaked payment credentials, the attacker may steal money from the account of the mobile apps directly and obtain all the user payment records.Further, we design and implement an automatic tool to conduct credential mining from public VCS and APKs at a market scale. Consequently, we discovered around 20,000 leaked payment credentials, affecting thousands of apps and millions of end-users. We have made the responsible disclosure to the Cashiers, and some leaking apps revoked their credentials afterward.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Shi-Mining-And-Exploiting-Mobile-Payment-Credential-Leaks-In-The-Wild.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Shi-Mining-And-Exploiting-Mobile-Payment-Credential-Leaks-In-The-Wild-wp.pdf)
### Give Me a SQL Injection, I Shall PWN IIS and SQL Server
IIS and SQL Servers play very important roles in the Microsoft Ecosystem. They have been considered unbreakable for many years, and over one decade has passed since the last severe IIS memory corruption vulnerability was disclosed. Are they unbreakable? What about having a SQL injection? Can a SQL injection in the ACCESS database only be used to view unexpected data in the database? What is the relationship between IIS/SQL Server and the ancient (~30 years old) Microsoft JET database engine from the attacker's perspective?This presentation will answer all of those questions. It discloses a novel attack surface to attack IIS and SQL Servers based on a SQL injection. This attack surface opens a new world for attackers to have a chance to get RCE (Remote Code Execution) with "NT AUTHORITY\SYSTEM" privilege from a mere SQL injection on the latest Windows system. It discusses attack surface details and corresponding impacts in 3 classical attack scenarios in the real world: IIS+Access, IIS+SQL Server, and IIS+Webshell. It also shows 20-year old examples from dozens of vulnerabilities we found across all Windows versions released in the last two decades under this attack surface. In addition, it also includes how to defend and mitigate this attack surface especially for those systems which are no longer supported by Microsoft.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Yan-Give-Me-a-Sql-Injection-I-Shall-Pwn-IIS-and-Sql-Server.pdf)
### Domain Borrowing: Catch My C2 Traffic if You Can
For red teams, CDN is a good redirector and protector for their C2 traffic, especially with domain fronting. However, if there are HTTPS decryption devices in the network, domain fronting can be easily detected by comparing SNI and HOST.This talk will present a new method to hide your C2 traffic with CDN to circumvent censorship. We will detail some tricks we found in some CDN implementations, and how we chain them together to “borrow” a domain and its valid HTTPS certificate to hide our C2 traffic, especially, when the SNI and HOST of our C2 traffic are the same. We named this method “Domain Borrowing”.In addition, we will present a detection bypass demo against the Palo Alto PAN-OS, and release a C2 agent PoC to help your red team operations.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Ding-Domain-Borrowing-Catch-My-C2-Traffic-If-You-Can.pdf)
### Threat Hunting in Active Directory Environment
Mandiant conducted multiple investigations and observed techniques that attackers preferred as they conducted privilege escalation to move laterally, persist in the environment, and blend in. Backdoors and misconfigurations on Active directory systems provided attackers with long term privileged access to the environment.Based on our learnings dealing with remediation on the frontlines, we observed closely the challenges customers had in recognizing and remediating these attacker techniques. These challenges were further influenced by the adoption of controls, and attacker sophistication in APJ.We will cover, in depth, different methods used by attackers to maintain persistence, covertly elevate privileges at will, and maintain and exert control over systems managed by Active Directory. We will talk about different methods of hunting for misconfigurations and backdoors to help find these faster and respond effectively.Some of the hunt use cases that may be discussed include:1. DACL Based Backdoors2. Constrained, Unconstrained and RBCD Delegation Misuse3. Excessive Permissions on Active Directory Objects4. AdminSDHolder Based Persistence5. Cross Forest Trust Abuses6. Credential Stealing Techniques 7. Misconfigurations of Authentication Methods8. GPO for Lateral Movement and Maintaining Access9. Domain Dominance Attack Skelton Keys, DC Shadow, DCSync10. Hybrid Active Directory Malicious Configurations
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Khanna-Threat-Hunting-In-Active-Directory-Environment.pdf)
### Stuxnet-in-a-Box: In-Field Emulation and Fuzzing of PLCs to Uncover the Next Zero-Day Threat in Industrial Control Systems
Recent years have been pivotal in the field of Industrial Control Systems (ICS) security, with a large number of high-profile attacks exposing the lack of a design-for-security initiative in ICS, as well as a substantial number of research works that try to proactively uncover underlying vulnerabilities. The main focus on both sides, though, has been the first and obvious choices when it comes to exploitation, namely the network level as the main gateway to an ICS and the control operation performed by it. As ICS evolve abstracting the control logic to a purely software level hosted on a generic OS, software level evaluation of multiple levels of an ICS is a straightforward choice. In this work, we will present a new tool for the cybersecurity assessment of ICS such as Programmable Logic Controllers (PLC) for in-field security evaluation with no disruption to the actual process.More specifically, we will deploy system emulation to eliminate the need for experiments directly on the actual hardware device, massively improve scalability and compatibility for easy deployment on a multitude of platforms. On the emulated platform, we will apply fuzzing across software levels of the device, the system itself, the hosted PLC abstracting platform as well as the application performing the control logic. Through fuzzing we expose vulnerabilities existing on the system either by poor maintenance or sloppy programming. The PLC platform of choice is the Codesys runtime, an industry-leading solution existing in a quarter of the currently deployed PLC.Furthermore, we will combine the knowledge of the uncovered vulnerabilities with a custom reverse engineering tool to dynamically synthesize a new cyber threat that integrates operational manipulation, system exploitation and stealth to become a Stuxnet-level threat to an ICS.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Tychalas-Stuxnet-In-A-Box-In-Field-Emulation-and-Fuzzing.pdf)
### The Cost of Complexity: Different Vulnerabilities While Implementing the Same RFC
Our presentation discusses a simple question: What is the security cost of complexity and ambiguity? We analyze this as measured in terms of vulnerable implementations.To explore this question, we analyzed a very specific part of multiple TCP/IP stacks: their implementation of RFC 1035, sub-chapter 4.1.4 titled "Message Compression". This part of the specification is less than 500 words long and is not as complex as its name might suggest. However, as it turns out, it is quite tricky to implement.Our research shows that these few lines of specification, which may be solving a problem that no longer exists, were implemented in multiple different ways, with different interpretations, and interestingly with similar vulnerabilities in several stacks. In total, including our own vulnerabilities and those previously reported, we will discuss over 15 stacks with vulnerable implementations of this feature.We will describe how exploits for these vulnerabilities can be detected using common and not too complex rules and talk about what this means for vulnerability research – e.g., whether this could be used to discover close variants of vulnerabilities that exist cross-codebase.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-dosSantos-The-Cost-of-Complexity-Different-Vulnerabilities-While-Implementing-the-Same-RFC.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-dosSantos-The-Cost-of-Complexity-Different-Vulnerabilities-While-Implementing-the-Same-RFC-wp.pdf)
### Wideshears: Investigating and Breaking Widevine on QTEE
Widevine is a DRM solution, and QTEE is the TrustZone implement of Qualcomm, both running on billions of devices. In this presentation, we will share our latest study of Widevine on QTEE. We will first explain why QTEE and Widevine are high-value targets and share the basics about them in brief. After the opening, we will show how to locate the command handling logic and get the logic explained to show how we found a vulnerability.With the vulnerability in hand, we need the following in order to achieve the exploit:1. We need to know the memory model of a QTEE TA, especially how commands are delivered and how buffers are shared between the two worlds. Another vulnerability is put forward to do information leak with the model.2. We need to know where the TA is loaded and find a way to break ASLR.3. We need to find a memory layout to access TA from the user-controlled location.After the above is resolved, we will put them together to exploit the Widevine TA and extract data from SFS, the trusted storage of QTEE.Prior knowledge is not mandatory but is recommended.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Zhao-Wideshears-Investigating-And-Breaking-Widevine-On-QTEE.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Zhao-Wideshears-Investigating-And-Breaking-Widevine-On-QTEE-wp.pdf)
### (Un)protected Broadcasts in Android 9 and 10
We discovered a systemic vulnerability affecting Android version 9, Android version 10, and Android version 11 Developer Preview that allowed third-party apps to spoof certain protected broadcast Intent messages, allowing the sending of unauthorized messages that only the Android system and privileged pre-installed apps should be authorized to send. This (un)protected broadcast vulnerability occurs when an app declares that the system must protect some broadcast Intent message from being sent by other apps, yet --- due to a bug in AOSP --- the system granted that protection only to apps installed at a specific location on the file system. In other words, unless the app is installed at a certain path on the file system, the system would silently not honor these protection requests, leaving the app's broadcast messages unprotected at runtime.Specifically, only vulnerable versions of Android, only pre-installed apps that reside in a priv-app directory (e.g., /system/priv-app/SystemUI/SystemUI.apk) can register protected broadcasts with the system. This leaves apps that are not present in a priv-app directory (e.g., other pre-installed apps or third-party apps installed from the market) unable to have their protected broadcast declarations honored by the system which provides no access control and allows them to be sent by any app co-located on the device.The lack of protection of protected broadcast Intent messages enables unauthorized parties to escalate their privileges where they can send spoofed messages to carry out functionalities, they do not have the capability or authorization to perform. This can be viewed as a confused deputy problem since the process (deputy) receiving the broadcast Intent message acts upon it as if it was from an authorized source. We identified numerous Android vendors and devices that are impacted by this vulnerability where unauthorized apps can exploit vulnerable pre-installed apps to perform highly privileged functionalities, including arbitrary command execution with system privileges, access to the logcat log, and access to Personally Identifiable Information (PII).
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Johnson-Unprotected-Broadcasts-In-Android-9-and-10.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Johnson-Unprotected-Broadcasts-In-Android-9-and-10-wp.pdf)
### How Did the Adversaries Abusing the Bitcoin Blockchain Evade Our Takeover?
Cyber security has been a game of cat-and-mouse. In the past, we have seen the malware ecosystem adopt concepts such as code obfuscation, polymorphism, domain-generation algorithms (DGAs), as well as virtual machine and sandbox evasion whenever defenses were able to perform consistent and pervasive suppression of these threats.Some adversaries have recently started to use the Bitcoin blockchain for communicating command & control (C&C) information. As no one can block or remove transactions from the blockchain once the transactions are confirmed by miners, this means that adversaries do not have to fear that transactions with their C&C location are taken down. This latest innovation in malware tactics, techniques, and procedures (TTPs) means that existing common defenses such as DGA precomputation or sinkhole domains no longer work.We have monitored the malicious activity by one of the malware authors abusing Bitcoin blockchain for hiding their C&C location for over one year from mid-2019. During our monitoring, they repeatedly conducted trial-and-error and evolved TTPs since they did not understand the best solution to this new attack. Based on the insights from the observation, we realized temporal takeover of the IP address which malware communicates to from the adversary's C&C server to our sinkhole server. However, they implemented the evasive mechanism against our takeover. In this presentation, we will provide the audience with the way of analyzing Bitcoin and C&C operation, searching malware samples that communicate to the C&C IPs from transactions in the blockchain, and detecting the change of TTPs based on our experience of confrontation with the actual adversaries. In addition, we will show both our takeover and the evasive mechanism by the adversaries. Since transactions in the blockchain are open data, the audience will be able to deep dive into the malicious behavior soon after our presentation.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as21-Taniguchi-How-Did-The-Adversaries-Abusing-The-Bitcoin-Blockchain-Evade-Our-Takeover.pdf)
### Enter Sandbox
Applications are growing ever more complex, leading to an increase in exploitable vulnerabilities. One efficient method for mitigating potential attacks is the use of application sandboxing. The idea behind sandboxing is to constrain software within a tightly controlled environment. Linux provides seccomp filtering to restrict the system calls an application can execute. However, it requires an application developer to extract the system calls from the application manually, and to set up the resulting filters correctly.We investigate the challenges of automatically generating seccomp filters for an application. Based on this evaluation, we propose a new approach for automatically generating seccomp filters for Linux applications on both x86_64 and ARMv8. This new approach consists of two phases with a total of three distinct components, i.e., a static analysis phase with two components and an optional refinement phase with one component. We implement our approach as a compiler extension and a standalone tool. The compiler extension performs static code analysis to identify the system calls an application uses. The standalone tool can be applied to already existing binaries to allow sandboxing without having access to the source code. A dynamic refinement tool can be used during development to either identify system calls that were missed by the static component used in phase one or to further reduce the number of allowed system calls. In general, all three components can be combined to alleviate the potential shortcomings of an individual component. We show the effectiveness of our new approach in preventing real-world exploits with only minimal overhead.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Canella-Enter-Sandbox.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Canella-Enter-Sandbox-wp.pdf)
### Alarm.DISARM - Remotely Exploiting and Disarming Popular Physical Security System from Public Internet
You probably know this movie scene where the hacker of the group remotely disables the alarm before the other guys break in to execute a perfectly planned heist? Great, so this presentation is about how you do it in real life!In this talk, we'll present two remote code execution vulnerabilities (CVE-2020-25189 and CVE-2020-25185) which we found in a popular physical security system by Paradox. We'll start by explaining the ecosystem of a modern physical security system - the different components, sensors, and protocols involved. Then we'll focus on how we found these RCEs, going over the stages of the process such as firmware acquisition, decryption and reverse engineering of the embedded bare-metal firmware. We'll be diving into the various difficulties of exploiting this specific firmware, which runs exclusively on a cheap STM32 processor and plain LwIP network stack, no operating system or RTOS whatsoever. We'll explain the details of the ROP-chain used to overcome limited charset and show how our shellcode manipulates the device's internal VFS in order to communicate back before disarming the device. Finally, we'll present a demo of the exploit.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Bassat-Alarm-Disarm-Remotely-Exploiting-and-Disarming-Popular-Physical-Security-System.pdf)
### X-in-the-Middle: Attacking Fast Charging Piles and Electric Vehicles 
Electric vehicles represented by Tesla are changing the way people travel. How to safely and quickly charge electric vehicles is a problem that manufacturers of electric vehicles and charging piles need to solve. We conducted an in-depth analysis of the security of the DC fast charging communication protocol and found many interesting findings. This talk will mainly be divided into three parts. First, we will introduce the current global mainstream fast charging standards and communication protocols.  Next, we will share how to build an X-in-the-Middle attack environment. We have written a security test tool called "XCharger", and it can be used to capture, modify, replay, and fuzz the data packets in the communication process. Finally, we will share how to use our tools to analyze the private charging pile agreement of a well-known electric vehicle manufacturer, and to exploit the protocol vulnerability of DC fast charging pile to achieve free charging, and to change the charging voltage and current limits.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Wu-X-In-The-Middle-Attacking-Fast-Charging-Piles-And-Electric-Vehicles.pdf)
### Hunting Vulnerabilities of gRPC Protocol Armed Mobile/IoT Applications
Google's open source network communication protocol, gRPC has been used by thousands of mobile applications, including some IoT devices, and supports tens of billions of network services every day. Unlike the traditional Https protocol, gRPC is faster, more secure and more usable. Through research, it was found that due to the reliability of the private protocol, developers often ignore the security verification mechanism of the application itself, causing a large number of security vulnerabilities in some applications.The main reasons for these problems: In mobile applications, when developers use the gRPC protocol, they usually don't pay attention to the integrity and reliability of the data sent by the mobile application. Because the application uses ssl certificate verification and data signature verification, it ignores the security logic behind the server application.During this talk, we will introduce a method for automatic fuzz of vulnerabilities in the mobile application server interface. Through this method, in the past year, we have discovered hundreds of vulnerabilities in the application interfaces of hundreds of millions of users, including serious vulnerabilities such as SSRF, command execution, and unauthorized access to logic.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-Hunting-Vulnerabilities-of-Grpc-Protocol-Armed-Mobileiot-Applications.pdf)
### Locknote: Conclusions and Key Takeaways from Day 1
At the end of day one of this year's virtual conference, join Black Hat Review Board members Mika Devonshire, Ty Miller, Pamela O'Shea and Fyodor Yarochkin for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day one and how these trends will impact future InfoSec strategies.
### Insights and Predictions: What&#39;s Next in InfoSec
At the beginning of day two of this year's virtual conference, join Black Hat Review Board members Lidia Giuliano, Vitaly Kamluk, Vandana Verma, and Neil Wyler (Grifter) with Moderator, Jeff Wilson for an insightful conversation on the most pressing issues facing the InfoSec community. This session will feature a candid discussion on the key takeaways and how these trends will impact future InfoSec strategies.
### A General Approach to Bypassing Many Kernel Protections and its Mitigation
In the beginning, we will analyze an anecdotal exploit that bypasses KASLR using a flexible object in the Linux kernel implementation. In this talk, we extend the definition of flexible objects to elastic objects and demonstrate that this exploit trick is a general exploitation approach. This approach can be applied to not only the Linux kernel but also FreeBSD and XNU, bypass many protections except KASLR. First, we show that the adversaries could use the elastic objects to easily obtain a leaking primitive for nearly any kernel vulnerabilities with a limited overwriting capability. Second, we demonstrate that this leaking primitive enables the adversaries to bypass heap cookie protector, KASLR, stack canary, and even realize an arbitrary read attack. Third, we design a static analysis technique to identify all such elastic structures/objects in the kernel codebase. Based on this result, finally, we propose an isolation-based defense in the talk as a part of kernel hardening. We quantify its security improvement and measure its performance overhead from different granularities.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Chen-A-General-Approach-To-Bypassing-Many-Kernel-Protections-And-Its-Mitigation.pdf)
### How I Can Unlock Your Smart Door: Security Pitfalls in Cross-Vendor IoT Access Control
Internet of Things (IoT) devices are increasingly managed through the clouds, which mediate the users' access to devices, e.g., only authorized users can unlock a door. These clouds are operated by device vendors (Philips Hue, LIFX, Tuya, etc.) or cloud providers (Google Home, Amazon Alexa, IFTTT, etc.). Of particular interest here is the emerging capability, advocated by mainstream IoT vendors, to delegate device access across different clouds and users: for example, Philips Hue, August Lock, etc., allow Google Home to control devices mediated under their clouds, so the user can manage multiple devices from different vendors all through the single console at Google Home. On Google Home, then, an Airbnb host may temporarily delegate the access to their smart lock to a guest during their stay. Such a capability can lead to a convoluted delegation chain, whose authorization operations could easily go wrong. Specifically, access delegation across IoT clouds is distributed, heterogeneous, and unverified: each vendor customizes its delegation protocol with ad-hoc, implicit security assumption; further, we found the complicated delegation service is often coupled across clouds, with one cloud unwittingly violating the other's security operations and assumptions.We report the first systematic study on cross-cloud IoT delegation, based upon a verification tool we developed. We investigated 10 mainstream IoT clouds (Google Home, SmartThings, IFTTT, Philips Hue, LIFX, August, etc.), and discovered 5 serious vulnerabilities that endanger millions of users and hundreds of vendors. Exploiting the vulnerabilities, the adversary (e.g., former employee, Airbnb tenant) can gain unauthorized access to IoT devices (e.g., smart locks, switches, safety sensors). We implemented end-to-end attacks for all vulnerabilities and reported to affected vendors, which have deployed or scheduled fixes. We further propose principles for developing more secure cross-cloud IoT delegation services, before a standardized solution can be widely deployed.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Yuan-How-I-Can-Unlock-Your-Smart-Door-Security-Pitfalls-In-Cross-Vendor-IoT-Access-Control.pdf)
- [source_code](https://github.com/VerioT/VerioT)
### Apple Neural Engine Internal: From ML Algorithm to HW Registers
I am curious why the SEP (Secure Enclave Processor) firmware decryption key of the iPhone XR has been leaked for more than a year and no one has disclosed the machine learning model of FaceID. After I reverse engineered SEP, I found that SEP does include all the FaceID software logic including facial feature comparison. Even the iv and key used to decrypt the parameters of the FaceID neural network are stored in the SEP firmware in plaintext. However, the neural network structure and hyperparameter information needed to reconstruct the FaceID model are hidden behind a series of register operations.Since there is no public ANE (Apple Neural Engine) hardware datasheet, I cannot interpret the functions of these registers directly. Since the A12 processor, Apple has opened the ANE API to the APP, which gave me the opportunity to obtain register functions by reversing the ANE framework.According to Apple's public documents, neural network models of other frameworks need to be converted into mlmodel compressed file and then compiled into mlmodelc folder before they can be used. But the "compilation" in the document is different from the compilation of ANE. ANE will compile the neural network into a mach-o format file called ANEProgram. This ANEProgram file will be loaded and analyzed by the kernel ANE driver, and finally handed over to the ANE firmware to run.I have written a set of command line tools that can compile the model in mlmodelc into a ANEProgram file that can be loaded by the ANE driver, and can use all the internal undocumented ANE compiler options. There are a lot of internal undocumented debugging and test codes in the ANE framework that are not used by the system, which can be used to analyze and reverse-engineer the ANEProgram.According to the different permissions obtained by the attacker, ANE can be divided into APP cloud, APP, ANE daemon, ANE compilation process, ANE kernel driver, and ANE firmware. Since the implementation of ANE involves a large number of files in different formats, and the complexity of the ANE system is very high, there may be many security vulnerabilities in ANE. I just did byte flipping on the ANEProgram, and an iOS kernel OOB read was issued.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as21-Wu-Apple-Neural_Engine.pdf)
### Anti-Forensics: Reverse Engineering a Leading Phone Forensic Tool
How can vulnerabilities in forensic software affect cases brought to the courts? That question was the impetus of what kicked off my research on the Cellebrite UFED - a widely-used phone forensic tool. This talk will cover what my reverse engineering process was, what I found, how I went about reporting my findings, and the concerns, hopes, and fears I  had along the way. One would think that forensic tools like these are only available under strict non-disclosure agreements and to legitimate buyers. But, that didn't stop me from being able to legally obtain several of these devices. I rooted them and reverse engineered the cryptographic implementation protecting their forensic tools and exploits using public and custom-developed tools. I'll talk about their use of hard-coded authentication keys and what the possible implications of my findings were and how they've been addressed. I'll also cover not just how these forensic tools can help law enforcement, but how they can hurt everyone else in the process and how you may be able to defend yourself from them. Join me for a demonstration where my proof-of-concept Android application is able to detect and defeat *some* of the extraction options from the Cellebrite UFED.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/AS-21-Bergin-Anti-Forensics-Reverse-Engineering-A-Leading-Phone-Forensic-Tool.pdf)
### A New Era of One-Click Attacks: How to Break Install-Less Apps
Apps are becoming larger, cumbersome, and resource-consuming. Vendors want to reduce the whole process for users to reach the target page of content and get the work done with just a few clicks. Install-Less apps are considered a new choice that runs without requiring installation but has a similar user experience to native apps.There are different kinds of implementations for Install-Less apps, like hosting on native app engines, running based on webview, or componentizing the native app, but they all have similar attack surfaces. We will present some novel attack methods against Install-Less apps and detail multiple vulnerabilities which we found in Apple App Clips, Google PWA, Google Instant App, and QuickApp to achieve the "one-click" attack. We will first share some key observations on Install-Less app structures and give our insights into the entrance of exploit-chain - QRCode/NFC/Web. More importantly, we will take a dive into its core components such as data interchange, privilege control, and storage isolation, etc., and illustrate how we can steal sensitive users' data, code execution, and spoof.These critical vulnerabilities and attack vectors affect almost all the devices over the world including android and iOS, consisting of at least 1 billion users.Mitigation techniques and tips for developers and users will also be provided before we summarize our presentation to promote the development of the community.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as21-Zeng-A-New-Era-Of-One-Click.pdf)
### Scavenger: Misuse Error Handling Leading to Qemu/KVM Escape
Error handling code is used extensively in hypervisors, which is designed to capture unexpected behaviors and avoid crashing the vm, such as invalid inputs from guest users and insufficient memory. However, we find that incorrect use of error handling code or missing error propagation can lead to security problems such as privilege escalation. In this briefing, we demonstrate how to achieve a full guest-to-host escape exploitation through a misuse error handling code. Besides, we show that how the userspace memory can provide a reading/writing exploit primitive for information leak and code execution with the help of the natural hypervisor design principles. As far as we know, this is the first guest-to-host escape exploit in the context of error handling code.Remarkably, Scavenger is based on an uninitialized free vulnerability (Affected prior to Qemu 5.2.0), discovered in the nvme device, which is used to provide virtual solid-state drives (SSDs) service for the guest machine. And this is the first public virtual machine escape exploit in the drive device. The uninitialized variable resides on the heap. Its value can be controlled by heap Fengshui. Here are the procedures:(i) Firstly, Scavenger sprays heap with pointers to user memory; Therefore, we can control the object of free as a guest allocated buffer, turning arbitrary free to UAF.(ii) Secondly, when the guest allocated buffer freed by the host's process, we can obtain the leaked information in the guest's memory in order to bypass ASLR.(iii) Finally, we hijack the control flow by manipulating data pointers and overwriting it.Few virtualization developers and security researchers pay attention to the security impact of the error handling code on virtualization. We found this vulnerability by performing error handling code directed fuzzing. In this talk, we will demonstrate how to apply the error handling code target fuzzing technique to virtualization.We believe that the technique insights we present will benefit the researchers working in the same area: (1) The error handling fuzzing technique on virtualization; (2) How userspace memory could help to craft an exploit.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Pan-Scavenger-Misuse-Error-Handling-Leading-To-QEMU-KVM-Escape.pdf)
### New Attack Surface in Safari: Using Just One Web Audio Vulnerability to Rule Safari
In the past, Safari vulnerability researchers often focused on the DOM or JS engine, but some system libraries used by Safari, such as audio, video, font, etc., haven't received enough attention. There are few successful cases using vulnerabilities found in these modules to break Safari. Due to the built-in heap isolation mechanism of Safari, the heap used by these system libraries is not the same as the heap where the DOM objects and JS objects are located. As a result, the out-of-bounds writing vulnerabilities in these modules make it extremely difficult to overwrite some key JS objects. These vulnerabilities are difficult to exploit alone without the coordination of an info leak. I have invested a lot of time on bug hunting in the Web Audio module, and have achieved amazing results. A total of 15+ out-of-bounds read bugs and 10+ out-of-bounds write bugs have been discovered so far. At present, 12 bugs have been credited by Apple. Since it is difficult for us to perform heap spraying on OSX Heap, most of the out-of-bounds writing is difficult to use in Safari alone, but I found that there is a bug that can overwrite JS objects in a clever way, bypassing Safari's heap isolation, ASLR and other defense mechanisms, and finally achieve arbitrary code execution. I demonstrated the attack at the Tianfu Cup International Cyber ​​Security Competition hosted by the Chengdu Municipal Government of China, and successfully pwned Safari with only one shot.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Xie-New-Attack-Surface-In-Safari-Use-Just-One-WebAudio-Vulnerability-To-Rule-Safari.pdf)
- [whitepaper](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Xie-New-Attack-Surface-In-Safari-Use-Just-One-WebAudio-Vulnerability-To-Rule-Safari-wp.pdf)
### &#34;We Are About to Land&#34;: How CloudDragon Turns a Nightmare Into Reality
On October 27th, 2020, the Cybersecurity & Infrastructure Security Agency of the United States (CISA) jointly with the Federal Bureau of Investigation (FBI) and the Department of Defense Cyber National Mission Force (CNMF) released an alert on the TTP of North Korea APT group Kimsuky.Two years ago, on TheSAS2018, TeamT5 shared our research on the group CloudDragon. After our continuous tracking, we found there are significant differences among their operations which should then be divided into two groups, CloudDragon and KimDragon.Moreover, new techniques and weapons were observed, including:1. Supply Chain Attack2. Cross-platform Attack3. New Phishing TricksIn this presentation, we will focus on CloudDragon, go through some of the most significant operations conducted by the group, and more importantly, we will provide possible scenarios of future invasions for defense and detection.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Kuo-We-Are-About-To-Land-How-CloudDragon-Turns-A-Nightmare-Into-Reality.pdf)
### The Price of Compatibility: Defeating macOS Kernel Using Extended File Attributes
Filesystem is one of the infrastructures of OS, and any flaws in it may cause serious impacts.When I studied filesystem's implementation on macOS, I found that the old msdos FAT filesystem supports advanced features such as symbolic link and extended file attributes, which surprised me. Perhaps for compatibility and security considerations, Apple has done the simulation work of these FAT features for macOS. In the digital world, it's very difficult to make everything right. So when I dug deeper, I found that there are some flaws in the FAT feature implementation, giving me the opportunity to break its security boundary and launch an attack on the macOS through filesystem.In this talk, I will give an overview of the techniques behind Apple's filesystem implementation, then detail the vulnerabilities (CVE-2020-27904, CVE-2019-8852) I have found. Additionally, I will show how to exploit them to achieve arbitrary kernel code execution. The above facts prove that a little flaw in filesystem can lead to a serious impact. At last, I will discuss some other possible attack surfaces from the perspective of filesystem.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Fan-The-Price-Of-Compatibility-Defeating-MacOS-Kernel-Using-Extended-File-Attributes.pdf)
### Hiding Objects from Computer Vision by Exploiting Correlation Biases
In this study, we find that a correlation bias exists in major computer vision systems and exploit it to automatically craft adversarial images.Objects commonly found together in nature have a strong correlation with each other. This leads computer vision systems to develop a bias for detecting these objects together. For example, almost any round shape next to a dog will be seen as a frisbee by computer vision systems trained on the COCO dataset, since dogs and frisbees appear together very often in both nature and the dataset. The same is true in reverse. Objects that have very weak correlation such as stop signs and pizza will be harder to detect when they appear together. Using these correlation biases, we generate adversarial images using RetinaNet, YOLOv3 and TinyYOLOv3 trained on the COCO dataset as detectors. First, we determine the target object to hide. Second, we extract objects with a detection certainty above 95% from the COCO dataset and combine them with low correlation (less than 5%) backgrounds. Finally, we re-detect the target object and choose adversarial images in which the target object is now completely hidden. In addition, we confirm that the crafted adversarial images can be used to attack arbitrary systems where access to the training dataset or knowledge of the network is not available. We evaluate 1,000 adversarial images on leading commercial computer vision systems and receive a 90% success rate on fooling these completely different systems. We also make sure that our crafted adversarial images work in physical environments by pasting the printouts of crafted adversarial backgrounds behind physical objects, taking photos from different angles and confirming that the objects are no longer detected.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/as-21-PaPa-Ziegler-Hiding-Objects-From-Computer-Vision-By-Exploiting-Correlation-Biases.pdf)
- [source_code](https://github.com/DeloitteCyberSecurityLab/adversarial-image-generation)
### In-Depth Analyzing and Fuzzing for Qualcomm Hexagon Processor
Hexagon processors have been widely used on Qualcomm platforms. Almost all vital peripheral subsystems (e.g., baseband, WLAN, ADSP, NPU) are lade onto Hexagon processors.Security researchers have to face three main challenges. First, the firmware running on Hexagon is not yet open sourced and can be very complicated, thus making firmware analyzing or reverse engineering from scratch extremely troublesome. Second, for researchers who want to fuzz these targets, there is no open-sourced emulator available for Hexagon. Also, most of these targets depend on specified hardware, which makes the known traditional fuzzing techniques inefficient. In this talk, we will share our solution to overcome these challenges.  We will introduce our Hexagon analyzing framework, which can dynamically collect information of a running target. The collected information includes running status, function call trace, and can distinguish input-awareness function from common library. Such dynamical information is essential for us to find attack surfaces and to identify vulnerable code for further analyzing or fuzzing. Based on this framework, we have further developed our fuzzer system, which is coverage-guided, evolutionary, and intelligent. Moreover, the fuzzer is running in a real environment, which can effectively overcome the weakness of an emulator that lacks hardware support and fails to go deeper.First, we will share some possible solutions and their tradeoffs. Then we will introduce our solution and our analyzing framework. Our key principles, overall architecture, and the implementation of vital components will be provided. We will also describe the architecture and principle of the fuzzer system, and explain how to calculate as well as improve code coverage. Finally, we will demonstrate the framework and the fuzzer running on the Qualcomm baseband subsystem.
- [slide](http://i.blackhat.com/asia-21/Thursday-Handouts/AS21-In-Depth-Analyzing-Fuzzing-Qualcomm-Hexagon-Processor.pdf)
### Mem2Img: Memory-Resident Malware Detection via Convolution Neural Network
Process injection is a widely used defensive evasion technique commonly used for malware and fileless adversary transactions and requires running custom code in the address space of another process. Process injection improves invisibility, and some techniques also achieve persistence. We have observed that many APT attacks use this method to evade detection to achieve persistence. Therefore, it is increasingly important to detect such memory-resident malware which is injected through the process. Antivirus software does not have a high detection rate for memory-resident malware. As far as we know, in the face of such attacks, such as volatility, Rekall and Get-InjectedThread, YARA rules may be one of the best solutions, but the disadvantage is that it is impossible to distinguish unknown malware or shellcode-based malware. More and more people are proposing to use machine learning to classify malware family or detect malware. While there are many techniques for applying machine learning to implement malware classification, most works are heavily dependent on handcrafted features that can be evaded easily. In order to get rid of the above weaknesses, we present convolution neural networks (CNNs) with ensemble on memory-resident malware detection framework named "Mem2Img". This framework converts memory block which was injected by malware binaries or shellcode into images, learning features from raw data automatically, and avoiding the use of handcrafted features that can lead to information loss. Among the experiments we conducted, more than 100,000 memory blocks were used. With the best image size chosen and the fine-tuned model, we can speculate which known malware family this memory block belongs to or generate an alarm for an unknown but high-risk memory block and indicate the probability of which malware or APT group is associated with it. The experiment results show that the method can satisfy the accuracy requirement of practical use and has high scalability for the ever-changing attacks in the future.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Tseng-Mem2Img-Memory-Resident-Malware-Detection-via-Convolution-Neural-Network.pdf)
- [source_code](https://github.com/AragornTseng/Mem2Img)
### The Tangled Webview ----- Javascriptinterface Once More
WebView is a widely used Android component and with the method addJavascriptInterface, native applications can interact with web pages. This is a powerful feature, but also presents some security risks like CVE-2012-6336 and "App Clone Attack". Now it comes again.We have discovered a novel class of Android WebView vulnerabilities associated with JavascriptInterface, which can bypass ALL verifications.During this talk, we will disclose a NEW attack model for the first time. It attacks WebView from a deeper level and can bypass all kinds of validations and restriction technologies to invoke JavascriptInterface from any untrusted page. These vulnerabilities could lead to sensitive information leakage, identity theft, remote code execution and other severe consequences. We will present three vulnerability models, any one of them can lead to an attack. We will also dive into the WebView architecture and demonstrate the root cause of it. To help you find this vulnerability, we developed a novel tool that can vet Android apps automatically.Many high-profile apps are verified to be impacted, which affects more than 60% of Android devices and at least 2 billion endpoint users. Moreover, this kind of vulnerability can also be extended to other platforms such as IOS or Electron.Finally, towards solving these issues permanently, we propose a practical mitigation measure called "RichInterface". It has been applied in our custom WebView. Our evaluation of real-world apps shows the mitigation solution is effective and scalable, with negligible overhead.We hope to protect users from the potential security risks while enjoying the convenience of WebView and JavascriptInterface. We also hope to make the security community aware of this emerging new attack method.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Qin-The-Tangled-WebView-JavascriptInterface-Once-More.pdf)
### A Mirage of Safety: Bug Finding and Exploit Techniques of Top Android Vendor&#39;s Privacy Protection Apps
We all want to keep our privacy and our secrets hidden and safe. So nearly all top vendors develop and provide us some privacy protection apps such as Secure Folder, PrivateSpace, Safe, App Lock, etc. They claim that saving private files in those apps will be safer. However, we conducted comprehensive research about them and found that it is not true for most of them. Many design or development flaws allow attackers to bypass the protection and access the privacy files inside, which will affect billions of users.We found many related vulnerabilities and categorized them into three types of attack scenarios: attacking by malicious untrusted apps, system privilege apps, and accessing unlocked phones physically. For example, some vendor build-in safe apps aren't designed and implemented properly, so we can access and decrypt their 'safe' files easily from any malicious apps. Some vendors use TrustZone to protect the files but some design flaws allow system privileged attackers to retrieve the plaintext password and decrypt the files. Finally, if we can access the phone physically with the screen unlocked, we can exploit some unprotected system APIs to bypass the protection of all top vendors' secret-space apps.Finally, we will present the mitigation and our mobile apps' secure storage test process. We send them to all top vendors. By sharing our research, we want to improve the security of the privacy protection apps and better protect billions of users' privacy.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Zhang-A-Mirage-Of-Safety-Bug-Finding-And-Exploit-Techniques-Of-Top-Android-Vendors-Privacy-Protection-Apps.pdf)
### The B-MAD Approach to Threat Modeling
Threat modeling is a family of techniques for discovering what can go wrong with a system and improve its security. Threat modeling techniques often aim to be structured, systematic and comprehensive and have to intersect with the organization's systems for delivering products.In many ways, threat modeling is very easy, as long as you avoid the many traps that await the unwary. This talk is about one particular set of traps in the way that threat modeling is deployed across an organization.The B-MAD approach to threat modeling is an anti-pattern for threat modeling. It starts with the words "Bring me a diagram" and ends with escalations between security and operations, security and development, and security and the world. Why is that? How can we predict that it's all going to go downhill from those 4 little words? Why do they make up an anti-pattern?
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Shostack-The-B-MAD-Approach-To-Threat-Modeling.pdf)
### The Motion Sensor Western: The Good (Automatic Functionality Support), the Bad (Security Risks to Devices), and the Ugly (Privacy Risks to Individuals)
In the last decade, motion sensors (accelerometers, gyroscopes) have become more and more ubiquitous in various IoT devices (e.g., smartphones, smartwatches, fitness trackers, headphones, etc). They provide the accuracy required to: (1) support automatic functions such as temporal gesture detection and progressive/ongoing health monitoring, and (2) provide optimized UX for gaming, etc. While the opportunities that motion sensors create for developers are widely known, much less is known about the opportunities that motion sensors create for attackers to violate the (1) integrity, availability, and confidentiality of a device, and (2) privacy of a user. In this talk, we will discuss security and privacy risks posed by motion sensors. We will start by explaining the security risks associated with attacks on motion sensors and their implications on various IoT devices (e.g., crashing drones, spoofing the daily number of steps in fitness trackers, creating covert channels in smartphones). We will continue by examining the privacy risks associated with the insights that can be derived from motion sensor data and the implications on individuals' privacy (eavesdropping on user's speech, keylogging a user's password/PIN code, remote identification of a user, and user tracking). We will then focus on a user study that we conducted which demonstrates how data obtained from motion sensors can be used to violate a user's privacy. We show that a user's intoxication, a condition that is forbidden in some countries around the world, can be detected by analyzing eight seconds of motion sensor data from a specific time of interest with high accuracy (without the need to perform a blood/breath test). Finally, we will analyze the current challenges associated with deriving insights that violate a user's privacy from motion sensor's data and explain why we believe that external processes (e.g., deployment of 5G, integration of eSIM, scientific progress) will significantly increase the risks that motion sensors pose to individual's privacy in the near future. 
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Nassi-The-Motion-Sensor-Western.pdf)
### Hey, You, Get off My Private Data: Do Apps Respect Your Privacy as They Claim?
In recent years, we have witnessed many major companies being punished by regulators and legislations due to violation of personal data privacy. Some of the violations may be caused by misunderstandings or even complete unawareness of the data protection laws. In this talk, we will present our study on multinational data protection regulations and compliance assessment of massive apps. We will focus on whether apps give users control over their personal data, in particular, the right to be informed, to consent, to be erased and forgotten, and to acquire data portability. We developed a framework to assess the compliance of data protection regulations in Android apps. We will provide it as an automatic open-source tool for app developers to check their own apps. We also applied our framework to the Top-1,000 apps in the Google play store and other alternative stores, and surprisingly found that privacy violation is pervasive in them. We will present our findings and recommendations to raise an alert to all app manufacturers, among other stakeholders.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Bai-Zhang-Hey-You-Get-Off-My-Private-Data-Do-Apps-Respect-Your-Privacy-As-They-Claim.pdf)
### Reverse Engineering Compliance
A big part of reverse engineering is asking "how does this work?" That's usually a step on the way to asking "why does it work thatway?" or "how can I make this work for me?" And usually, we reverse machine code. But we can bring the same thinking to other things. We can look at a standard and figure out what it's trying to accomplish. That's useful for moving ourselves and our organizations away from a checkbox mentality to meeting the spirit of the requirement. And it turns out that a standard is also a subset of a threat model: answers to the question "what are we going to do about it?" Exposing that threat model will have all sorts of positive effects. Some of those come from just talking about the threat model, and more come from pushing standards bodies to do the right thing, and show their threat model. In this talk, Adam will show what he thinks makes up the PCI threat model, explain how he reverse engineered it, and talk about how the work exposes a way to replace the compliance mindset with threat informed defense.
- [slide](http://i.blackhat.com/asia-21/Friday-Handouts/as-21-Shostack-Reverse-Engineering-Compliance.pdf)