## BlackHat USA 2020
### Engineering Cybersecurity for a Nation: What Singapore is Learning from Cars and Sanitation
Defending a country is different from a corporate network. Singapore wants to be a Smart Nation and wants to shift the paradigm of cybersecurity in order to achieve that. Doing so will require us to challenge some mental models: Should cybersecurity be a public good? Should it be an engineering problem or a policy problem? Should users be solely responsible for it? Should it be seen as a cost or a benefit to a company? Facing these dilemmas and looking at how other sectors have addressed similar challenges, could help us define a new way forward for cybersecurity in Singapore.
### BitLeaker: Subverting BitLocker with One Vulnerability
Trusted Platform Module (TPM) is a tamper-resistant security module. It has been widely deployed in commercial devices to protect secret data and ensure the trustworthiness of a system. There are two typical types of TPMs, hardware-based discrete TPM (dTPM) and firmware-based TPM (fTPM). Microsoft Windows has used both types of TPMs to protect the Volume Master Key (VMK) of their disk encryption software, BitLocker.BitLocker's TPM feature has not been analyzed in detail. It has hidden behind the TPMs because the TPM protected the VMK of BitLocker with sealing and unsealing functions. Most security researchers concluded the VMK sealed by the TPM was safe. Recent works also showed the only way to extract the VMK from the TPM was physical access like probing the Low Pin Count (LPC) bus or TPM pins. However, we found a novel way that can subvert BitLocker with only the software. So, free lunch for BitLocker is over.In this talk, we introduce a sleep mode vulnerability of the dTPM and fTPM that can subvert BitLocker. We also present our new tool, BitLeaker, that can extract the VMK from the TPMs and decrypt a BitLocker-locked partition without physical access. Last year, we already introduced a dTPM vulnerability, CVE-2018-6622. However, we found another new vulnerability related to the fTPM this year, especially Intel Platform Trust Technology (PTT). The sleep mode vulnerability can subvert not only the fTPM but also the dTPM with system sleep mode, and it can forge Platform Configuration Registers (PCRs). PCRs are core parts of the sealing and unsealing functions to protect the VMK of BitLocker. By exploiting the vulnerability, we extracted the VMK from TPMs and decrypted a BitLocker-locked partition with our custom tool, BitLeaker. Additionally, we present detailed information on BitLocker's VMK protection process related to the TPM and countermeasures.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Han-BitLeaker-Subverting-BitLocker-With-One-Vulnerability.pdf)
### Demystify Today&#39;s Binary Disassembling and How Modern ABI Makes it Easier
Disassembling is the process of restoring instructions and structure information from binary code, forming the foundation of nearly all the solutions for binary security. Incentivized by both industry needs and government programs, binary disassembling gains remarkable advancement and incorporates "magical" techniques to handle complex constructs. In this talk, we will demystify the techniques armed by binary disassembling through a presentation on our study with 8 open-released tools (Ghidra, Angr, McSema, Dyninst, Radare2, Jakstab, Uroboros, and Objdump).  We will also give a comprehensive (maybe partial) view of the advancement in binary disassembling across recent years. 

Going beyond the understanding, we will also present our intensive measurement on the above tools and on the most popular commercial tools (including IDA Pro and Binary Ninja). To support the evaluation, we extend the mainstream compilers (LLVM and GCC) and linker (GNU Gold Linker) to enable end-to-end collection of ground truth (which produce the highest level of completeness and accuracy). As we will detail in the talk, our evaluation separately measures individual techniques to understand their degree of use, utilities, and pitfalls. This evaluation leads to many understandings that are contrary to common beliefs but are expected to significantly facilitate the development of binary disassembling. 

In the last part, we will present a key finding from our study --- the development of Application Binary Interface (ABI) is making disassembling easier. In particular, ABI is mandating the availability of frame information for exception handling (e.g., System V x86-64 ABI). Such information makes it more reliable to collect function boundaries, function signatures, and local variables from binary code. We will demonstrate a tool that exploits exception handling information to achieve superior utility of disassembling.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Xu-Demystify-Todays-Binary-Disassembling-And-How-Modern-ABI-Makes-It-Easier.pdf)
- [source_code](https://github.com/junxzm1990/x86-sok)
### The Evil of Spy Camera
As you see, spy-cams have increased. In China, there has been a lot of news about pinhole cameras found in hotels, rental houses, and other accommodations in the past year. Around the world, the situation is not optimistic too. For example, news reports have said that spy cameras were reportedly hidden in digital TV boxes, wall sockets and hairdryer holders in 42 hotel rooms. Women in South Korea have come to fear that cameras could be anywhere, and monthly protests against spy cameras occur in Seoul. "My life is not your porn" became a slogan popularized in the protests.With the development of Internet of Things, hidden cameras are becoming smaller, clearer, and more functional with 1080P / 4K / Wi-Fi / remote control. And, prices are getting cheaper and cheaper. For only $30, you can buy a spy camera with a charger disguised, WiFi remote control and 1080p HD on Amazon or eBay. For tourists and residents, it becomes more and more difficult to find these cameras. And there is no simple and effective detection method to find the camera now.In this talk, we will introduce the structure and work principle of spy camera, and several effective ways to find all the cameras. After researching more than 30+ spy cameras, we found that although these cameras use different hardware and app control software, all of them use only about four kinds of solutions. We did a lot of reverse engineering for each solution. At last, we have implemented a camera discovery method (or even found rce vulnerability in each scheme) according to the protocol. With this method, it is very easy to detect a spy camera. Only needs APP to be installed. It could cover each case, which was mentioned in the news (for example, the case of "1600 hotel guests in South Korea"). At the same time, we will introduce some other auxiliary detection methods, including physical methods such as Temperature Information, infrared information, 802.11 frame information, high-frequency / low-frequency electromagnetic radiation / metal detection, and how the company or hotel can identify spy camera in their network traffic.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Shupeng-The-Evil-Of-Spy-Camera-2.pdf)
### The Evil Alt-Ego: (ab)using HTTP Alternative Services
The HTTP Alternative Services header (Alt-Svc, RFC 7838) was introduced in 2013 by seasoned developers with "good intentions" in a bid to streamline load balancing, protocol optimizations, and client segmentation. It has been subsequently implemented in almost all mobile and desktop browsers. Unfortunately, the seemingly simple functionality of Alt-Svc has an evil alt(er) ego, which facilitates stealthy abuse by nefarious actors. 

In this talk, we will begin by exploring the history of the Alt-Svc HTTP header, its original purpose, and the substantial risk it had inadvertently produced for end users. As such, we will discuss how Alternative Services can be leveraged to scan ports blacklisted by browsers, probe firewalled hosts, and mount Distributed Denial of Service attacks. We will further highlight how these services can be abused to bypass popular phishing and malware protection services like Safe Browsing, and online site checkers like VirusTotal, URLVoid, Sucuri and IPVoid. In the privacy realm, the Alt-Svc header can be commandeered  in order to track users: at the network layer by Internet Service Providers (ISPs) and at the application layer by first or third party websites (where we bypass third-party tracking protections on Firefox, Chrome and Brave). In a similar manner, the header can be used surreptitiously by various  access points on a victim's daily itinerary (say, a coffee shop) to exfiltrate parts of a victim's browser history. 

Our attacks are different from standard JavaScript attacks in that they operate at a lower layer of abstraction, and are thus not visible to the user through the browser's interface or JS based detection techniques. Indeed, our attacks require no user interaction and can be mounted from third-party web content, to varying extents, on Firefox, Tor, Chrome, and Brave browser.  It is thus essential that these vulnerabilities be fixed in the browser source code, and have been disclosed them accordingly. We will conclude with a discussion of vendor responses and practical mitigations, some of which are currently being addressed  by browser developers. To date, one of our vulnerabilities been patched by Mozilla as CVE-2019-11728, and another has been fixed under Brave's bug bounty program. 

In summary, this talk will highlight how one simple protocol update, suggested by experienced developers, can spawn a multitude of unintended alt(er) egos ripe for exploitation.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Tiwari-The-Evil-Alt-Ego-Ab-Using-HTTP-Alternative-Services.pdf)
### Faking a Factory: Creating and Operating a Realistic Honeypot
Designing realistic ICS honeypot requires substantial time and resource investment, as well as in-depth knowledge not only of the technical aspects, but of industrial automation process. Over most of 2019, we designed and built a factory honeypot that is so real, the only thing missing is the actual products coming out of it!For this talk, we will share our experience on how much effort we went through to make a realistic honeypot - from building a backstory for the company to the internals of our honeypot infrastructure. Then, we will highlight incidents we came across while running the honeypot since May 2019. We examined different incidents encountered, from ransomware attacks to industrial espionage and sabotage, and identify the objectives of our attackers.Finally, we will discuss some recommendations and lessons we learned from running a honeypot and to answer the question: Did we do enough to attract attackers thinking they were targeting a real factory?"
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Perine-Faking-A-Factory-Creating-And-Operating-A-Realistic-Honeypot.pdf)
### 3d Red Pill:  A Guest-to-Host Escape on QEMU/KVM Virtio Device
As a critical para-virtualized driver platform for the hypervisor, virtio has been widely adopted in qemu/kvm virtual machine for better I/O performance. Vulnerabilities that have been explored so far fail to carry out guest-to-host escape, the impacts of which are relatively minor (e.g., crashing a virtual machine). In this talk, we demonstrate how our 3dRedPill exploit breaks the security measures of virtio-gpu devices, achieving a full guest-to-host escape exploitation. To our knowledge, this is the first guest-to-host escape exploit in the context of virtio device exploitation.Particularly, our 3dRedPill is based on a heap-overflow vulnerability (CVE-2019-18389), discovered in a known third-party library, virglrenderer, which is supposed to provide virtual 3D GPU for the guest machine. Although address space layout randomization (ASLR) is enforced by default, 3dRedPill was able to bypass it and hijack the control flows of victim programs. Here are the procedures: (i) Initially, our exploit obtains the leaked information from shared memory and search for hypervisor addresses, in order to bypass ASLR.(ii) Afterward, a victim structure is selected, and with the heap spray technique, the exploit can overwrite arbitrary data by manipulating data pointers.(iii) Finally, it hijacks the control flow by overwriting a specified pointer from hypervisor.While this vulnerability has been reported by us and patched soon after, nobody knows when and how other vulnerabilities against virtio devices will be exposed. With regards to lessons learned, our talk also highlights a few interesting topics that are closely related to our work. For example, the stateful fuzzing technique, which contributes to our vulnerability discovery, will be discussed. We will offer some approaches allowing the customized fuzzer to achieve better performance. We believe that the technique insights we present will benefit the researchers who are working on the same area.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Shao-3D-Red-Pill-A-Guest-To-Host-Escape-On-QEMUKVM-Virtio-Device.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Thursday/asia-20-Shao-3D-Red-Pill-A-Guest-To-Host-Escape-On-QEMUKVM-Virtio-Device-wp.pdf)
### Securing the Next Version of HTTP: How QUIC and HTTP/3 Compare to HTTP/2
QUIC is a new always-encrypted general-purpose transport protocol being standardized at the IETF designed for multiplexing multiple streams of data on a single connection. HTTP/3 runs over QUIC and roughly replaces HTTP/2 over TLS and TCP. QUIC combines the cryptographic and transport handshakes in a way to allow connecting to a new server in a single round trip and to allow establishing a resumed connection in zero round trips, with the client sending encrypted application data in its first flight. QUIC uses TLS 1.3 as the basis for its cryptographic handshake.This talk will provide an overview of what the QUIC protocol does and how it works, and then will dive deep into some of the technical details. The deep dive will focus on security-related aspects of the protocol, including how QUIC combines the transport and cryptographic handshakes, and how resumption, including zero-round-trip resumption works. This will also cover how QUIC’s notion of a connection differs from the 5-tuple sometimes used to identify connections, and what QUIC looks like on the wire.In addition to covering details of how QUIC works, this talk will also address implementation and deployment considerations. This will include how a load balancer can be used with cooperating servers to route connections to a fleet of servers while still maintaining necessary privacy and security properties. It will also look back at some of the issues with HTTP/2 and discuss which ones may need to be addressed in QUIC implementations as well or are solved by the design of QUIC and HTTP/3.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Harper-Securing-the-Next-Version-of-HTTP-How-QUIC-And-HTTP3-Compare-To-HTTP2.pdf)
### CDPwn: Taking Over Millions of Enterprise-Things with Layer 2 Zero-Days
The attack surface exposed by proprietary layer 2 protocols is rarely explored by the research community, and it contains hidden bugs that have severe implications to the security of the devices that use them, as well as the network they belong to. We discovered 5 such zero-day vulnerabilities in a proprietary layer-2 protocol used by a wide variety of enterprise devices. This protocol, unfortunately, is enabled by default on all the affected products, and on all ports of each product, widening the potential attack surface. The first threat posed by the discovered vulnerabilities affects multiple brands of enterprise-grade switches and routers. From an attacker’s perspective - these network appliances are a valuable asset, as they withhold access to all network segments, and are located in a prime position for traffic exfiltration. By leveraging the vulnerabilities, an unauthenticated attacker can gain full control over the network appliance and move laterally between the VLANs served by it, effectively breaking network segmentation completely.The second attack scenario affects multiple brands of IP phones and IP cameras, numbering in the tens of millions in use by users and organizations worldwide. An attacker could use the discovered vulnerabilities to simultaneously take over all phones and cameras in a network, by sending a specially crafted broadcast packet throughout the network. Once in control of these devices, the attacker can listen in on calls and view the video feeds, creating the ultimate spying tool.In our talk, we will demo both attack scenarios, demonstrating the full implications of pwning an organization’s enterprise switch, and the frightening potential a single packet can have in taking over enterprise-grade phones and cameras.
### Dynamic Binary Instrumentation Techniques to Address Native Code Obfuscation
Android applications are becoming more and more obfuscated to prevent reverse engineering. While obfuscation can be applied on both, the Dalvik bytecode and the native code, the former is more challenging to analyze due to the structure of the bytecode as well as the API provided by Android Runtime.The purpose of this talk is to present dynamic binary instrumentation techniques that can help reverse engineers to deal with obfuscated codes. These techniques aim to be obfuscator resilient so that it does not rely on a special kind of obfuscation neither a specific obfuscator.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Thomas-Dynamic-Binary-Instrumentation-Techniques-To-Address-Native-Code-Obfuscation.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Thursday/asia-20-Thomas-Dynamic-Binary-Instrumentation-Techniques-To-Address-Native-Code-Obfuscation-wp.pdf)
### Making an Impact from India to the Rest of the World by Building and Nurturing Women Infosec Community
India is one of the most diverse and fastest growing countries in the world and due to the fast growth, women often are left behind. The world average female literacy rate is 79.7%, while in India the average rate is just 65.46%, the women that enter the technology workforce is even lesser and to cyber security is further less. The talk is about the journey of InfoSecGirls community which started in India with the goal of bringing more women into the cyber security workforce and integrating  them with the larger community and is now reaching a global audience. The Initiative was conceptualised because of a need to have a warm and nurturing environment for women where they can easily discuss information security and over a period of time moulded to help women, students, kids, underprivileged communities to come forward and be part of cyber security ecosystem.

In the talk, I will share how we started, the challenges encountered on the way, what we have achieved so far, and  the learnings from our journey. I will also talk about the free technical training we provide at conferences or colleges and how these trainings have enabled individuals start their Infosec journey or make themselves better and more confident in their roles. 

I will also share a framework which will enable interested individuals or groups in their journey towards building and nurturing  communities, and how to enable a culture of knowledge sharing, contributions from members and expand the community for bigger impact.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Sehgal-Making-An-Impact-From-India-To-The-Rest-Of-The-World-By-Building-And-Nurturing-Women-Infosec-Community.pdf)
### Tracking the Criminal of Fake News Based on a Unified Embedding
In recent years, public opinion attack has become more and more common. Attackers purposefully fabricate rumors and fake news, and these negative news widely spread across the Internet, which has a bad impact on individuals, companies or even the stock market. Most commonly, the malicious short-sellers attack targeted public companies by spreading rumors and disseminating distorted articles, resulting in stock price fluctuations or even sharp falls, to make profits therefrom. To protect personal reputation, the company's brand, and the stability of the stock market against public opinion attacks, it's so necessary to track fake news. However, rumors and fake news are mostly anonymous, and it lacks effective discriminating information to identify the authors, so it's so challenging to track these articles. Through the analysis of a large number of articles, it's found that different articles of the same author have a similar writing style, we can identify an anonymous article's author by writing style. We propose a unified method for authorship analysis based on deep learning, our method learns a mapping from texts to compact d-dimensional Euclidean space, this mapping embeds a text into the surface of a sphere with a radius of 1 and a center of origin. In Euclidean space, the distance indicates text similarity, texts of the same author have small distances, and texts of the distinct author have large distances. Inspired by mountain climbing, we propose a dynamic selection strategy to accelerate the model training, it can select efficient triplets before the beginning of each epoch. Finally, we construct a data set containing 130000 articles and 3600 authors for the experiment. The experimental results show that the dynamic selection strategy has a significant improvement, and our method has obvious advantages compared with other baselines, especially when the number of authors is large.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Zhonghou-Tracking-The-Criminal-Of-Fake-News-Based-On-A-Unified-Embedding.pdf)
### WIFI-Important Remote Attack Surface: Threat is Expanding
Wi-Fi technology is one of the most important infrastructures of today. A large amount of devices, such as cellphones, laptops, IoT devices, cars, and infrastructure of smart city are heavily depending on Wi-Fi. As a consequence, Wi-Fi has been one of the most popular attack surface of modern information systems.In this talk, we focus on the vulnerability of Wi-Fi drivers before password authentication, as well as the security issues caused by these Wi-Fi layer vulnerabilities. We would like to share our experience in finding memory corruption vulnerabilities in Wi-Fi drivers, and how we successfully automated the vulnerability discovery process. These memory corruption bugs in Wi-Fi drivers always directly lead to immediate DoS, and significantly affect the target system. We found that these memory corruption vulnerabilities follow some patterns, and we constructed a fuzzing tool to automatically find memory corruption bugs according to these patterns. This tool successfully found a bunch of memory corruption vulnerabilities in many well adopted Wi-Fi adapter drivers, including Realtek USB/PCI-E Wi-Fi drivers, Pixel 3 Wi-Fi driver, and Intel PCI-E Wi-Fi adapter drivers. All of these vulnerabilities are remotely triggered without password authentication. We strongly believe that the fuzzing methodology and the tool is very effective and we want to bring it to the BlackHat.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Xie-WIFI-Important-Remote-Attack-Surface-Threat-Is-Expanding.pdf)
### What the Log?! So Many Events, so Little Time...
Detecting adversaries in your environment is a challenging task: Most organizations need at least several months to detect them... IF they detect them at all.Many companies have started to investigate Windows Event Log to improve their detection. But analyzing Event Logs is a tedious task: so much information gathered in different log files and so much data to correlate. To improve your environment‘s security, Microsoft recommends the usage of so called „Microsoft Security Baselines“. Having such a security baseline in place, results in even more events that are being generated.It also requires a certain amount of storage space to gather all these events in one place. Storage space which comes with additional cost. Not all organizations are fortunate enough to store Petabytes of Log files. Therefore, they need to filter which Event IDs are important enough to forward to their SIEM system.But what Events are being generated if you apply a certain Microsoft Security Baseline? Which are important enough to forward to allocate valuable storage space? And what to do with all the data when you have collected everything in one location?In this live-demonstration-filled talk, I will show you how to solve these problems – while matching Event Ids, Security Baselines and hunting queries to the MITRE ATT&CK framework.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Wiesner-What-The-Log-So-Many-Events-So-Little-Time.pdf)
- [source_code](https://github.com/miriamxyra/EventList)
### The Inside Story: There are Apps in Apps and Here is How to Break Them
With the rapid development of mobile internet, apps have become more and more complex. However, their most used functions are limited to a few pages.Enter instant app. Instant apps have many advantages over normal apps, such as click-to-play and concise design, and they are becoming more and more popular. There are also some forms of instant app framework in many popular apps, such as Google Play, WeChat, TikTok, etc. In addition, many phone vendors have also embedded instant app frameworks in their pre-installed applications.However, there is barely any public research on attacking instant apps.In this talk, we will dive into a common architecture of instant app framework, and demonstrate attack models for it. Based on these attack models, we have reverse engineered top instant app frameworks. We will show how to bypass various kinds of sandboxing and restriction technologies to break isolations between instant apps.These vulnerabilities could lead to sensitive information leakage, identity theft, account takeover and other severe consequences.In addition, during the study of Google Instant app, we also bypassed component access restrictions, which greatly expands attack surface.These vulnerabilities and attack models affects more than 60% of Android devices and at least 1 billion users.Finally, we summarize the root causes of these vulnerabilities at the architectural level and point out the potential attack points. We will also propose practical mitigation measures for specific vulnerabilities. We hope we could make users and developers aware of the potential security risks while enjoying the convenience of instant apps. We also hope to make security community aware of this emerging new attack surface.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Xing-The-Inside-Story-There-Are-Apps-In-Apps-And-Here-Is-How-To-Break-Them.pdf)
### Wi-Fi Brokering
The common perception of 802.1X WiFi networks using tunneled authentication methods such as PEAP, are that they offer good enough security. Attacks introduced in 2004 by Joshua Wright and Brad Antoniewicz allow the inner MSCHAPv2 challenge/response to be captured, and cracked offline. As MSCHAPv2 is based on DES, Moxie Marlinspike and David Hulton showed that the entire keyspace can be brute forced with specialised hardware at Defcon 20. However, what if you didn't need to crack the password at all, but simply relayed the challenge and response.

When WiFi devices authenticate to a network, in a typical tunnelled EAP scenario, such as PEAP, the security of the authentication is provided by an outer TLS connection, and the inner MSCHAPv2 exchange is assumed secure as long as the TLS channel is. For these tunnelled EAPs, it's possible to relay the inner EAP exchange between a legitimate client device and it's legitimate network, to authenticate ourselves to the network without having to crack the password. This is conceptually similar to SMB relay attacks. The rogue AP and rogue supplicant merely require a network connection between them (via RADIUS), and don't need to be physically co-located, meaning this attack could for e.g. be done while a victim device is at home, and the attacker is at the target network.

Using this method it is possible to authenticate to PEAP protected networks (and possibly others using the same idea) by tricking users into authenticating to your rogue access point without having to crack the MSCHAPv2 challenge/response to retrieve that user's password.

This talk will intro just such an attack and corresponding toolset, as well as explain the process of developing the attack. Finally, we will cover practical defences to the vulnerability.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Kruger-Wi-Fi-Brokering.pdf)
- [source_code](https://github.com/sensepost/wpa_sycophant)
### Walking Your Dog in Multiple Forests - Breaking AD Trust Boundaries through Kerberos Vulnerabilities
In larger enterprise environments multiple Active Directory forests are often in use to separate different environments or parts of the business. To enable integration between the different environments, forests trusts are set up. The goal of this trust is to allow users from the other forest to authenticate while maintaining the security boundary that an Active Directory forest offers. In 2018, this boundary was broken through default delegation settings and Windows features with unintended consequences. In 2019 the security boundary was once again established through a set of changes in Active Directory. This research introduces a vulnerability in Kerberos and forest trusts that allows attackers to break the trust once again. The talk will provide technical details on how Kerberos works over forest trusts and how the security boundary is normally enforced. Then the talk will discuss a flaw in how AD forest trusts operate and how this can be combined with a vulnerability in the Windows implementation of Kerberos to take over systems in a different forest (from a compromised trusted forest). The talk will be accompanied by a proof-of-concept and a demonstration of abusing the vulnerability.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Mollema-Walking-Your-Dog-In-Multiple-Forests-Breaking-AD-Trust-Boundaries-Through-Kerberos-Vulnerabilities.pdf)
### Page Cache Attacks: Microarchitectural Attacks on Flawless Hardware
In recent years, we have seen that optimizations in processors often enable new microarchitectural side channels. The severity of side-channel attacks varies widely, from small annoyances for which developers have to introduce workarounds in software, to highly critical attacks leaking arbitrary memory contents. While new attacks pop up regularly, finding defenses is not a trivial task.

In this talk, we first briefly overview the state of the art of microarchitectural attacks and defenses. We then assume that we have a futuristic CPU which magically hides all microarchitectural side effects, rendering all known attacks useless. Even in this thought experiment, we show that such attacks are not dead. In fact, we present ways of mounting well-known microarchitectural attacks without relying on any hardware effects, making these attacks hardware agnostic.

We show that attack primitives exploiting the hardware can be shifted to the software level, making these attacks easier to mount and independent of the CPU. The attacks that we present work on Windows, Linux, and Android, both on x86 and ARM processors. We show that we can build a high-speed covert channel, break ASLR on Windows 10, leak highly sensitive information for targeted extortion and spam campaigns, and respond to system activity with UI redressing attacks. We demo an attack on the generation of temporary passwords on vulnerable cryptographic implementations.

The CVE for this vulnerability is CVE-2019-5489.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Gruss-Page-Cache-Attacks-Microarchitectural-Attacks-On-Flawless-Hardware.pdf)
### First Contact - Vulnerabilities in Contactless Payments
Introduced in 2007, contactless (NFC) payments have been used widely for a decade. Accounting for more than 40% of transactions globally, contactless payments are fast replacing cash and CHIP. Yet, contactless makes use of protocols much older than the technology itself. So, how safe and secure are contactless payments? In this talk we discuss how the EMV protocols and magstripe modes used for contactless are equally flawed. For the first time we show how to bypass the UK £30 limit for contactless payments made using physical cards. Then how to circumvent limits for mobile wallets using locked mobile phones. What's more, we cover flaws in the generation keys values, the unpredictable number (UN) and application transaction counter (ATC). Another first, we perform a pre-play attack using EMV without downgrading to legacy modes.
- [slide](http://i.blackhat.com/asia-20/Thursday/asia-20-Galloway-First-Contact-New-Vulnerabilities-In-Contactless-Payments.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Thursday/asia-20-Galloway-First-Contact-New-Vulnerabilities-In-Contactless-Payments-wp.pdf)
### Locknote: Conclusions and Key Takeaways from Day 1
At the end of day one of this year's virtual conference, join Black Hat Review Board members Ryan Flores, Lidia Giuliano, Ty Miller, and Ashley Shen for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day one and how these trends will impact future InfoSec strategies.
### Complexity Killed Security
In the past decade, we have seen an increasing number of software-based attacks on increasingly complex hardware. Many times, I have been asked: Why don't you just check the hardware documentation?The hardware documentation we would need here is usually not available to us but only to a small set of employees of the corresponding hardware manufacturer.However, even if it were available, this would not substantially change our situation. The complexity of a system built from multiple smaller sub-systems is not just the sum of the complexity of the smaller systems. The interaction between the sub-systems leads to unforeseen additional complexity.This talk discusses the ironical importance of reverse-engineering human-built and documented things, with several examples where the new perspective led to new security-critical insights.We conclude that the constant fight between increasing complexity and security will require more and more effort just to maintain security levels.
### The Black Hat NOC: Greatest Hits and Holy...Cows
This session will be a look into the most interesting things seen and learned within the Black Hat NOC, by two of the guys that have been running that circus for nearly two decades. It won't just be attacks and failures, I mean, it will be that, but it'll also be so much more. Come see how the NOC has been adjusted, adapted, and reinvented as the industry, and the potential threats have changed over the years. What technologies or trends worked for us, what didn't, and what decisions were our best and worst? Maybe you'll get some ideas for your NOC or SOC. Maybe you'll walk away shocked and appalled. Maybe. But you'll definitely walk away entertained.
### Win the 0-Day Racing Game Against Botnet in Public Cloud
Botnet appears to be one of the significant threats to public cloud. They exploit new vulnerabilities(0-days) to take down a large part of the internet. As a cloud service provider, we built an automated 0-day monitoring solution to block the attack before botnet coming. In the early of 2019, we captured the world's first WebLogic RCE(CVE-2019-2725) 0-day payload and saved thousands of cloud server from the Muhstik botnet.

This talk shows the technical details of how we capture 0-day attack payloads automatically without knowing any vulnerability details beforehand. We will walk through real cases to show model performance and give results of 0-day monitoring.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Xu-Win-The-0-Day-Racing-Game-Against-Botnet-In-Public-Cloud.pdf)
### Adversary Detection Pipelines: Finally Making Your Threat Intel Useful
Security teams often feel like they're in a losing battle with threat intel. They don't know how to make threat intel useful or operationalize it within their organizations, especially if there isn't a dedicated full-time team. In this talk, we'll help you extract more value out of your threat intel program, giving you an easy win to level up not just your team, but the other teams in your security department. First, we'll explore why true attribution is so hard, from false flag operations and proxy attackers to obtaining all the forensic data you would need and even possible coordination with law enforcement or government agencies to perform true attribution. We'll discuss TTPs and how they're a lower-cost way of tracking threat activity groups for most organizations. Then we'll introduce Adversary Detection Pipelines, how they can add value through prioritizing defensive and offensive activities as well as a discussion on the practical implementation of them in any organization. Finally, we'll conclude by looking at case studies of how purple teams can leverage Adversary Detection Pipelines to enhance their operations and encourage an intelligence driven security program.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Olsen-Adversary-Detection-Pipelines-Finally-Making-Your-Threat-Intel-Useful.pdf)
### Patching Loopholes: Finding Backdoors in Applications
In this digital age, we live in a world of applications that enable us to conduct digital transactions ranging from everyday tasks to storage of sensitive data. But how secure are these applications?As the cybersecurity lead in the Singapore Government, GovTech seeks to secure government applications by proactively conducting security assessments. As the application landscape is wide and varied, we employ various techniques such as fuzzing, source code reviews and reverse engineering to discover new vulnerabilities.In this talk, we will take you through the Tactics, Techniques and Procedures (TTPs) used to find application backdoors that were put in place by developers, unbeknown to users, in two applications - a Windows-based thick client and an iOS application.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Loke-Patching-Loopholes-Finding-Backdoors-In-Applications.pdf)
### Identifying Multi-Binary Vulnerabilities in Embedded Firmware at Scale
Low-power, single-purpose embedded devices (e.g., routers and IoT devices) have become ubiquitous. While they automate and simplify many aspects of our lives, recent large-scale attacks have shown that their sheer number poses a severe threat to the Internet infrastructure, which led to the development of an IoT-specific cybercrime underground. Unfortunately, the software on these systems is hardware-dependent, and typically executes in unique, minimal environments with non-standard configurations, making security analysis particularly challenging. Moreover, most of the existing devices implement their functionality through the use of multiple binaries. This multi-binary service implementation renders current static and dynamic analysis techniques either ineffective or inefficient, as they are unable to identify and adequately model the communication between the various executables.

In this talk, we will unveil the inner peculiarities of embedded firmware, we will show why existing firmware analysis techniques are ineffective, and we will present Karonte, a novel static analysis tool capable of analyzing embedded-device firmware by modeling and tracking multi-binary interactions. Our tool propagates taint information between binaries to detect insecure, attacker-controlled interactions, and effectively identify vulnerabilities.

We will then present the results and insights of our experiments. We tested Karonte on 53 firmware samples from various vendors, showing that our prototype tool can successfully track and constrain multi-binary interactions. In doing so, we discovered 46 zero-day bugs, which we disclosed to the responsible entities.  We performed a large-scale experiment on 899 different samples, showing that Karonte scales well with firmware samples of different size and complexity, and can effectively and efficiently analyze real-world firmware in a generic and fully automated fashion.

Finally, we will demo our tool, showing how it led to the detection of a previously unknown vulnerability.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Redini-Identifying-Multi-Binary-Vulnerabilities-In-Embedded-Firmware-At-Scale.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Friday/asia-20-Redini-Identifying-Multi-Binary-Vulnerabilities-In-Embedded-Firmware-At-Scale-wp.pdf)
### Biometrics &#38; Privacy: Time to Faceoff or is that FaceApp?
FaceApp sparked outrage recently when it was thought that the app was taking photos from your phone and uploading them to servers in Russia without permission and for nefarious reasons. The evidence didn't support this claim, but it was enough for many to raise their concerns.That the Twittersphere got all worked up wasn't news, but the fact that so many of us use the biometric security features of our phones without thinking about it is a cause for concern. Security is increasingly relying on our biometric data for authentication and even national security purposes, and consumers are handing over this information without understanding the potential impacts and whether this type of information is covered by the various privacy legislation around the world.In this talk, we will explore the various types of biometric data, their uses by both government and private organisations, and whether the collection and use of such data is covered by the privacy legislation in the APAC region in particular, but more broadly around the world. Knowing what laws apply enables you to determine what rights you as the 'owner' of the biometric data may have to protect your valuable biometrics. In this talk, you will learn what and how biometric data is protected by the law and what you may be able to do to protect yourself.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Wingard-Biometrics-And-Privacy-Time-To-Face-Off-Or-Is-That-FaceApp.pdf)
### From an URGENT/11 Vulnerability to a Full Take-Down of a Factory, Using a Single Packet
Industrial Controllers are the basic building blocks for any automated factory. Our talk will demonstrate how an attacker can take over an entire factory by transmitting a single packet that will exploit one of the URGENT/11 vulnerabilities we've recently discovered.PLCs (programmable logic controllers) are embedded devices responsible for the control of manufacturing processes, with hundreds of them scattered in industrial environments. Successful exploitation of such devices in mass, can have devastating implications on a factory or critical systems. Pulling it off in such a way that is hard to detect, debug, and eventually shut-down, such as done by the Stuxnet worm, requires a nation state level of sophistication.In this talk, we will walk through the process of exploiting one of the URGENT/11 vulnerabilities we discovered earlier this year on a Rockwell PLC. We will detail how we were able to obtain debug capabilities on the devices, learn the internals of its implementation by reverse engineering its firmware, and eventually develop a reliable exploit that gains code execution by sending a single broadcast IP packet. An attacker can use this vulnerability to create a concurrent exploitation and infect an entire factory using a single malicious broadcast packet.We will then continue to detail the steps that can be carried by an attacker post-exploitation, and how he could manipulate a critical device such as a PLC, leaving the industrial tools that are monitoring it in the dark about what is actually happening. We will conclude our talk with a live demo of multiple PLCs all being pwned simultaneously by a single broadcast packet.
### Raiden Glitching Framework
Voltage glitching is a developing technique in hardware hacking that has shown much promise, allowing bypass of security mechanisms and disclosure of firmware and secrets at the physical layer. Current glitching platforms are limited to custom hardware, which makes scaling difficult. But what if we turned FPGAs into glitchers instead, making the platform portable between physical boards? As it turns out, this approach provides several advantages. We are able to provide any resolution we like for the glitch signal, limited only by the PLL or internal oscillator of the FPGA board we want to use; For example, the FPGA used for our initial prototype allows 10ns resolution. These advantages, plus some unique features, makes ours an interesting solution for professional fault injection applications. In this talk, we will explain how we built our own glitching tool, Raiden, to give everyone the ability to do professional-grade glitching at a much lower price, with simplified management via Python API to make it user friendly. We'll also release our code so you can make your own with a spare FPGA, and demonstrate real-world attacks that can be performed with up-to-date glitching techniques. We'll also show a demonstration of alternate uses for such a platform by performing hardware fuzzing on a system using Wiegand.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Wypych-Raiden-Glitching-Framework.pdf)
### Store-to-Leak Forwarding: There and Back Again
In the past couple of years, we have seen many different attacks that allowed an attacker to leak data. One of these attacks is Meltdown, allowing an attacker to leak kernel memory. After it was fixed, everyone thought that the problem was solved. Unfortunately, this is not the case as there are still effects that are closely related to Meltdown.

In this talk, we will show how we can use one such effect to break KASLR on all Intel CPUs since 2004 with perfect accuracy and in less than a second. The new method even outperforms the previous state-of-the-art KASLR break presented by Jang et al. at Black Hat USA 2016. We will also show that we can use this effect from JavaScript and SGX enclaves. We will then enhance our attack primitive with side effects on the TLB to monitor user behavior. We will demonstrate how we can use the first primitive to detect and classify kernel modules. We will then monitor one such module with the other primitive, inferring user behavior, such as the user's proximity to the computer, from it. With our final attack primitive, we will show how we can use new, simpler Spectre gadgets to leak kernel memory. 

We will also highlight the differences between our approach, Store-to-Leak, and Fallout. While they may appear similar from a high-level perspective, the differences become apparent when we consider countermeasures. All mitigations for microarchitectural data-sampling attacks (MDS), including Fallout, do not mitigate Store-to-Leak. Therefore, all CPUs dating back to 2004 remain vulnerable to Store-to-Leak but not Fallout. This shows that Store-to-Leak is a powerful side-channel attack which is not easily fixed.

Finally, we will outline a countermeasure that prevents all known microarchitectural KASLR breaks, including Store-to-leak, Fallout, and DrK.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Canella-Store-To-Leak-Forwarding-There-And-Back-Again.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Friday/asia-20-Canella-Store-To-Leak-Forwarding-There-And-Back-Again-wp.pdf)
- [source_code](https://github.com/cc0x1f/store-to-leak-forwarding-there-and-back-again)
### Escaping Virtualized Containers
Containers offer speed, performance, and portability, but do they actually contain? While they try their best, the shared kernel is a disturbing attack surface: a mere kernel vulnerability may allow containerized processes to escape and compromise the host. This issue prompted a new wave of sandboxing tools that use either unikernels, lightweight VMs or userspace-kernels to separate the host OS from the container's OS.One of these solutions is Kata Containers, a container runtime that spawns each container inside a lightweight VM, and can function as the underlying runtime in Docker and Kubernetes. Kata's virtualized containers provide two layers of isolation: even if an attacker breaks out of the container, he is still confined to the microVM.Several Cloud Service Providers are deploying Kata in production to support customer multitenancy in their Serverless and CaaS offerings. With its focus on isolation, does Kata Containers actually contain? In this talk, we'll put Kata's isolation to the test, and attempt to escape the container, break out of the encapsulating VM, and finally, compromise the host.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Yuval-Avrahami-Escaping-Virtualized-Containers.pdf)
### Attacking and Defending Machine Learning Applications of Public Cloud
In recent years, Machine Learning (ML) techniques have been extensively deployed for computer vision tasks, particularly visual classification problems, where new algorithms reported to achieve or even surpass the human performance. Success of ML algorithms has led to an explosion in demand. To further broaden and simplify the use of ML algorithms, cloud-based services offered by Amazon, Google, Microsoft, Clarifai and other public cloud companies have developed ML-as-a-service tools. Thus, users and companies can readily benefit from ML applications without having to train or host their own models. For example, Google introduced the Cloud Vision API for image analysis. A demonstration website has been also launched, where for any selected image, the API outputs the image labels, identifies and reads the texts contained in the image and detects the faces within the image. It also determines how likely is that the image contains inappropriate contents, including adult, spoof, medical, or violence contents.Unlike common attacks against web applications, such as SQL injection and XSS, there are very special attack methods for machine learning applications. Obviously, neither public cloud companies nor traditional security companies pay much attention to these new attacks and defenses.This presentation focuses on the Cloud Vision API of public cloud companies and explores the attacks against the machine learning applications and describes effective defenses and mitigation. While the content is focused on the Cloud Vision API, some of the attack and defense topics are applicable to other machine learning applications such as natural language processing (NLP) applications and speech processing applications. Our research involves attacks, intrusion detection, security testing and security reinforcement, which can become security development lifecycle(SDL) for machine learning applications.We will release a tool (https://github.com/advboxes/AdvBox) to support SDL for ML.Key items covered:Transfer attack against image classification serviceFFL-PGD attack against image classification serviceSpacial attack against pornographic image detection serviceAdversarial attack detectionSecurity testing for model robustnessSecuring machine learning applications against attacks
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Hao-Attacking-And-Defending-Machine-Learning-Applications-Of-Public-Cloud.pdf)
- [whitepaper](http://i.blackhat.com/asia-20/Friday/asia-20-Hao-Attacking-And-Defending-Machine-Learning-Applications-Of-Public-Cloud-wp.pdf)
### Hey Google, Activate Spyware! – When Google Assistant Uses a Vulnerability as a Feature
This talk is based on research that was recently conducted and resulted in serious security findings and 0-day vulnerabilities in Android-based smartphones. Our team found a way of manipulating specific actions and intents, making it possible for any application, without specific permissions, to control the camera app. Through the use of a rogue app, given no permissions, an attacker could establish and maintain a persistent backdoor connection to the victim's smartphone and remotely command it to take photos and videos without the victim knowing it, even if the phone is locked or the screen is turned off. Once the photos and videos are taken, an attacker can remotely retrieve the files from the smartphone's SD card. Plus, an attacker can track the victim's geolocation using GPS metadata from the photos and videos in real-time. Not only can the smartphone be remotely commanded to take photos and videos with both front and back cameras, but the same rogue app can also be used to record audio and video while a victim is on a voice call.The findings were submitted to the Android ecosystem. Google and Samsung confirmed they were affected, triaged as High Severity, and have been addressed by Google and Samsung engineers.Attendees will learn about some very interesting vulnerabilities in the Android OS. The story starts with the discovery of the security issues, how they were exploited, and understanding their meaning to users of Android-based smartphones. In this talk, I will provide a glimpse into the attackers' mindset, including the steps taken to chain different vulnerabilities together, and leveraging them into a full-blown weaponized rogue app.This talk will also include a live demonstration of the rogue app and how it was used to exploit the vulnerabilities in the Android OS.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Yalon-Hey-Google-Activate-Spyware.pdf)
### Misuse of DNS, the Second Most Used Protocol
Our precious Internet traffic relies significantly on DNS to work, now that IPv6 traffic starts to grow we will need it even more. Yet still an ancient protocol has been attacked for 4 decades already. There are improvements coming alone like DNSSEC, DoT and DoH but not at fast pace. This session is not about attacking DNS servers or clients, it is about crafting new techniques to “misuse” the DNS protocol to our advantage.In this talk, I will cover some DNS features and specifications, what is the current landscape of tools to “misuse” DNS and their respective pros & cons. We take a look at “Next Generation” security products (IPS/Firewalls/etc) and what they do to prevent or catch these tools. With this in mind, we craft an algorithm to bypass those and pretend to be normal DNS traffic. To be able to archive this during the talk, I will show you an open source tool called “DFEX” and setup a real portable network infrastructure to test it. At last, I will run through other possible uses of this technique, how to scale them, and some ideas for detection and mitigation.This talk is oriented to “RGB” (Red-Green-Blue) teams, researchers, infrastructure/system administrators and passionate security people.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Couto-Misuse-Of-DNS-The-Second-Most-Used-Protocol.pdf)
### Redback: Advanced Static Binary Injection
Static binary injection is a technique to permanently insert external code to an executable file, in order to observe or modify target behavior at run-time. From an attacker's perspective, this is helpful to enable persistent infection. For the defense side, this plays a crucial step in binary instrumentation. Unfortunately, good injection tools are seriously lacking: firstly, existing tools only support some limited platforms or CPU architectures. Secondly, they all restrict the injected code to be written in low-level assembly, which significantly raises the cost of development and maintenance.

It is highly complicated to implement a good static injection tool, which in essential requires to build an advanced static linker to properly link target binary with external code, so the output executable can be legitimately executed on modern systems with many mitigation techniques enabled by default. Considering that we wish to inject code built from high-level languages such as C/C++, the task is much more challenging.

This work provides a comprehensive overview on how static code injection is done on all platforms (Windows, MacOS, Linux, BSD). We will present all the technical issues we had to overcome, including understanding different executable file formats, how to expand the original binary to accommodate new code, data and meta-data coming from external binary, and how our static linker leverage the OS dynamic linker to do heavy lifting job for us.

We implemented all the ideas in a new solution named Redback. Our tool can inject code built from high-level languages like C/C++ into target executable of all platfoms (Windows, MacOS, Linux, BSD are confirmed). Redback also works cross-architecture (with support for ARM, ARM64, Mips, PPC, X86), and can handle multiple executable formats (PE/PE+, MachO & ELF).

This talk will be concluded with some exciting demos. Redback will be released after our talk, with full source code.
### ZombieLoad: Leaking Data on Intel CPUs
The publication of Meltdown in January 2018 was the first instance of a hardware vulnerability which broke the security guarantees of modern CPUs. Meltdown allowed attackers to leak arbitrary memory by exploiting that Intel CPUs use lazy fault handling and continue transient execution with data originating from faulting loads. With stronger kernel isolation, a software workaround to prevent Meltdown attacks, and new CPUs with this vulnerability fixed, Meltdown seemed to be a solved issue. In this talk, we show that Meltdown is still an issue on modern CPUs. We present ZombieLoad, a Meltdown-type attack which leaks data across multiple privilege boundaries: processes, kernel, SGX, hyperthreads, and even across virtual machines. We also compare ZombieLoad to other microarchitectural data-sampling attacks, such as Fallout and RIDL. We show that Meltdown mitigations do not affect ZombieLoad. The ZombieLoad attack can be mounted without any user interactions from an unprivileged application, both on Linux and Windows. To demonstrate the danger of the ZombieLoad attack, we present multiple attacks, such as monitoring the browsing behavior, stealing cryptographic keys, and leaking the root-password hash on Linux. In a live demo, we show that such attacks are not only feasible but also relatively easy to mount. We will then discuss mitigations against the ZombieLoad attack. We outline challenges for future research on Meltdown attacks and mitigations. Finally, we will discuss the short-term and long-term implications of Meltdown for hardware vendors, software vendors, and users.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Schwarz-ZombieLoad-Leaking-Data-On-Intel-CPUs.pdf)
### Back to the Future. Cross-Protocol Attacks in the Era of 5G
The state of mobile technologies can be baffling. We are already seeing deployment of 5G networks with astounding bandwidth and minimal latency. Yet, standards reliant on SS7, a technology developed in the 1970s, still continue to dominate. This mishmash of technologies, protocols, and standards in telecom has implications for security. Intruders are attacking mobile networks from all possible angles, in part by leveraging multiple protocols in combined attacks.In this presentation, I will describe how an attacker can take advantage of vulnerabilities in different generations of signaling protocols. Access to the old SS7 signaling system is enough to manipulate data on newer-generation (4G/5G) networks. Moreover, an attacker can intercept voice calls on combined 2G/3G/4G networks, as well as commit fraud by subscribing random subscribers to VAS services.All the scenarios described involve cross-protocol attacks: an attack starts with actions in one protocol that are continued by actions in a different one, requiring particular combinations of actions for the attack to succeed. The results of this research have not been published previously.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Puzankov-Back-To-The-Future-Cross-Protocol-Attacks-In-The-Era-Of-5G.pdf)
### Kr00k: How KRACKing Amazon Echo Exposed a Billion+ Vulnerable Wi-Fi Devices
We have identified serious security weaknesses in chipsets used by a significant number of Wi-Fi capable devices. Specifically, we discovered that FullMAC Wi-Fi chipsets by Broadcom/Cypress – and possibly other manufacturers – are vulnerable to encrypting packets in a WPA2-protected network with an all-zero encryption key. In a successful attack, this allows an adversary to decrypt some wireless network packets. The number of affected devices is likely over a billion including devices by Apple, Samsung, Amazon, and others that use the vulnerable chipsets.The chipset-level, all-zero-key vulnerability has been assigned CVE-2019-15126. For easier reference and distinction from previous research, we dubbed it Kr00k. Our research began with the discovery that some versions of the popular Amazon Echo and Kindle devices were vulnerable to Key Reinstallation Attacks (KRACK). After reporting that to Amazon, we investigated further, also looking into the all-zero encryption key modification of KRACK. Further vulnerable devices were discovered, reported and patched by the vendor. But the most significant finding was that the crux is not in software, but in the hardware – the Wi-Fi chipsets themselves. Hence, the issue affects a much wider range of devices. We will detail our responsible disclosure process and how we successfully cooperated with Amazon while it prepared patches.The presentation will include technical details and a demonstration, where we will show how we were able to trigger a reassociation to set an all-zero encryption key and decrypt intercepted packets.We will also discuss the potential impact of these vulnerabilities, along with the limitations of exploiting them.
### May the Trust be with You: Empowering TrustZone-M with Multiple Trusted Environments
Over the last decade, Arm TrustZone has been pivotal for securing hundreds of millions of mobile devices. Within the realm of the Internet of Things (IoT), Arm has recently introduced TrustZone on its new generation of microcontrollers (a.k.a. TrustZone-M). Although TrustZone has been used as a key enabling technology to implement trusted execution environments (TEEs), the sad reality is that, over the past years, TrustZone-assisted TEEs have been successfully attacked hundreds of times, causing highly damaging consequences across different sectors and platforms. One of the root causes of the prevailing vulnerabilities is motivated by the classic dual-world security model, which "imposes" the software needs to be split among a secure and non-secure environment. This dual-world architecture has intrinsic limitations and is falling short to address the increasing complexity and requirements of modern devices. In the future, where trillions of small TrustZone-enabled IoT devices are expected worldwide, this problem can extrapolate, imposing a significant threat for the security of our infrastructures.

In this talk, we start by examining TrustZone(-M) technology and explaining why the intrinsic traditional dual-world security model is becoming impractical and inherently insecure. We then share our experience in designing and implementing the first multi-world TEE for modern TrustZone-M devices. Existing operating systems (e.g. Zephyr, FreeRTOS), micro-TEEs (e.g. Kinibi-M), and lightweight hypervisors for TrustZone-M microcontrollers are limited to a dual-world architecture; our solution provides an unlimited number of equally-secure execution environments. We demonstrate that the bedrock of the system relies on a lightweight and small TEE kernel that has a minimal impact on the performance and the trusted computing base (TCB) of the system. To close our talk, we will present a live demo of a fully-functional secure IoT stack for Industrial IoT applications running on a real TrustZone-M hardware platform.
- [slide](http://i.blackhat.com/asia-20/Friday/asia-20-Pinto-May-The-Trust-Be-With-You-Empowering-TrustZone-With-Multiple-Trusted-Environments.pdf)
### Locknote: Conclusions and Key Takeaways from Day 2
At the end of day two of this year's virtual conference, join Black Hat Review Board members Mika Devonshire, Seungjoo Kim, Asuka Nakajima, and Neil Wyler for an insightful conversation on the most pressing issues facing the InfoSec community. This Locknote will feature a candid discussion on the key takeaways from day two and how these trends will impact future InfoSec strategies.